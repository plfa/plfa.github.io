<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Soundness: Soundness of reduction with respect to denotational semantics ğŸš§ | Programming Language Foundations in Agda</title><meta name="generator" content="Jekyll v3.9.0"><meta property="og:title" content="Soundness: Soundness of reduction with respect to denotational semantics ğŸš§"><meta property="og:locale" content="en_US"><meta name="description" content="Programming Language Foundations in Agda"><meta property="og:description" content="Programming Language Foundations in Agda"><link rel="canonical" href="https://plfa.github.io/20.07/Soundness/"><meta property="og:url" content="https://plfa.github.io/20.07/Soundness/"><meta property="og:site_name" content="Programming Language Foundations in Agda"><script type="application/ld+json">{"url":"https://plfa.github.io/20.07/Soundness/","headline":"Soundness: Soundness of reduction with respect to denotational semantics ğŸš§","description":"Programming Language Foundations in Agda","@type":"WebPage","@context":"https://schema.org"}</script><link rel="stylesheet" href="/20.07/assets/main.css"></head><body><header class="site-header" role="banner"><div class="wrapper"><a class="site-title" href="/20.07/">Programming Language Foundations in Agda</a><nav class="site-nav"><span class="menu-icon"><svg viewBox="0 0 18 15" width="18px" height="15px"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/></svg></span><div class="trigger"><a class="page-link" href="/20.07/">The Book</a> <a class="page-link" href="/20.07/Announcements/">Announcements</a> <a class="page-link" href="/20.07/GettingStarted/">Getting Started</a> <a class="page-link" href="/20.07/Citing/">Citing</a> <a class="page-link" href="https://agda-zh.github.io/PLFA-zh/">ä¸­æ–‡</a></div></nav></div></header><main class="page-content" aria-label="Content"><div class="wrapper"><article class="post"><header class="post-header"><h1 class="post-title">Soundness: Soundness of reduction with respect to denotational semantics ğŸš§</h1></header><p style="text-align:center"><a alt="Previous chapter" href="/20.07/Compositional/">Prev</a> &bullet; <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev-20.07/src/plfa/part3/Soundness.lagda.md">Source</a> &bullet; <a alt="Next chapter" href="/20.07/Adequacy/">Next</a></p><div class="post-content"><pre class="Agda"><a id="195" class="Keyword">module</a> <a id="202" href="/20.07/Soundness/" class="Module">plfa.part3.Soundness</a> <a id="223" class="Keyword">where</a>
</pre><h2 id="introduction">Introduction</h2><p>In this chapter we prove that the reduction semantics is sound with respect to the denotational semantics, i.e., for any term L</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>L â€”â†  Æ› N  implies  â„° L â‰ƒ â„° (Æ› N)
</code></pre></div></div><p>The proof is by induction on the reduction sequence, so the main lemma concerns a single reduction step. We prove that if any term <code class="language-plaintext highlighter-rouge">M</code> steps to a term <code class="language-plaintext highlighter-rouge">N</code>, then <code class="language-plaintext highlighter-rouge">M</code> and <code class="language-plaintext highlighter-rouge">N</code> are denotationally equal. We shall prove each direction of this if-and-only-if separately. One direction will look just like a type preservation proof. The other direction is like proving type preservation for reduction going in reverse. Recall that type preservation is sometimes called subject reduction. Preservation in reverse is a well-known property and is called <em>subject expansion</em>. It is also well-known that subject expansion is false for most typed lambda calculi!</p><h2 id="imports">Imports</h2><pre class="Agda"><a id="1087" class="Keyword">open</a> <a id="1092" class="Keyword">import</a> <a id="1099" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="1139" class="Keyword">using</a> <a id="1145" class="Symbol">(</a><a id="1146" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_â‰¡_</a><a id="1149" class="Symbol">;</a> <a id="1151" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#799" class="Function Operator">_â‰¢_</a><a id="1154" class="Symbol">;</a> <a id="1156" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1160" class="Symbol">;</a> <a id="1162" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a><a id="1165" class="Symbol">;</a> <a id="1167" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a><a id="1171" class="Symbol">;</a> <a id="1173" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">congâ‚‚</a><a id="1178" class="Symbol">;</a> <a id="1180" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a><a id="1188" class="Symbol">)</a>
<a id="1190" class="Keyword">open</a> <a id="1195" class="Keyword">import</a> <a id="1202" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html" class="Module">Data.Product</a> <a id="1215" class="Keyword">using</a> <a id="1221" class="Symbol">(</a><a id="1222" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">_Ã—_</a><a id="1225" class="Symbol">;</a> <a id="1227" href="Agda.Builtin.Sigma.html#139" class="Record">Î£</a><a id="1228" class="Symbol">;</a> <a id="1230" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Î£-syntax</a><a id="1238" class="Symbol">;</a> <a id="1240" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1364" class="Function">âˆƒ</a><a id="1241" class="Symbol">;</a> <a id="1243" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1783" class="Function">âˆƒ-syntax</a><a id="1251" class="Symbol">;</a> <a id="1253" href="Agda.Builtin.Sigma.html#225" class="Field">projâ‚</a><a id="1258" class="Symbol">;</a> <a id="1260" href="Agda.Builtin.Sigma.html#237" class="Field">projâ‚‚</a><a id="1265" class="Symbol">)</a>
  <a id="1269" class="Keyword">renaming</a> <a id="1278" class="Symbol">(</a><a id="1279" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a> <a id="1283" class="Symbol">to</a> <a id="1286" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨_,_âŸ©</a><a id="1291" class="Symbol">)</a>
<a id="1293" class="Keyword">open</a> <a id="1298" class="Keyword">import</a> <a id="1305" href="Agda.Primitive.html" class="Module">Agda.Primitive</a> <a id="1320" class="Keyword">using</a> <a id="1326" class="Symbol">(</a><a id="1327" href="Agda.Primitive.html#611" class="Primitive">lzero</a><a id="1332" class="Symbol">)</a>
<a id="1334" class="Keyword">open</a> <a id="1339" class="Keyword">import</a> <a id="1346" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1363" class="Keyword">using</a> <a id="1369" class="Symbol">(</a><a id="1370" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#535" class="Function Operator">Â¬_</a><a id="1372" class="Symbol">)</a>
<a id="1374" class="Keyword">open</a> <a id="1379" class="Keyword">import</a> <a id="1386" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="1412" class="Keyword">using</a> <a id="1418" class="Symbol">(</a><a id="1419" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.Negation.html#809" class="Function">contradiction</a><a id="1432" class="Symbol">)</a>
<a id="1434" class="Keyword">open</a> <a id="1439" class="Keyword">import</a> <a id="1446" href="https://agda.github.io/agda-stdlib/v1.1/Data.Empty.html" class="Module">Data.Empty</a> <a id="1457" class="Keyword">using</a> <a id="1463" class="Symbol">(</a><a id="1464" href="https://agda.github.io/agda-stdlib/v1.1/Data.Empty.html#294" class="Function">âŠ¥-elim</a><a id="1470" class="Symbol">)</a>
<a id="1472" class="Keyword">open</a> <a id="1477" class="Keyword">import</a> <a id="1484" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1501" class="Keyword">using</a> <a id="1507" class="Symbol">(</a><a id="1508" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#605" class="Datatype">Dec</a><a id="1511" class="Symbol">;</a> <a id="1513" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a><a id="1516" class="Symbol">;</a> <a id="1518" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a><a id="1520" class="Symbol">)</a>
<a id="1522" class="Keyword">open</a> <a id="1527" class="Keyword">import</a> <a id="1534" href="https://agda.github.io/agda-stdlib/v1.1/Function.html" class="Module">Function</a> <a id="1543" class="Keyword">using</a> <a id="1549" class="Symbol">(</a><a id="1550" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">_âˆ˜_</a><a id="1553" class="Symbol">)</a>
<a id="1555" class="Keyword">open</a> <a id="1560" class="Keyword">import</a> <a id="1567" href="/20.07/Untyped/" class="Module">plfa.part2.Untyped</a>
     <a id="1591" class="Keyword">using</a> <a id="1597" class="Symbol">(</a><a id="1598" href="/20.07/Untyped/#3153" class="Datatype">Context</a><a id="1605" class="Symbol">;</a> <a id="1607" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">_,_</a><a id="1610" class="Symbol">;</a> <a id="1612" href="/20.07/Untyped/#3521" class="Datatype Operator">_âˆ‹_</a><a id="1615" class="Symbol">;</a> <a id="1617" href="/20.07/Untyped/#4294" class="Datatype Operator">_âŠ¢_</a><a id="1620" class="Symbol">;</a> <a id="1622" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="1623" class="Symbol">;</a> <a id="1625" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="1626" class="Symbol">;</a> <a id="1628" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a><a id="1630" class="Symbol">;</a> <a id="1632" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`_</a><a id="1634" class="Symbol">;</a> <a id="1636" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›_</a><a id="1638" class="Symbol">;</a> <a id="1640" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_Â·_</a><a id="1643" class="Symbol">;</a>
            <a id="1657" href="/20.07/Untyped/#6963" class="Function">subst</a><a id="1662" class="Symbol">;</a> <a id="1664" href="/20.07/Untyped/#7491" class="Function Operator">_[_]</a><a id="1668" class="Symbol">;</a> <a id="1670" href="/20.07/Untyped/#7375" class="Function">subst-zero</a><a id="1680" class="Symbol">;</a> <a id="1682" href="/20.07/Untyped/#5925" class="Function">ext</a><a id="1685" class="Symbol">;</a> <a id="1687" href="/20.07/Untyped/#6235" class="Function">rename</a><a id="1693" class="Symbol">;</a> <a id="1695" href="/20.07/Untyped/#6671" class="Function">exts</a><a id="1699" class="Symbol">;</a>
            <a id="1713" href="/20.07/Untyped/#9948" class="Datatype Operator">_â€”â†’_</a><a id="1717" class="Symbol">;</a> <a id="1719" href="/20.07/Untyped/#9998" class="InductiveConstructor">Î¾â‚</a><a id="1721" class="Symbol">;</a> <a id="1723" href="/20.07/Untyped/#10088" class="InductiveConstructor">Î¾â‚‚</a><a id="1725" class="Symbol">;</a> <a id="1727" href="/20.07/Untyped/#10178" class="InductiveConstructor">Î²</a><a id="1728" class="Symbol">;</a> <a id="1730" href="/20.07/Untyped/#10286" class="InductiveConstructor">Î¶</a><a id="1731" class="Symbol">;</a> <a id="1733" href="/20.07/Untyped/#11068" class="Datatype Operator">_â€”â† _</a><a id="1737" class="Symbol">;</a> <a id="1739" href="/20.07/Untyped/#11174" class="InductiveConstructor Operator">_â€”â†’âŸ¨_âŸ©_</a><a id="1746" class="Symbol">;</a> <a id="1748" href="/20.07/Untyped/#11118" class="InductiveConstructor Operator">_âˆ</a><a id="1750" class="Symbol">)</a>
<a id="1752" class="Keyword">open</a> <a id="1757" class="Keyword">import</a> <a id="1764" href="/20.07/Substitution/" class="Module">plfa.part2.Substitution</a> <a id="1788" class="Keyword">using</a> <a id="1794" class="Symbol">(</a><a id="1795" href="/20.07/Substitution/#2192" class="Function">Rename</a><a id="1801" class="Symbol">;</a> <a id="1803" href="/20.07/Substitution/#2405" class="Function">Subst</a><a id="1808" class="Symbol">;</a> <a id="1810" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="1813" class="Symbol">)</a>
<a id="1815" class="Keyword">open</a> <a id="1820" class="Keyword">import</a> <a id="1827" href="/20.07/Denotational/" class="Module">plfa.part3.Denotational</a>
     <a id="1856" class="Keyword">using</a> <a id="1862" class="Symbol">(</a><a id="1863" href="/20.07/Denotational/#4151" class="Datatype">Value</a><a id="1868" class="Symbol">;</a> <a id="1870" href="/20.07/Denotational/#4171" class="InductiveConstructor">âŠ¥</a><a id="1871" class="Symbol">;</a> <a id="1873" href="/20.07/Denotational/#7288" class="Function">Env</a><a id="1876" class="Symbol">;</a> <a id="1878" href="/20.07/Denotational/#9346" class="Datatype Operator">_âŠ¢_â†“_</a><a id="1883" class="Symbol">;</a> <a id="1885" href="/20.07/Denotational/#7445" class="Function Operator">_`,_</a><a id="1889" class="Symbol">;</a> <a id="1891" href="/20.07/Denotational/#4508" class="Datatype Operator">_âŠ‘_</a><a id="1894" class="Symbol">;</a> <a id="1896" href="/20.07/Denotational/#8108" class="Function Operator">_`âŠ‘_</a><a id="1900" class="Symbol">;</a> <a id="1902" href="/20.07/Denotational/#8311" class="Function">`âŠ¥</a><a id="1904" class="Symbol">;</a> <a id="1906" href="/20.07/Denotational/#8340" class="Function Operator">_`âŠ”_</a><a id="1910" class="Symbol">;</a> <a id="1912" href="/20.07/Denotational/#7686" class="Function">init</a><a id="1916" class="Symbol">;</a> <a id="1918" href="/20.07/Denotational/#7741" class="Function">last</a><a id="1922" class="Symbol">;</a> <a id="1924" href="/20.07/Denotational/#7790" class="Function">init-last</a><a id="1933" class="Symbol">;</a>
            <a id="1947" href="/20.07/Denotational/#5638" class="Function">âŠ‘-refl</a><a id="1953" class="Symbol">;</a> <a id="1955" href="/20.07/Denotational/#4798" class="InductiveConstructor">âŠ‘-trans</a><a id="1962" class="Symbol">;</a> <a id="1964" href="/20.07/Denotational/#8599" class="Function">`âŠ‘-refl</a><a id="1971" class="Symbol">;</a> <a id="1973" href="/20.07/Denotational/#25713" class="Function">âŠ‘-env</a><a id="1978" class="Symbol">;</a> <a id="1980" href="/20.07/Denotational/#8670" class="Function">âŠ‘-env-conj-R1</a><a id="1993" class="Symbol">;</a> <a id="1995" href="/20.07/Denotational/#8776" class="Function">âŠ‘-env-conj-R2</a><a id="2008" class="Symbol">;</a> <a id="2010" href="/20.07/Denotational/#26158" class="Function">up-env</a><a id="2016" class="Symbol">;</a>
            <a id="2030" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a><a id="2033" class="Symbol">;</a> <a id="2035" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a><a id="2041" class="Symbol">;</a> <a id="2043" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a><a id="2050" class="Symbol">;</a> <a id="2052" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a><a id="2059" class="Symbol">;</a> <a id="2061" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a><a id="2068" class="Symbol">;</a> <a id="2070" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a><a id="2073" class="Symbol">;</a>
            <a id="2087" href="/20.07/Denotational/#24144" class="Function">rename-pres</a><a id="2098" class="Symbol">;</a> <a id="2100" href="/20.07/Denotational/#17486" class="Function">â„°</a><a id="2101" class="Symbol">;</a> <a id="2103" href="/20.07/Denotational/#17668" class="Function Operator">_â‰ƒ_</a><a id="2106" class="Symbol">;</a> <a id="2108" href="/20.07/Denotational/#18073" class="Function">â‰ƒ-trans</a><a id="2115" class="Symbol">)</a>
<a id="2117" class="Keyword">open</a> <a id="2122" class="Keyword">import</a> <a id="2129" href="/20.07/Compositional/" class="Module">plfa.part3.Compositional</a> <a id="2154" class="Keyword">using</a> <a id="2160" class="Symbol">(</a><a id="2161" href="/20.07/Compositional/#3841" class="Function">lambda-inversion</a><a id="2177" class="Symbol">;</a> <a id="2179" href="/20.07/Compositional/#10012" class="Function">var-inv</a><a id="2186" class="Symbol">)</a>
</pre><h2 id="forward-reduction-preserves-denotations">Forward reduction preserves denotations</h2><p>The proof of preservation in this section mixes techniques from previous chapters. Like the proof of preservation for the STLC, we are preserving a relation defined separately from the syntax, in contrast to the intrinsically-typed terms. On the other hand, we are using de Bruijn indices for variables.</p><p>The outline of the proof remains the same in that we must prove lemmas concerning all of the auxiliary functions used in the reduction relation: substitution, renaming, and extension.</p><h3 id="simultaneous-substitution-preserves-denotations">Simultaneous substitution preserves denotations</h3><p>Our next goal is to prove that simultaneous substitution preserves meaning. That is, if <code class="language-plaintext highlighter-rouge">M</code> results in <code class="language-plaintext highlighter-rouge">v</code> in environment <code class="language-plaintext highlighter-rouge">Î³</code>, then applying a substitution <code class="language-plaintext highlighter-rouge">Ïƒ</code> to <code class="language-plaintext highlighter-rouge">M</code> gives us a program that also results in <code class="language-plaintext highlighter-rouge">v</code>, but in an environment <code class="language-plaintext highlighter-rouge">Î´</code> in which, for every variable <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">Ïƒ x</code> results in the same value as the one for <code class="language-plaintext highlighter-rouge">x</code> in the original environment <code class="language-plaintext highlighter-rouge">Î³</code>. We write <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ Ïƒ â†“ Î³</code> for this condition.</p><pre class="Agda"><a id="3184" class="Keyword">infix</a> <a id="3190" class="Number">3</a> <a id="3192" href="/20.07/Soundness/#3199" class="Function Operator">_`âŠ¢_â†“_</a>
<a id="_`âŠ¢_â†“_"></a><a id="3199" href="/20.07/Soundness/#3199" class="Function Operator">_`âŠ¢_â†“_</a> <a id="3206" class="Symbol">:</a> <a id="3208" class="Symbol">âˆ€{</a><a id="3210" href="/20.07/Soundness/#3210" class="Bound">Î”</a> <a id="3212" href="/20.07/Soundness/#3212" class="Bound">Î“</a><a id="3213" class="Symbol">}</a> <a id="3215" class="Symbol">â†’</a> <a id="3217" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="3221" href="/20.07/Soundness/#3210" class="Bound">Î”</a> <a id="3223" class="Symbol">â†’</a> <a id="3225" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3231" href="/20.07/Soundness/#3212" class="Bound">Î“</a> <a id="3233" href="/20.07/Soundness/#3210" class="Bound">Î”</a> <a id="3235" class="Symbol">â†’</a> <a id="3237" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="3241" href="/20.07/Soundness/#3212" class="Bound">Î“</a> <a id="3243" class="Symbol">â†’</a> <a id="3245" class="PrimitiveType">Set</a>
<a id="3249" href="/20.07/Soundness/#3199" class="Function Operator">_`âŠ¢_â†“_</a> <a id="3256" class="Symbol">{</a><a id="3257" href="/20.07/Soundness/#3257" class="Bound">Î”</a><a id="3258" class="Symbol">}{</a><a id="3260" href="/20.07/Soundness/#3260" class="Bound">Î“</a><a id="3261" class="Symbol">}</a> <a id="3263" href="/20.07/Soundness/#3263" class="Bound">Î´</a> <a id="3265" href="/20.07/Soundness/#3265" class="Bound">Ïƒ</a> <a id="3267" href="/20.07/Soundness/#3267" class="Bound">Î³</a> <a id="3269" class="Symbol">=</a> <a id="3271" class="Symbol">(âˆ€</a> <a id="3274" class="Symbol">(</a><a id="3275" href="/20.07/Soundness/#3275" class="Bound">x</a> <a id="3277" class="Symbol">:</a> <a id="3279" href="/20.07/Soundness/#3260" class="Bound">Î“</a> <a id="3281" href="/20.07/Untyped/#3521" class="Datatype Operator">âˆ‹</a> <a id="3283" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="3284" class="Symbol">)</a> <a id="3286" class="Symbol">â†’</a> <a id="3288" href="/20.07/Soundness/#3263" class="Bound">Î´</a> <a id="3290" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="3292" href="/20.07/Soundness/#3265" class="Bound">Ïƒ</a> <a id="3294" href="/20.07/Soundness/#3275" class="Bound">x</a> <a id="3296" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="3298" href="/20.07/Soundness/#3267" class="Bound">Î³</a> <a id="3300" href="/20.07/Soundness/#3275" class="Bound">x</a><a id="3301" class="Symbol">)</a>
</pre><p>As usual, to prepare for lambda abstraction, we prove an extension lemma. It says that applying the <code class="language-plaintext highlighter-rouge">exts</code> function to a substitution produces a new substitution that maps variables to terms that when evaluated in <code class="language-plaintext highlighter-rouge">Î´ , v</code> produce the values in <code class="language-plaintext highlighter-rouge">Î³ , v</code>.</p><pre class="Agda"><a id="subst-ext"></a><a id="3566" href="/20.07/Soundness/#3566" class="Function">subst-ext</a> <a id="3576" class="Symbol">:</a> <a id="3578" class="Symbol">âˆ€</a> <a id="3580" class="Symbol">{</a><a id="3581" href="/20.07/Soundness/#3581" class="Bound">Î“</a> <a id="3583" href="/20.07/Soundness/#3583" class="Bound">Î”</a> <a id="3585" href="/20.07/Soundness/#3585" class="Bound">v</a><a id="3586" class="Symbol">}</a> <a id="3588" class="Symbol">{</a><a id="3589" href="/20.07/Soundness/#3589" class="Bound">Î³</a> <a id="3591" class="Symbol">:</a> <a id="3593" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="3597" href="/20.07/Soundness/#3581" class="Bound">Î“</a><a id="3598" class="Symbol">}</a> <a id="3600" class="Symbol">{</a><a id="3601" href="/20.07/Soundness/#3601" class="Bound">Î´</a> <a id="3603" class="Symbol">:</a> <a id="3605" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="3609" href="/20.07/Soundness/#3583" class="Bound">Î”</a><a id="3610" class="Symbol">}</a>
  <a id="3614" class="Symbol">â†’</a> <a id="3616" class="Symbol">(</a><a id="3617" href="/20.07/Soundness/#3617" class="Bound">Ïƒ</a> <a id="3619" class="Symbol">:</a> <a id="3621" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3627" href="/20.07/Soundness/#3581" class="Bound">Î“</a> <a id="3629" href="/20.07/Soundness/#3583" class="Bound">Î”</a><a id="3630" class="Symbol">)</a>
  <a id="3634" class="Symbol">â†’</a> <a id="3636" href="/20.07/Soundness/#3601" class="Bound">Î´</a> <a id="3638" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="3641" href="/20.07/Soundness/#3617" class="Bound">Ïƒ</a> <a id="3643" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="3645" href="/20.07/Soundness/#3589" class="Bound">Î³</a>
   <a id="3650" class="Comment">--------------------------</a>
  <a id="3679" class="Symbol">â†’</a> <a id="3681" href="/20.07/Soundness/#3601" class="Bound">Î´</a> <a id="3683" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="3686" href="/20.07/Soundness/#3585" class="Bound">v</a> <a id="3688" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="3691" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="3696" href="/20.07/Soundness/#3617" class="Bound">Ïƒ</a> <a id="3698" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="3700" href="/20.07/Soundness/#3589" class="Bound">Î³</a> <a id="3702" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="3705" href="/20.07/Soundness/#3585" class="Bound">v</a>
<a id="3707" href="/20.07/Soundness/#3566" class="Function">subst-ext</a> <a id="3717" href="/20.07/Soundness/#3717" class="Bound">Ïƒ</a> <a id="3719" href="/20.07/Soundness/#3719" class="Bound">d</a> <a id="3721" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="3723" class="Symbol">=</a> <a id="3725" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a>
<a id="3729" href="/20.07/Soundness/#3566" class="Function">subst-ext</a> <a id="3739" href="/20.07/Soundness/#3739" class="Bound">Ïƒ</a> <a id="3741" href="/20.07/Soundness/#3741" class="Bound">d</a> <a id="3743" class="Symbol">(</a><a id="3744" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="3746" href="/20.07/Soundness/#3746" class="Bound">xâ€²</a><a id="3748" class="Symbol">)</a> <a id="3750" class="Symbol">=</a> <a id="3752" href="/20.07/Denotational/#24144" class="Function">rename-pres</a> <a id="3764" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="3767" class="Symbol">(Î»</a> <a id="3770" href="/20.07/Soundness/#3770" class="Bound">_</a> <a id="3772" class="Symbol">â†’</a> <a id="3774" href="/20.07/Denotational/#5638" class="Function">âŠ‘-refl</a><a id="3780" class="Symbol">)</a> <a id="3782" class="Symbol">(</a><a id="3783" href="/20.07/Soundness/#3741" class="Bound">d</a> <a id="3785" href="/20.07/Soundness/#3746" class="Bound">xâ€²</a><a id="3787" class="Symbol">)</a>
</pre><p>The proof is by cases on the de Bruijn index <code class="language-plaintext highlighter-rouge">x</code>.</p><ul><li><p>If it is <code class="language-plaintext highlighter-rouge">Z</code>, then we need to show that <code class="language-plaintext highlighter-rouge">Î´ , v âŠ¢ # 0 â†“ v</code>, which we have by rule <code class="language-plaintext highlighter-rouge">var</code>.</p></li><li><p>If it is <code class="language-plaintext highlighter-rouge">S xâ€²</code>,then we need to show that <code class="language-plaintext highlighter-rouge">Î´ , v âŠ¢ rename S_ (Ïƒ xâ€²) â†“ Î³ xâ€²</code>, which we obtain by the <code class="language-plaintext highlighter-rouge">rename-pres</code> lemma.</p></li></ul><p>With the extension lemma in hand, the proof that simultaneous substitution preserves meaning is straightforward. Letâ€™s dive in!</p><pre class="Agda"><a id="subst-pres"></a><a id="4200" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4211" class="Symbol">:</a> <a id="4213" class="Symbol">âˆ€</a> <a id="4215" class="Symbol">{</a><a id="4216" href="/20.07/Soundness/#4216" class="Bound">Î“</a> <a id="4218" href="/20.07/Soundness/#4218" class="Bound">Î”</a> <a id="4220" href="/20.07/Soundness/#4220" class="Bound">v</a><a id="4221" class="Symbol">}</a> <a id="4223" class="Symbol">{</a><a id="4224" href="/20.07/Soundness/#4224" class="Bound">Î³</a> <a id="4226" class="Symbol">:</a> <a id="4228" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="4232" href="/20.07/Soundness/#4216" class="Bound">Î“</a><a id="4233" class="Symbol">}</a> <a id="4235" class="Symbol">{</a><a id="4236" href="/20.07/Soundness/#4236" class="Bound">Î´</a> <a id="4238" class="Symbol">:</a> <a id="4240" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="4244" href="/20.07/Soundness/#4218" class="Bound">Î”</a><a id="4245" class="Symbol">}</a> <a id="4247" class="Symbol">{</a><a id="4248" href="/20.07/Soundness/#4248" class="Bound">M</a> <a id="4250" class="Symbol">:</a> <a id="4252" href="/20.07/Soundness/#4216" class="Bound">Î“</a> <a id="4254" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="4256" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="4257" class="Symbol">}</a>
  <a id="4261" class="Symbol">â†’</a> <a id="4263" class="Symbol">(</a><a id="4264" href="/20.07/Soundness/#4264" class="Bound">Ïƒ</a> <a id="4266" class="Symbol">:</a> <a id="4268" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="4274" href="/20.07/Soundness/#4216" class="Bound">Î“</a> <a id="4276" href="/20.07/Soundness/#4218" class="Bound">Î”</a><a id="4277" class="Symbol">)</a>
  <a id="4281" class="Symbol">â†’</a> <a id="4283" href="/20.07/Soundness/#4236" class="Bound">Î´</a> <a id="4285" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="4288" href="/20.07/Soundness/#4264" class="Bound">Ïƒ</a> <a id="4290" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="4292" href="/20.07/Soundness/#4224" class="Bound">Î³</a>
  <a id="4296" class="Symbol">â†’</a> <a id="4298" href="/20.07/Soundness/#4224" class="Bound">Î³</a> <a id="4300" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="4302" href="/20.07/Soundness/#4248" class="Bound">M</a> <a id="4304" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="4306" href="/20.07/Soundness/#4220" class="Bound">v</a>
    <a id="4312" class="Comment">------------------</a>
  <a id="4333" class="Symbol">â†’</a> <a id="4335" href="/20.07/Soundness/#4236" class="Bound">Î´</a> <a id="4337" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="4339" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="4345" href="/20.07/Soundness/#4264" class="Bound">Ïƒ</a> <a id="4347" href="/20.07/Soundness/#4248" class="Bound">M</a> <a id="4349" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="4351" href="/20.07/Soundness/#4220" class="Bound">v</a>
<a id="4353" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4364" href="/20.07/Soundness/#4364" class="Bound">Ïƒ</a> <a id="4366" href="/20.07/Soundness/#4366" class="Bound">s</a> <a id="4368" class="Symbol">(</a><a id="4369" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="4373" class="Symbol">{</a><a id="4374" class="Argument">x</a> <a id="4376" class="Symbol">=</a> <a id="4378" href="/20.07/Soundness/#4378" class="Bound">x</a><a id="4379" class="Symbol">})</a> <a id="4382" class="Symbol">=</a> <a id="4384" class="Symbol">(</a><a id="4385" href="/20.07/Soundness/#4366" class="Bound">s</a> <a id="4387" href="/20.07/Soundness/#4378" class="Bound">x</a><a id="4388" class="Symbol">)</a>
<a id="4390" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4401" href="/20.07/Soundness/#4401" class="Bound">Ïƒ</a> <a id="4403" href="/20.07/Soundness/#4403" class="Bound">s</a> <a id="4405" class="Symbol">(</a><a id="4406" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="4413" href="/20.07/Soundness/#4413" class="Bound">dâ‚</a> <a id="4416" href="/20.07/Soundness/#4416" class="Bound">dâ‚‚</a><a id="4418" class="Symbol">)</a> <a id="4420" class="Symbol">=</a>
  <a id="4424" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="4431" class="Symbol">(</a><a id="4432" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4443" href="/20.07/Soundness/#4401" class="Bound">Ïƒ</a> <a id="4445" href="/20.07/Soundness/#4403" class="Bound">s</a> <a id="4447" href="/20.07/Soundness/#4413" class="Bound">dâ‚</a><a id="4449" class="Symbol">)</a> <a id="4451" class="Symbol">(</a><a id="4452" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4463" href="/20.07/Soundness/#4401" class="Bound">Ïƒ</a> <a id="4465" href="/20.07/Soundness/#4403" class="Bound">s</a> <a id="4467" href="/20.07/Soundness/#4416" class="Bound">dâ‚‚</a><a id="4469" class="Symbol">)</a>
<a id="4471" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4482" href="/20.07/Soundness/#4482" class="Bound">Ïƒ</a> <a id="4484" href="/20.07/Soundness/#4484" class="Bound">s</a> <a id="4486" class="Symbol">(</a><a id="4487" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="4495" href="/20.07/Soundness/#4495" class="Bound">d</a><a id="4496" class="Symbol">)</a> <a id="4498" class="Symbol">=</a>
  <a id="4502" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="4510" class="Symbol">(</a><a id="4511" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4522" class="Symbol">(Î»</a> <a id="4525" class="Symbol">{</a><a id="4526" href="/20.07/Soundness/#4526" class="Bound">A</a><a id="4527" class="Symbol">}</a> <a id="4529" class="Symbol">â†’</a> <a id="4531" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="4536" href="/20.07/Soundness/#4482" class="Bound">Ïƒ</a><a id="4537" class="Symbol">)</a> <a id="4539" class="Symbol">(</a><a id="4540" href="/20.07/Soundness/#3566" class="Function">subst-ext</a> <a id="4550" href="/20.07/Soundness/#4482" class="Bound">Ïƒ</a> <a id="4552" href="/20.07/Soundness/#4484" class="Bound">s</a><a id="4553" class="Symbol">)</a> <a id="4555" href="/20.07/Soundness/#4495" class="Bound">d</a><a id="4556" class="Symbol">)</a>
<a id="4558" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4569" href="/20.07/Soundness/#4569" class="Bound">Ïƒ</a> <a id="4571" href="/20.07/Soundness/#4571" class="Bound">s</a> <a id="4573" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a> <a id="4581" class="Symbol">=</a> <a id="4583" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a>
<a id="4591" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4602" href="/20.07/Soundness/#4602" class="Bound">Ïƒ</a> <a id="4604" href="/20.07/Soundness/#4604" class="Bound">s</a> <a id="4606" class="Symbol">(</a><a id="4607" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="4615" href="/20.07/Soundness/#4615" class="Bound">dâ‚</a> <a id="4618" href="/20.07/Soundness/#4618" class="Bound">dâ‚‚</a><a id="4620" class="Symbol">)</a> <a id="4622" class="Symbol">=</a>
  <a id="4626" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="4634" class="Symbol">(</a><a id="4635" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4646" href="/20.07/Soundness/#4602" class="Bound">Ïƒ</a> <a id="4648" href="/20.07/Soundness/#4604" class="Bound">s</a> <a id="4650" href="/20.07/Soundness/#4615" class="Bound">dâ‚</a><a id="4652" class="Symbol">)</a> <a id="4654" class="Symbol">(</a><a id="4655" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4666" href="/20.07/Soundness/#4602" class="Bound">Ïƒ</a> <a id="4668" href="/20.07/Soundness/#4604" class="Bound">s</a> <a id="4670" href="/20.07/Soundness/#4618" class="Bound">dâ‚‚</a><a id="4672" class="Symbol">)</a>
<a id="4674" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4685" href="/20.07/Soundness/#4685" class="Bound">Ïƒ</a> <a id="4687" href="/20.07/Soundness/#4687" class="Bound">s</a> <a id="4689" class="Symbol">(</a><a id="4690" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="4694" href="/20.07/Soundness/#4694" class="Bound">d</a> <a id="4696" href="/20.07/Soundness/#4696" class="Bound">lt</a><a id="4698" class="Symbol">)</a> <a id="4700" class="Symbol">=</a> <a id="4702" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="4706" class="Symbol">(</a><a id="4707" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="4718" href="/20.07/Soundness/#4685" class="Bound">Ïƒ</a> <a id="4720" href="/20.07/Soundness/#4687" class="Bound">s</a> <a id="4722" href="/20.07/Soundness/#4694" class="Bound">d</a><a id="4723" class="Symbol">)</a> <a id="4725" href="/20.07/Soundness/#4696" class="Bound">lt</a>
</pre><p>The proof is by induction on the semantics of <code class="language-plaintext highlighter-rouge">M</code>. The two interesting cases are for variables and lambda abstractions.</p><ul><li><p>For a variable <code class="language-plaintext highlighter-rouge">x</code>, we have that <code class="language-plaintext highlighter-rouge">v âŠ‘ Î³ x</code> and we need to show that <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ Ïƒ x â†“ v</code>. From the premise applied to <code class="language-plaintext highlighter-rouge">x</code>, we have that <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ Ïƒ x â†“ Î³ x</code>, so we conclude by the <code class="language-plaintext highlighter-rouge">sub</code> rule.</p></li><li><p>For a lambda abstraction, we must extend the substitution for the induction hypothesis. We apply the <code class="language-plaintext highlighter-rouge">subst-ext</code> lemma to show that the extended substitution maps variables to terms that result in the appropriate values.</p></li></ul><h3 id="single-substitution-preserves-denotations">Single substitution preserves denotations</h3><p>For Î² reduction, <code class="language-plaintext highlighter-rouge">(Æ› N) Â· M â€”â†’ N [ M ]</code>, we need to show that the semantics is preserved when substituting <code class="language-plaintext highlighter-rouge">M</code> for de Bruijn index 0 in term <code class="language-plaintext highlighter-rouge">N</code>. By inversion on the rules <code class="language-plaintext highlighter-rouge">â†¦-elim</code> and <code class="language-plaintext highlighter-rouge">â†¦-intro</code>, we have that <code class="language-plaintext highlighter-rouge">Î³ , v âŠ¢ M â†“ w</code> and <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ N â†“ v</code>. So we need to show that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ M [ N ] â†“ w</code>, or equivalently, that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ subst (subst-zero N) M â†“ w</code>.</p><pre class="Agda"><a id="substitution"></a><a id="5667" href="/20.07/Soundness/#5667" class="Function">substitution</a> <a id="5680" class="Symbol">:</a> <a id="5682" class="Symbol">âˆ€</a> <a id="5684" class="Symbol">{</a><a id="5685" href="/20.07/Soundness/#5685" class="Bound">Î“</a><a id="5686" class="Symbol">}</a> <a id="5688" class="Symbol">{</a><a id="5689" href="/20.07/Soundness/#5689" class="Bound">Î³</a> <a id="5691" class="Symbol">:</a> <a id="5693" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="5697" href="/20.07/Soundness/#5685" class="Bound">Î“</a><a id="5698" class="Symbol">}</a> <a id="5700" class="Symbol">{</a><a id="5701" href="/20.07/Soundness/#5701" class="Bound">N</a> <a id="5703" href="/20.07/Soundness/#5703" class="Bound">M</a> <a id="5705" href="/20.07/Soundness/#5705" class="Bound">v</a> <a id="5707" href="/20.07/Soundness/#5707" class="Bound">w</a><a id="5708" class="Symbol">}</a>
   <a id="5713" class="Symbol">â†’</a> <a id="5715" href="/20.07/Soundness/#5689" class="Bound">Î³</a> <a id="5717" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="5720" href="/20.07/Soundness/#5705" class="Bound">v</a> <a id="5722" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="5724" href="/20.07/Soundness/#5701" class="Bound">N</a> <a id="5726" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="5728" href="/20.07/Soundness/#5707" class="Bound">w</a>
   <a id="5733" class="Symbol">â†’</a> <a id="5735" href="/20.07/Soundness/#5689" class="Bound">Î³</a> <a id="5737" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="5739" href="/20.07/Soundness/#5703" class="Bound">M</a> <a id="5741" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="5743" href="/20.07/Soundness/#5705" class="Bound">v</a>
     <a id="5750" class="Comment">---------------</a>
   <a id="5769" class="Symbol">â†’</a> <a id="5771" href="/20.07/Soundness/#5689" class="Bound">Î³</a> <a id="5773" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="5775" href="/20.07/Soundness/#5701" class="Bound">N</a> <a id="5777" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="5779" href="/20.07/Soundness/#5703" class="Bound">M</a> <a id="5781" href="/20.07/Untyped/#7491" class="Function Operator">]</a> <a id="5783" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="5785" href="/20.07/Soundness/#5707" class="Bound">w</a>
<a id="5787" href="/20.07/Soundness/#5667" class="Function">substitution</a><a id="5799" class="Symbol">{</a><a id="5800" href="/20.07/Soundness/#5800" class="Bound">Î“</a><a id="5801" class="Symbol">}{</a><a id="5803" href="/20.07/Soundness/#5803" class="Bound">Î³</a><a id="5804" class="Symbol">}{</a><a id="5806" href="/20.07/Soundness/#5806" class="Bound">N</a><a id="5807" class="Symbol">}{</a><a id="5809" href="/20.07/Soundness/#5809" class="Bound">M</a><a id="5810" class="Symbol">}{</a><a id="5812" href="/20.07/Soundness/#5812" class="Bound">v</a><a id="5813" class="Symbol">}{</a><a id="5815" href="/20.07/Soundness/#5815" class="Bound">w</a><a id="5816" class="Symbol">}</a> <a id="5818" href="/20.07/Soundness/#5818" class="Bound">dn</a> <a id="5821" href="/20.07/Soundness/#5821" class="Bound">dm</a> <a id="5824" class="Symbol">=</a>
  <a id="5828" href="/20.07/Soundness/#4200" class="Function">subst-pres</a> <a id="5839" class="Symbol">(</a><a id="5840" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="5851" href="/20.07/Soundness/#5809" class="Bound">M</a><a id="5852" class="Symbol">)</a> <a id="5854" href="/20.07/Soundness/#5876" class="Function">sub-z-ok</a> <a id="5863" href="/20.07/Soundness/#5818" class="Bound">dn</a>
  <a id="5868" class="Keyword">where</a>
  <a id="5876" href="/20.07/Soundness/#5876" class="Function">sub-z-ok</a> <a id="5885" class="Symbol">:</a> <a id="5887" href="/20.07/Soundness/#5803" class="Bound">Î³</a> <a id="5889" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="5892" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="5903" href="/20.07/Soundness/#5809" class="Bound">M</a> <a id="5905" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="5907" class="Symbol">(</a><a id="5908" href="/20.07/Soundness/#5803" class="Bound">Î³</a> <a id="5910" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="5913" href="/20.07/Soundness/#5812" class="Bound">v</a><a id="5914" class="Symbol">)</a>
  <a id="5918" href="/20.07/Soundness/#5876" class="Function">sub-z-ok</a> <a id="5927" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="5929" class="Symbol">=</a> <a id="5931" href="/20.07/Soundness/#5821" class="Bound">dm</a>
  <a id="5936" href="/20.07/Soundness/#5876" class="Function">sub-z-ok</a> <a id="5945" class="Symbol">(</a><a id="5946" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="5948" href="/20.07/Soundness/#5948" class="Bound">x</a><a id="5949" class="Symbol">)</a> <a id="5951" class="Symbol">=</a> <a id="5953" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a>
</pre><p>This result is a corollary of the lemma for simultaneous substitution. To use the lemma, we just need to show that <code class="language-plaintext highlighter-rouge">subst-zero M</code> maps variables to terms that produces the same values as those in <code class="language-plaintext highlighter-rouge">Î³ , v</code>. Let <code class="language-plaintext highlighter-rouge">y</code> be an arbitrary variable (de Bruijn index).</p><ul><li><p>If it is <code class="language-plaintext highlighter-rouge">Z</code>, then <code class="language-plaintext highlighter-rouge">(subst-zero M) y = M</code> and <code class="language-plaintext highlighter-rouge">(Î³ , v) y = v</code>. By the premise we conclude that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ M â†“ v</code>.</p></li><li><p>If it is <code class="language-plaintext highlighter-rouge">S x</code>, then <code class="language-plaintext highlighter-rouge">(subst-zero M) (S x) = x</code> and <code class="language-plaintext highlighter-rouge">(Î³ , v) (S x) = Î³ x</code>. So we conclude that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ x â†“ Î³ x</code> by rule <code class="language-plaintext highlighter-rouge">var</code>.</p></li></ul><h3 id="reduction-preserves-denotations">Reduction preserves denotations</h3><p>With the substitution lemma in hand, it is straightforward to prove that reduction preserves denotations.</p><pre class="Agda"><a id="preserve"></a><a id="6614" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6623" class="Symbol">:</a> <a id="6625" class="Symbol">âˆ€</a> <a id="6627" class="Symbol">{</a><a id="6628" href="/20.07/Soundness/#6628" class="Bound">Î“</a><a id="6629" class="Symbol">}</a> <a id="6631" class="Symbol">{</a><a id="6632" href="/20.07/Soundness/#6632" class="Bound">Î³</a> <a id="6634" class="Symbol">:</a> <a id="6636" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="6640" href="/20.07/Soundness/#6628" class="Bound">Î“</a><a id="6641" class="Symbol">}</a> <a id="6643" class="Symbol">{</a><a id="6644" href="/20.07/Soundness/#6644" class="Bound">M</a> <a id="6646" href="/20.07/Soundness/#6646" class="Bound">N</a> <a id="6648" href="/20.07/Soundness/#6648" class="Bound">v</a><a id="6649" class="Symbol">}</a>
  <a id="6653" class="Symbol">â†’</a> <a id="6655" href="/20.07/Soundness/#6632" class="Bound">Î³</a> <a id="6657" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="6659" href="/20.07/Soundness/#6644" class="Bound">M</a> <a id="6661" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="6663" href="/20.07/Soundness/#6648" class="Bound">v</a>
  <a id="6667" class="Symbol">â†’</a> <a id="6669" href="/20.07/Soundness/#6644" class="Bound">M</a> <a id="6671" href="/20.07/Untyped/#9948" class="Datatype Operator">â€”â†’</a> <a id="6674" href="/20.07/Soundness/#6646" class="Bound">N</a>
    <a id="6680" class="Comment">----------</a>
  <a id="6693" class="Symbol">â†’</a> <a id="6695" href="/20.07/Soundness/#6632" class="Bound">Î³</a> <a id="6697" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="6699" href="/20.07/Soundness/#6646" class="Bound">N</a> <a id="6701" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="6703" href="/20.07/Soundness/#6648" class="Bound">v</a>
<a id="6705" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6714" class="Symbol">(</a><a id="6715" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a><a id="6718" class="Symbol">)</a> <a id="6720" class="Symbol">()</a>
<a id="6723" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6732" class="Symbol">(</a><a id="6733" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="6740" href="/20.07/Soundness/#6740" class="Bound">dâ‚</a> <a id="6743" href="/20.07/Soundness/#6743" class="Bound">dâ‚‚</a><a id="6745" class="Symbol">)</a> <a id="6747" class="Symbol">(</a><a id="6748" href="/20.07/Untyped/#9998" class="InductiveConstructor">Î¾â‚</a> <a id="6751" href="/20.07/Soundness/#6751" class="Bound">r</a><a id="6752" class="Symbol">)</a> <a id="6754" class="Symbol">=</a> <a id="6756" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="6763" class="Symbol">(</a><a id="6764" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6773" href="/20.07/Soundness/#6740" class="Bound">dâ‚</a> <a id="6776" href="/20.07/Soundness/#6751" class="Bound">r</a><a id="6777" class="Symbol">)</a> <a id="6779" href="/20.07/Soundness/#6743" class="Bound">dâ‚‚</a>
<a id="6782" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6791" class="Symbol">(</a><a id="6792" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="6799" href="/20.07/Soundness/#6799" class="Bound">dâ‚</a> <a id="6802" href="/20.07/Soundness/#6802" class="Bound">dâ‚‚</a><a id="6804" class="Symbol">)</a> <a id="6806" class="Symbol">(</a><a id="6807" href="/20.07/Untyped/#10088" class="InductiveConstructor">Î¾â‚‚</a> <a id="6810" href="/20.07/Soundness/#6810" class="Bound">r</a><a id="6811" class="Symbol">)</a> <a id="6813" class="Symbol">=</a> <a id="6815" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="6822" href="/20.07/Soundness/#6799" class="Bound">dâ‚</a> <a id="6825" class="Symbol">(</a><a id="6826" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6835" href="/20.07/Soundness/#6802" class="Bound">dâ‚‚</a> <a id="6838" href="/20.07/Soundness/#6810" class="Bound">r</a><a id="6839" class="Symbol">)</a>
<a id="6841" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6850" class="Symbol">(</a><a id="6851" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="6858" href="/20.07/Soundness/#6858" class="Bound">dâ‚</a> <a id="6861" href="/20.07/Soundness/#6861" class="Bound">dâ‚‚</a><a id="6863" class="Symbol">)</a> <a id="6865" href="/20.07/Untyped/#10178" class="InductiveConstructor">Î²</a> <a id="6867" class="Symbol">=</a> <a id="6869" href="/20.07/Soundness/#5667" class="Function">substitution</a> <a id="6882" class="Symbol">(</a><a id="6883" href="/20.07/Compositional/#3841" class="Function">lambda-inversion</a> <a id="6900" href="/20.07/Soundness/#6858" class="Bound">dâ‚</a><a id="6902" class="Symbol">)</a> <a id="6904" href="/20.07/Soundness/#6861" class="Bound">dâ‚‚</a>
<a id="6907" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6916" class="Symbol">(</a><a id="6917" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="6925" href="/20.07/Soundness/#6925" class="Bound">d</a><a id="6926" class="Symbol">)</a> <a id="6928" class="Symbol">(</a><a id="6929" href="/20.07/Untyped/#10286" class="InductiveConstructor">Î¶</a> <a id="6931" href="/20.07/Soundness/#6931" class="Bound">r</a><a id="6932" class="Symbol">)</a> <a id="6934" class="Symbol">=</a> <a id="6936" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="6944" class="Symbol">(</a><a id="6945" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6954" href="/20.07/Soundness/#6925" class="Bound">d</a> <a id="6956" href="/20.07/Soundness/#6931" class="Bound">r</a><a id="6957" class="Symbol">)</a>
<a id="6959" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6968" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a> <a id="6976" href="/20.07/Soundness/#6976" class="Bound">r</a> <a id="6978" class="Symbol">=</a> <a id="6980" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a>
<a id="6988" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="6997" class="Symbol">(</a><a id="6998" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="7006" href="/20.07/Soundness/#7006" class="Bound">d</a> <a id="7008" href="/20.07/Soundness/#7008" class="Bound">dâ‚</a><a id="7010" class="Symbol">)</a> <a id="7012" href="/20.07/Soundness/#7012" class="Bound">r</a> <a id="7014" class="Symbol">=</a> <a id="7016" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="7024" class="Symbol">(</a><a id="7025" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="7034" href="/20.07/Soundness/#7006" class="Bound">d</a> <a id="7036" href="/20.07/Soundness/#7012" class="Bound">r</a><a id="7037" class="Symbol">)</a> <a id="7039" class="Symbol">(</a><a id="7040" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="7049" href="/20.07/Soundness/#7008" class="Bound">dâ‚</a> <a id="7052" href="/20.07/Soundness/#7012" class="Bound">r</a><a id="7053" class="Symbol">)</a>
<a id="7055" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="7064" class="Symbol">(</a><a id="7065" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="7069" href="/20.07/Soundness/#7069" class="Bound">d</a> <a id="7071" href="/20.07/Soundness/#7071" class="Bound">lt</a><a id="7073" class="Symbol">)</a> <a id="7075" href="/20.07/Soundness/#7075" class="Bound">r</a> <a id="7077" class="Symbol">=</a> <a id="7079" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="7083" class="Symbol">(</a><a id="7084" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="7093" href="/20.07/Soundness/#7069" class="Bound">d</a> <a id="7095" href="/20.07/Soundness/#7075" class="Bound">r</a><a id="7096" class="Symbol">)</a> <a id="7098" href="/20.07/Soundness/#7071" class="Bound">lt</a>
</pre><p>We proceed by induction on the semantics of <code class="language-plaintext highlighter-rouge">M</code> with case analysis on the reduction.</p><ul><li><p>If <code class="language-plaintext highlighter-rouge">M</code> is a variable, then there is no such reduction.</p></li><li><p>If <code class="language-plaintext highlighter-rouge">M</code> is an application, then the reduction is either a congruence (Î¾â‚ or Î¾â‚‚) or Î². For each congruence, we use the induction hypothesis. For Î² reduction we use the substitution lemma and the <code class="language-plaintext highlighter-rouge">sub</code> rule.</p></li><li><p>The rest of the cases are straightforward.</p></li></ul><h2 id="reduction-reflects-denotations">Reduction reflects denotations</h2><p>This section proves that reduction reflects the denotation of a term. That is, if <code class="language-plaintext highlighter-rouge">N</code> results in <code class="language-plaintext highlighter-rouge">v</code>, and if <code class="language-plaintext highlighter-rouge">M</code> reduces to <code class="language-plaintext highlighter-rouge">N</code>, then <code class="language-plaintext highlighter-rouge">M</code> also results in <code class="language-plaintext highlighter-rouge">v</code>. While there are some broad similarities between this proof and the above proof of semantic preservation, we shall require a few more technical lemmas to obtain this result.</p><p>The main challenge is dealing with the substitution in Î² reduction:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(Æ› N) Â· M â€”â†’ N [ M ]
</code></pre></div></div><p>We have that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ N [ M ] â†“ v</code> and need to show that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ (Æ› N) Â· M â†“ v</code>. Now consider the derivation of <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ N [ M ] â†“ v</code>. The term <code class="language-plaintext highlighter-rouge">M</code> may occur 0, 1, or many times inside <code class="language-plaintext highlighter-rouge">N [ M ]</code>. At each of those occurences, <code class="language-plaintext highlighter-rouge">M</code> may result in a different value. But to build a derivation for <code class="language-plaintext highlighter-rouge">(Æ› N) Â· M</code>, we need a single value for <code class="language-plaintext highlighter-rouge">M</code>. If <code class="language-plaintext highlighter-rouge">M</code> occured more than 1 time, then we can join all of the different values using <code class="language-plaintext highlighter-rouge">âŠ”</code>. If <code class="language-plaintext highlighter-rouge">M</code> occured 0 times, then we do not need any information about <code class="language-plaintext highlighter-rouge">M</code> and can therefore use <code class="language-plaintext highlighter-rouge">âŠ¥</code> for the value of <code class="language-plaintext highlighter-rouge">M</code>.</p><h3 id="renaming-reflects-meaning">Renaming reflects meaning</h3><p>Previously we showed that renaming variables preserves meaning. Now we prove the opposite, that it reflects meaning. That is, if <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ rename Ï M â†“ v</code>, then <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ M â†“ v</code>, where <code class="language-plaintext highlighter-rouge">(Î´ âˆ˜ Ï)</code>âŠ‘ Î³`.</p><p>First, we need a variant of a lemma given earlier.</p><pre class="Agda"><a id="ext-âŠ‘â€²"></a><a id="8788" href="/20.07/Soundness/#8788" class="Function">ext-âŠ‘â€²</a> <a id="8795" class="Symbol">:</a> <a id="8797" class="Symbol">âˆ€</a> <a id="8799" class="Symbol">{</a><a id="8800" href="/20.07/Soundness/#8800" class="Bound">Î“</a> <a id="8802" href="/20.07/Soundness/#8802" class="Bound">Î”</a> <a id="8804" href="/20.07/Soundness/#8804" class="Bound">v</a><a id="8805" class="Symbol">}</a> <a id="8807" class="Symbol">{</a><a id="8808" href="/20.07/Soundness/#8808" class="Bound">Î³</a> <a id="8810" class="Symbol">:</a> <a id="8812" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="8816" href="/20.07/Soundness/#8800" class="Bound">Î“</a><a id="8817" class="Symbol">}</a> <a id="8819" class="Symbol">{</a><a id="8820" href="/20.07/Soundness/#8820" class="Bound">Î´</a> <a id="8822" class="Symbol">:</a> <a id="8824" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="8828" href="/20.07/Soundness/#8802" class="Bound">Î”</a><a id="8829" class="Symbol">}</a>
  <a id="8833" class="Symbol">â†’</a> <a id="8835" class="Symbol">(</a><a id="8836" href="/20.07/Soundness/#8836" class="Bound">Ï</a> <a id="8838" class="Symbol">:</a> <a id="8840" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="8847" href="/20.07/Soundness/#8800" class="Bound">Î“</a> <a id="8849" href="/20.07/Soundness/#8802" class="Bound">Î”</a><a id="8850" class="Symbol">)</a>
  <a id="8854" class="Symbol">â†’</a> <a id="8856" class="Symbol">(</a><a id="8857" href="/20.07/Soundness/#8820" class="Bound">Î´</a> <a id="8859" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">âˆ˜</a> <a id="8861" href="/20.07/Soundness/#8836" class="Bound">Ï</a><a id="8862" class="Symbol">)</a> <a id="8864" href="/20.07/Denotational/#8108" class="Function Operator">`âŠ‘</a> <a id="8867" href="/20.07/Soundness/#8808" class="Bound">Î³</a>
    <a id="8873" class="Comment">------------------------------</a>
  <a id="8906" class="Symbol">â†’</a> <a id="8908" class="Symbol">((</a><a id="8910" href="/20.07/Soundness/#8820" class="Bound">Î´</a> <a id="8912" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="8915" href="/20.07/Soundness/#8804" class="Bound">v</a><a id="8916" class="Symbol">)</a> <a id="8918" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">âˆ˜</a> <a id="8920" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="8924" href="/20.07/Soundness/#8836" class="Bound">Ï</a><a id="8925" class="Symbol">)</a> <a id="8927" href="/20.07/Denotational/#8108" class="Function Operator">`âŠ‘</a> <a id="8930" class="Symbol">(</a><a id="8931" href="/20.07/Soundness/#8808" class="Bound">Î³</a> <a id="8933" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="8936" href="/20.07/Soundness/#8804" class="Bound">v</a><a id="8937" class="Symbol">)</a>
<a id="8939" href="/20.07/Soundness/#8788" class="Function">ext-âŠ‘â€²</a> <a id="8946" href="/20.07/Soundness/#8946" class="Bound">Ï</a> <a id="8948" href="/20.07/Soundness/#8948" class="Bound">lt</a> <a id="8951" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="8953" class="Symbol">=</a> <a id="8955" href="/20.07/Denotational/#5638" class="Function">âŠ‘-refl</a>
<a id="8962" href="/20.07/Soundness/#8788" class="Function">ext-âŠ‘â€²</a> <a id="8969" href="/20.07/Soundness/#8969" class="Bound">Ï</a> <a id="8971" href="/20.07/Soundness/#8971" class="Bound">lt</a> <a id="8974" class="Symbol">(</a><a id="8975" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="8977" href="/20.07/Soundness/#8977" class="Bound">x</a><a id="8978" class="Symbol">)</a> <a id="8980" class="Symbol">=</a> <a id="8982" href="/20.07/Soundness/#8971" class="Bound">lt</a> <a id="8985" href="/20.07/Soundness/#8977" class="Bound">x</a>
</pre><p>The proof is then as follows.</p><pre class="Agda"><a id="rename-reflect"></a><a id="9026" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9041" class="Symbol">:</a> <a id="9043" class="Symbol">âˆ€</a> <a id="9045" class="Symbol">{</a><a id="9046" href="/20.07/Soundness/#9046" class="Bound">Î“</a> <a id="9048" href="/20.07/Soundness/#9048" class="Bound">Î”</a> <a id="9050" href="/20.07/Soundness/#9050" class="Bound">v</a><a id="9051" class="Symbol">}</a> <a id="9053" class="Symbol">{</a><a id="9054" href="/20.07/Soundness/#9054" class="Bound">Î³</a> <a id="9056" class="Symbol">:</a> <a id="9058" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="9062" href="/20.07/Soundness/#9046" class="Bound">Î“</a><a id="9063" class="Symbol">}</a> <a id="9065" class="Symbol">{</a><a id="9066" href="/20.07/Soundness/#9066" class="Bound">Î´</a> <a id="9068" class="Symbol">:</a> <a id="9070" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="9074" href="/20.07/Soundness/#9048" class="Bound">Î”</a><a id="9075" class="Symbol">}</a> <a id="9077" class="Symbol">{</a> <a id="9079" href="/20.07/Soundness/#9079" class="Bound">M</a> <a id="9081" class="Symbol">:</a> <a id="9083" href="/20.07/Soundness/#9046" class="Bound">Î“</a> <a id="9085" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="9087" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="9088" class="Symbol">}</a>
  <a id="9092" class="Symbol">â†’</a> <a id="9094" class="Symbol">{</a><a id="9095" href="/20.07/Soundness/#9095" class="Bound">Ï</a> <a id="9097" class="Symbol">:</a> <a id="9099" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="9106" href="/20.07/Soundness/#9046" class="Bound">Î“</a> <a id="9108" href="/20.07/Soundness/#9048" class="Bound">Î”</a><a id="9109" class="Symbol">}</a>
  <a id="9113" class="Symbol">â†’</a> <a id="9115" class="Symbol">(</a><a id="9116" href="/20.07/Soundness/#9066" class="Bound">Î´</a> <a id="9118" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">âˆ˜</a> <a id="9120" href="/20.07/Soundness/#9095" class="Bound">Ï</a><a id="9121" class="Symbol">)</a> <a id="9123" href="/20.07/Denotational/#8108" class="Function Operator">`âŠ‘</a> <a id="9126" href="/20.07/Soundness/#9054" class="Bound">Î³</a>
  <a id="9130" class="Symbol">â†’</a> <a id="9132" href="/20.07/Soundness/#9066" class="Bound">Î´</a> <a id="9134" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="9136" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="9143" href="/20.07/Soundness/#9095" class="Bound">Ï</a> <a id="9145" href="/20.07/Soundness/#9079" class="Bound">M</a> <a id="9147" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="9149" href="/20.07/Soundness/#9050" class="Bound">v</a>
    <a id="9155" class="Comment">------------------------------------</a>
  <a id="9194" class="Symbol">â†’</a> <a id="9196" href="/20.07/Soundness/#9054" class="Bound">Î³</a> <a id="9198" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="9200" href="/20.07/Soundness/#9079" class="Bound">M</a> <a id="9202" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="9204" href="/20.07/Soundness/#9050" class="Bound">v</a>
<a id="9206" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9221" class="Symbol">{</a><a id="9222" class="Argument">M</a> <a id="9224" class="Symbol">=</a> <a id="9226" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="9228" href="/20.07/Soundness/#9228" class="Bound">x</a><a id="9229" class="Symbol">}</a> <a id="9231" href="/20.07/Soundness/#9231" class="Bound">all-n</a> <a id="9237" href="/20.07/Soundness/#9237" class="Bound">d</a> <a id="9239" class="Keyword">with</a> <a id="9244" href="/20.07/Compositional/#10012" class="Function">var-inv</a> <a id="9252" href="/20.07/Soundness/#9237" class="Bound">d</a>
<a id="9254" class="Symbol">...</a> <a id="9258" class="Symbol">|</a> <a id="9260" href="/20.07/Soundness/#9260" class="Bound">lt</a> <a id="9263" class="Symbol">=</a>  <a id="9266" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="9270" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="9274" class="Symbol">(</a><a id="9275" href="/20.07/Denotational/#4798" class="InductiveConstructor">âŠ‘-trans</a> <a id="9283" href="/20.07/Soundness/#9260" class="Bound">lt</a> <a id="9286" class="Symbol">(</a><a id="9287" class="Bound">all-n</a> <a id="9293" class="Bound">x</a><a id="9294" class="Symbol">))</a>
<a id="9297" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9312" class="Symbol">{</a><a id="9313" class="Argument">M</a> <a id="9315" class="Symbol">=</a> <a id="9317" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="9319" href="/20.07/Soundness/#9319" class="Bound">N</a><a id="9320" class="Symbol">}{</a><a id="9322" class="Argument">Ï</a> <a id="9324" class="Symbol">=</a> <a id="9326" href="/20.07/Soundness/#9326" class="Bound">Ï</a><a id="9327" class="Symbol">}</a> <a id="9329" href="/20.07/Soundness/#9329" class="Bound">all-n</a> <a id="9335" class="Symbol">(</a><a id="9336" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="9344" href="/20.07/Soundness/#9344" class="Bound">d</a><a id="9345" class="Symbol">)</a> <a id="9347" class="Symbol">=</a>
   <a id="9352" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="9360" class="Symbol">(</a><a id="9361" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9376" class="Symbol">(</a><a id="9377" href="/20.07/Soundness/#8788" class="Function">ext-âŠ‘â€²</a> <a id="9384" href="/20.07/Soundness/#9326" class="Bound">Ï</a> <a id="9386" href="/20.07/Soundness/#9329" class="Bound">all-n</a><a id="9391" class="Symbol">)</a> <a id="9393" href="/20.07/Soundness/#9344" class="Bound">d</a><a id="9394" class="Symbol">)</a>
<a id="9396" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9411" class="Symbol">{</a><a id="9412" class="Argument">M</a> <a id="9414" class="Symbol">=</a> <a id="9416" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="9418" href="/20.07/Soundness/#9418" class="Bound">N</a><a id="9419" class="Symbol">}</a> <a id="9421" href="/20.07/Soundness/#9421" class="Bound">all-n</a> <a id="9427" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a> <a id="9435" class="Symbol">=</a> <a id="9437" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a>
<a id="9445" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9460" class="Symbol">{</a><a id="9461" class="Argument">M</a> <a id="9463" class="Symbol">=</a> <a id="9465" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="9467" href="/20.07/Soundness/#9467" class="Bound">N</a><a id="9468" class="Symbol">}</a> <a id="9470" href="/20.07/Soundness/#9470" class="Bound">all-n</a> <a id="9476" class="Symbol">(</a><a id="9477" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="9485" href="/20.07/Soundness/#9485" class="Bound">dâ‚</a> <a id="9488" href="/20.07/Soundness/#9488" class="Bound">dâ‚‚</a><a id="9490" class="Symbol">)</a> <a id="9492" class="Symbol">=</a>
   <a id="9497" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="9505" class="Symbol">(</a><a id="9506" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9521" href="/20.07/Soundness/#9470" class="Bound">all-n</a> <a id="9527" href="/20.07/Soundness/#9485" class="Bound">dâ‚</a><a id="9529" class="Symbol">)</a> <a id="9531" class="Symbol">(</a><a id="9532" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9547" href="/20.07/Soundness/#9470" class="Bound">all-n</a> <a id="9553" href="/20.07/Soundness/#9488" class="Bound">dâ‚‚</a><a id="9555" class="Symbol">)</a>
<a id="9557" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9572" class="Symbol">{</a><a id="9573" class="Argument">M</a> <a id="9575" class="Symbol">=</a> <a id="9577" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="9579" href="/20.07/Soundness/#9579" class="Bound">N</a><a id="9580" class="Symbol">}</a> <a id="9582" href="/20.07/Soundness/#9582" class="Bound">all-n</a> <a id="9588" class="Symbol">(</a><a id="9589" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="9593" href="/20.07/Soundness/#9593" class="Bound">dâ‚</a> <a id="9596" href="/20.07/Soundness/#9596" class="Bound">lt</a><a id="9598" class="Symbol">)</a> <a id="9600" class="Symbol">=</a>
   <a id="9605" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="9609" class="Symbol">(</a><a id="9610" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9625" href="/20.07/Soundness/#9582" class="Bound">all-n</a> <a id="9631" href="/20.07/Soundness/#9593" class="Bound">dâ‚</a><a id="9633" class="Symbol">)</a> <a id="9635" href="/20.07/Soundness/#9596" class="Bound">lt</a>
<a id="9638" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9653" class="Symbol">{</a><a id="9654" class="Argument">M</a> <a id="9656" class="Symbol">=</a> <a id="9658" href="/20.07/Soundness/#9658" class="Bound">L</a> <a id="9660" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">Â·</a> <a id="9662" href="/20.07/Soundness/#9662" class="Bound">M</a><a id="9663" class="Symbol">}</a> <a id="9665" href="/20.07/Soundness/#9665" class="Bound">all-n</a> <a id="9671" class="Symbol">(</a><a id="9672" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="9679" href="/20.07/Soundness/#9679" class="Bound">dâ‚</a> <a id="9682" href="/20.07/Soundness/#9682" class="Bound">dâ‚‚</a><a id="9684" class="Symbol">)</a> <a id="9686" class="Symbol">=</a>
   <a id="9691" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="9698" class="Symbol">(</a><a id="9699" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9714" href="/20.07/Soundness/#9665" class="Bound">all-n</a> <a id="9720" href="/20.07/Soundness/#9679" class="Bound">dâ‚</a><a id="9722" class="Symbol">)</a> <a id="9724" class="Symbol">(</a><a id="9725" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9740" href="/20.07/Soundness/#9665" class="Bound">all-n</a> <a id="9746" href="/20.07/Soundness/#9682" class="Bound">dâ‚‚</a><a id="9748" class="Symbol">)</a>
<a id="9750" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9765" class="Symbol">{</a><a id="9766" class="Argument">M</a> <a id="9768" class="Symbol">=</a> <a id="9770" href="/20.07/Soundness/#9770" class="Bound">L</a> <a id="9772" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">Â·</a> <a id="9774" href="/20.07/Soundness/#9774" class="Bound">M</a><a id="9775" class="Symbol">}</a> <a id="9777" href="/20.07/Soundness/#9777" class="Bound">all-n</a> <a id="9783" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a> <a id="9791" class="Symbol">=</a> <a id="9793" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a>
<a id="9801" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9816" class="Symbol">{</a><a id="9817" class="Argument">M</a> <a id="9819" class="Symbol">=</a> <a id="9821" href="/20.07/Soundness/#9821" class="Bound">L</a> <a id="9823" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">Â·</a> <a id="9825" href="/20.07/Soundness/#9825" class="Bound">M</a><a id="9826" class="Symbol">}</a> <a id="9828" href="/20.07/Soundness/#9828" class="Bound">all-n</a> <a id="9834" class="Symbol">(</a><a id="9835" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="9843" href="/20.07/Soundness/#9843" class="Bound">dâ‚</a> <a id="9846" href="/20.07/Soundness/#9846" class="Bound">dâ‚‚</a><a id="9848" class="Symbol">)</a> <a id="9850" class="Symbol">=</a>
   <a id="9855" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="9863" class="Symbol">(</a><a id="9864" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9879" href="/20.07/Soundness/#9828" class="Bound">all-n</a> <a id="9885" href="/20.07/Soundness/#9843" class="Bound">dâ‚</a><a id="9887" class="Symbol">)</a> <a id="9889" class="Symbol">(</a><a id="9890" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9905" href="/20.07/Soundness/#9828" class="Bound">all-n</a> <a id="9911" href="/20.07/Soundness/#9846" class="Bound">dâ‚‚</a><a id="9913" class="Symbol">)</a>
<a id="9915" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9930" class="Symbol">{</a><a id="9931" class="Argument">M</a> <a id="9933" class="Symbol">=</a> <a id="9935" href="/20.07/Soundness/#9935" class="Bound">L</a> <a id="9937" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">Â·</a> <a id="9939" href="/20.07/Soundness/#9939" class="Bound">M</a><a id="9940" class="Symbol">}</a> <a id="9942" href="/20.07/Soundness/#9942" class="Bound">all-n</a> <a id="9948" class="Symbol">(</a><a id="9949" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="9953" href="/20.07/Soundness/#9953" class="Bound">dâ‚</a> <a id="9956" href="/20.07/Soundness/#9956" class="Bound">lt</a><a id="9958" class="Symbol">)</a> <a id="9960" class="Symbol">=</a>
   <a id="9965" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="9969" class="Symbol">(</a><a id="9970" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="9985" href="/20.07/Soundness/#9942" class="Bound">all-n</a> <a id="9991" href="/20.07/Soundness/#9953" class="Bound">dâ‚</a><a id="9993" class="Symbol">)</a> <a id="9995" href="/20.07/Soundness/#9956" class="Bound">lt</a>
</pre><p>We cannot prove this lemma by induction on the derivation of <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ rename Ï M â†“ v</code>, so instead we proceed by induction on <code class="language-plaintext highlighter-rouge">M</code>.</p><ul><li><p>If it is a variable, we apply the inversion lemma to obtain that <code class="language-plaintext highlighter-rouge">v âŠ‘ Î´ (Ï x)</code>. Instantiating the premise to <code class="language-plaintext highlighter-rouge">x</code> we have <code class="language-plaintext highlighter-rouge">Î´ (Ï x) = Î³ x</code>, so we conclude by the <code class="language-plaintext highlighter-rouge">var</code> rule.</p></li><li><p>If it is a lambda abstraction <code class="language-plaintext highlighter-rouge">Æ› N</code>, we have rename <code class="language-plaintext highlighter-rouge">Ï (Æ› N) = Æ› (rename (ext Ï) N)</code>. We proceed by cases on <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ Æ› (rename (ext Ï) N) â†“ v</code>.</p><ul><li><p>Rule <code class="language-plaintext highlighter-rouge">â†¦-intro</code>: To satisfy the premise of the induction hypothesis, we prove that the renaming can be extended to be a mapping from <code class="language-plaintext highlighter-rouge">Î³ , vâ‚ to Î´ , vâ‚</code>.</p></li><li><p>Rule <code class="language-plaintext highlighter-rouge">âŠ¥-intro</code>: We simply apply <code class="language-plaintext highlighter-rouge">âŠ¥-intro</code>.</p></li><li><p>Rule <code class="language-plaintext highlighter-rouge">âŠ”-intro</code>: We apply the induction hypotheses and <code class="language-plaintext highlighter-rouge">âŠ”-intro</code>.</p></li><li><p>Rule <code class="language-plaintext highlighter-rouge">sub</code>: We apply the induction hypothesis and <code class="language-plaintext highlighter-rouge">sub</code>.</p></li></ul></li><li><p>If it is an application <code class="language-plaintext highlighter-rouge">L Â· M</code>, we have <code class="language-plaintext highlighter-rouge">rename Ï (L Â· M) = (rename Ï L) Â· (rename Ï M)</code>. We proceed by cases on <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ (rename Ï L) Â· (rename Ï M) â†“ v</code> and all the cases are straightforward.</p></li></ul><p>In the upcoming uses of <code class="language-plaintext highlighter-rouge">rename-reflect</code>, the renaming will always be the increment function. So we prove a corollary for that special case.</p><pre class="Agda"><a id="rename-inc-reflect"></a><a id="11148" href="/20.07/Soundness/#11148" class="Function">rename-inc-reflect</a> <a id="11167" class="Symbol">:</a> <a id="11169" class="Symbol">âˆ€</a> <a id="11171" class="Symbol">{</a><a id="11172" href="/20.07/Soundness/#11172" class="Bound">Î“</a> <a id="11174" href="/20.07/Soundness/#11174" class="Bound">vâ€²</a> <a id="11177" href="/20.07/Soundness/#11177" class="Bound">v</a><a id="11178" class="Symbol">}</a> <a id="11180" class="Symbol">{</a><a id="11181" href="/20.07/Soundness/#11181" class="Bound">Î³</a> <a id="11183" class="Symbol">:</a> <a id="11185" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="11189" href="/20.07/Soundness/#11172" class="Bound">Î“</a><a id="11190" class="Symbol">}</a> <a id="11192" class="Symbol">{</a> <a id="11194" href="/20.07/Soundness/#11194" class="Bound">M</a> <a id="11196" class="Symbol">:</a> <a id="11198" href="/20.07/Soundness/#11172" class="Bound">Î“</a> <a id="11200" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="11202" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="11203" class="Symbol">}</a>
  <a id="11207" class="Symbol">â†’</a> <a id="11209" class="Symbol">(</a><a id="11210" href="/20.07/Soundness/#11181" class="Bound">Î³</a> <a id="11212" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="11215" href="/20.07/Soundness/#11174" class="Bound">vâ€²</a><a id="11217" class="Symbol">)</a> <a id="11219" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="11221" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="11228" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="11231" href="/20.07/Soundness/#11194" class="Bound">M</a> <a id="11233" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="11235" href="/20.07/Soundness/#11177" class="Bound">v</a>
    <a id="11241" class="Comment">----------------------------</a>
  <a id="11272" class="Symbol">â†’</a> <a id="11274" href="/20.07/Soundness/#11181" class="Bound">Î³</a> <a id="11276" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="11278" href="/20.07/Soundness/#11194" class="Bound">M</a> <a id="11280" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="11282" href="/20.07/Soundness/#11177" class="Bound">v</a>
<a id="11284" href="/20.07/Soundness/#11148" class="Function">rename-inc-reflect</a> <a id="11303" href="/20.07/Soundness/#11303" class="Bound">d</a> <a id="11305" class="Symbol">=</a> <a id="11307" href="/20.07/Soundness/#9026" class="Function">rename-reflect</a> <a id="11322" href="/20.07/Denotational/#8599" class="Function">`âŠ‘-refl</a> <a id="11330" href="/20.07/Soundness/#11303" class="Bound">d</a>
</pre><h3 id="substitution-reflects-denotations-the-variable-case">Substitution reflects denotations, the variable case</h3><p>We are almost ready to begin proving that simultaneous substitution reflects denotations. That is, if <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ (subst Ïƒ M) â†“ v</code>, then <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ k â†“ Î´ k</code> and <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ M â†“ v</code> for any <code class="language-plaintext highlighter-rouge">k</code> and some <code class="language-plaintext highlighter-rouge">Î´</code>. We shall start with the case in which <code class="language-plaintext highlighter-rouge">M</code> is a variable <code class="language-plaintext highlighter-rouge">x</code>. So instead the premise is <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ x â†“ v</code> and we need to show that <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ x â†“ v</code> for some <code class="language-plaintext highlighter-rouge">Î´</code>. The <code class="language-plaintext highlighter-rouge">Î´</code> that we choose shall be the environment that maps <code class="language-plaintext highlighter-rouge">x</code> to <code class="language-plaintext highlighter-rouge">v</code> and every other variable to <code class="language-plaintext highlighter-rouge">âŠ¥</code>.</p><p>Next we define the environment that maps <code class="language-plaintext highlighter-rouge">x</code> to <code class="language-plaintext highlighter-rouge">v</code> and every other variable to <code class="language-plaintext highlighter-rouge">âŠ¥</code>, that is <code class="language-plaintext highlighter-rouge">const-env x v</code>. To tell variables apart, we define the following function for deciding equality of variables.</p><pre class="Agda"><a id="_varâ‰Ÿ_"></a><a id="12048" href="/20.07/Soundness/#12048" class="Function Operator">_varâ‰Ÿ_</a> <a id="12055" class="Symbol">:</a> <a id="12057" class="Symbol">âˆ€</a> <a id="12059" class="Symbol">{</a><a id="12060" href="/20.07/Soundness/#12060" class="Bound">Î“</a><a id="12061" class="Symbol">}</a> <a id="12063" class="Symbol">â†’</a> <a id="12065" class="Symbol">(</a><a id="12066" href="/20.07/Soundness/#12066" class="Bound">x</a> <a id="12068" href="/20.07/Soundness/#12068" class="Bound">y</a> <a id="12070" class="Symbol">:</a> <a id="12072" href="/20.07/Soundness/#12060" class="Bound">Î“</a> <a id="12074" href="/20.07/Untyped/#3521" class="Datatype Operator">âˆ‹</a> <a id="12076" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="12077" class="Symbol">)</a> <a id="12079" class="Symbol">â†’</a> <a id="12081" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#605" class="Datatype">Dec</a> <a id="12085" class="Symbol">(</a><a id="12086" href="/20.07/Soundness/#12066" class="Bound">x</a> <a id="12088" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">â‰¡</a> <a id="12090" href="/20.07/Soundness/#12068" class="Bound">y</a><a id="12091" class="Symbol">)</a>
<a id="12093" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="12095" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="12100" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a>  <a id="12103" class="Symbol">=</a>  <a id="12106" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12110" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="12115" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="12117" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="12122" class="Symbol">(</a><a id="12123" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="12125" class="Symbol">_)</a>  <a id="12129" class="Symbol">=</a>  <a id="12132" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12135" class="Symbol">Î»()</a>
<a id="12139" class="Symbol">(</a><a id="12140" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="12142" class="Symbol">_)</a> <a id="12145" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="12150" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a>  <a id="12153" class="Symbol">=</a>  <a id="12156" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12159" class="Symbol">Î»()</a>
<a id="12163" class="Symbol">(</a><a id="12164" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="12166" href="/20.07/Soundness/#12166" class="Bound">x</a><a id="12167" class="Symbol">)</a> <a id="12169" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="12174" class="Symbol">(</a><a id="12175" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="12177" href="/20.07/Soundness/#12177" class="Bound">y</a><a id="12178" class="Symbol">)</a> <a id="12180" class="Keyword">with</a>  <a id="12186" href="/20.07/Soundness/#12166" class="Bound">x</a> <a id="12188" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="12193" href="/20.07/Soundness/#12177" class="Bound">y</a>
<a id="12195" class="Symbol">...</a>                 <a id="12215" class="Symbol">|</a>  <a id="12218" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12222" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="12227" class="Symbol">=</a>  <a id="12230" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12234" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="12239" class="Symbol">...</a>                 <a id="12259" class="Symbol">|</a>  <a id="12262" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12265" href="/20.07/Soundness/#12265" class="Bound">neq</a>   <a id="12271" class="Symbol">=</a>  <a id="12274" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12277" class="Symbol">Î»{</a><a id="12279" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="12284" class="Symbol">â†’</a> <a id="12286" href="/20.07/Soundness/#12265" class="Bound">neq</a> <a id="12290" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="12294" class="Symbol">}</a>

<a id="varâ‰Ÿ-refl"></a><a id="12297" href="/20.07/Soundness/#12297" class="Function">varâ‰Ÿ-refl</a> <a id="12307" class="Symbol">:</a> <a id="12309" class="Symbol">âˆ€</a> <a id="12311" class="Symbol">{</a><a id="12312" href="/20.07/Soundness/#12312" class="Bound">Î“</a><a id="12313" class="Symbol">}</a> <a id="12315" class="Symbol">(</a><a id="12316" href="/20.07/Soundness/#12316" class="Bound">x</a> <a id="12318" class="Symbol">:</a> <a id="12320" href="/20.07/Soundness/#12312" class="Bound">Î“</a> <a id="12322" href="/20.07/Untyped/#3521" class="Datatype Operator">âˆ‹</a> <a id="12324" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="12325" class="Symbol">)</a> <a id="12327" class="Symbol">â†’</a> <a id="12329" class="Symbol">(</a><a id="12330" href="/20.07/Soundness/#12316" class="Bound">x</a> <a id="12332" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="12337" href="/20.07/Soundness/#12316" class="Bound">x</a><a id="12338" class="Symbol">)</a> <a id="12340" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">â‰¡</a> <a id="12342" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12346" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="12351" href="/20.07/Soundness/#12297" class="Function">varâ‰Ÿ-refl</a> <a id="12361" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="12363" class="Symbol">=</a> <a id="12365" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="12370" href="/20.07/Soundness/#12297" class="Function">varâ‰Ÿ-refl</a> <a id="12380" class="Symbol">(</a><a id="12381" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="12383" href="/20.07/Soundness/#12383" class="Bound">x</a><a id="12384" class="Symbol">)</a> <a id="12386" class="Keyword">rewrite</a> <a id="12394" href="/20.07/Soundness/#12297" class="Function">varâ‰Ÿ-refl</a> <a id="12404" href="/20.07/Soundness/#12383" class="Bound">x</a> <a id="12406" class="Symbol">=</a> <a id="12408" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre><p>Now we use <code class="language-plaintext highlighter-rouge">varâ‰Ÿ</code> to define <code class="language-plaintext highlighter-rouge">const-env</code>.</p><pre class="Agda"><a id="const-env"></a><a id="12464" href="/20.07/Soundness/#12464" class="Function">const-env</a> <a id="12474" class="Symbol">:</a> <a id="12476" class="Symbol">âˆ€{</a><a id="12478" href="/20.07/Soundness/#12478" class="Bound">Î“</a><a id="12479" class="Symbol">}</a> <a id="12481" class="Symbol">â†’</a> <a id="12483" class="Symbol">(</a><a id="12484" href="/20.07/Soundness/#12484" class="Bound">x</a> <a id="12486" class="Symbol">:</a> <a id="12488" href="/20.07/Soundness/#12478" class="Bound">Î“</a> <a id="12490" href="/20.07/Untyped/#3521" class="Datatype Operator">âˆ‹</a> <a id="12492" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="12493" class="Symbol">)</a> <a id="12495" class="Symbol">â†’</a> <a id="12497" href="/20.07/Denotational/#4151" class="Datatype">Value</a> <a id="12503" class="Symbol">â†’</a> <a id="12505" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="12509" href="/20.07/Soundness/#12478" class="Bound">Î“</a>
<a id="12511" href="/20.07/Soundness/#12464" class="Function">const-env</a> <a id="12521" href="/20.07/Soundness/#12521" class="Bound">x</a> <a id="12523" href="/20.07/Soundness/#12523" class="Bound">v</a> <a id="12525" href="/20.07/Soundness/#12525" class="Bound">y</a> <a id="12527" class="Keyword">with</a> <a id="12532" href="/20.07/Soundness/#12521" class="Bound">x</a> <a id="12534" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="12539" href="/20.07/Soundness/#12525" class="Bound">y</a>
<a id="12541" class="Symbol">...</a>             <a id="12557" class="Symbol">|</a> <a id="12559" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12563" class="Symbol">_</a>       <a id="12571" class="Symbol">=</a> <a id="12573" class="Bound">v</a>
<a id="12575" class="Symbol">...</a>             <a id="12591" class="Symbol">|</a> <a id="12593" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12596" class="Symbol">_</a>        <a id="12605" class="Symbol">=</a> <a id="12607" href="/20.07/Denotational/#4171" class="InductiveConstructor">âŠ¥</a>
</pre><p>Of course, <code class="language-plaintext highlighter-rouge">const-env x v</code> maps <code class="language-plaintext highlighter-rouge">x</code> to value <code class="language-plaintext highlighter-rouge">v</code></p><pre class="Agda"><a id="same-const-env"></a><a id="12668" href="/20.07/Soundness/#12668" class="Function">same-const-env</a> <a id="12683" class="Symbol">:</a> <a id="12685" class="Symbol">âˆ€{</a><a id="12687" href="/20.07/Soundness/#12687" class="Bound">Î“</a><a id="12688" class="Symbol">}</a> <a id="12690" class="Symbol">{</a><a id="12691" href="/20.07/Soundness/#12691" class="Bound">x</a> <a id="12693" class="Symbol">:</a> <a id="12695" href="/20.07/Soundness/#12687" class="Bound">Î“</a> <a id="12697" href="/20.07/Untyped/#3521" class="Datatype Operator">âˆ‹</a> <a id="12699" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="12700" class="Symbol">}</a> <a id="12702" class="Symbol">{</a><a id="12703" href="/20.07/Soundness/#12703" class="Bound">v</a><a id="12704" class="Symbol">}</a> <a id="12706" class="Symbol">â†’</a> <a id="12708" class="Symbol">(</a><a id="12709" href="/20.07/Soundness/#12464" class="Function">const-env</a> <a id="12719" href="/20.07/Soundness/#12691" class="Bound">x</a> <a id="12721" href="/20.07/Soundness/#12703" class="Bound">v</a><a id="12722" class="Symbol">)</a> <a id="12724" href="/20.07/Soundness/#12691" class="Bound">x</a> <a id="12726" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">â‰¡</a> <a id="12728" href="/20.07/Soundness/#12703" class="Bound">v</a>
<a id="12730" href="/20.07/Soundness/#12668" class="Function">same-const-env</a> <a id="12745" class="Symbol">{</a><a id="12746" class="Argument">x</a> <a id="12748" class="Symbol">=</a> <a id="12750" href="/20.07/Soundness/#12750" class="Bound">x</a><a id="12751" class="Symbol">}</a> <a id="12753" class="Keyword">rewrite</a> <a id="12761" href="/20.07/Soundness/#12297" class="Function">varâ‰Ÿ-refl</a> <a id="12771" href="/20.07/Soundness/#12750" class="Bound">x</a> <a id="12773" class="Symbol">=</a> <a id="12775" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre><p>and <code class="language-plaintext highlighter-rouge">const-env x v</code> maps <code class="language-plaintext highlighter-rouge">y</code> to <code class="language-plaintext highlighter-rouge">âŠ¥, so long as</code>x â‰¢ y`.</p><pre class="Agda"><a id="diff-const-env"></a><a id="12846" href="/20.07/Soundness/#12846" class="Function">diff-const-env</a> <a id="12861" class="Symbol">:</a> <a id="12863" class="Symbol">âˆ€{</a><a id="12865" href="/20.07/Soundness/#12865" class="Bound">Î“</a><a id="12866" class="Symbol">}</a> <a id="12868" class="Symbol">{</a><a id="12869" href="/20.07/Soundness/#12869" class="Bound">x</a> <a id="12871" href="/20.07/Soundness/#12871" class="Bound">y</a> <a id="12873" class="Symbol">:</a> <a id="12875" href="/20.07/Soundness/#12865" class="Bound">Î“</a> <a id="12877" href="/20.07/Untyped/#3521" class="Datatype Operator">âˆ‹</a> <a id="12879" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="12880" class="Symbol">}</a> <a id="12882" class="Symbol">{</a><a id="12883" href="/20.07/Soundness/#12883" class="Bound">v</a><a id="12884" class="Symbol">}</a>
  <a id="12888" class="Symbol">â†’</a> <a id="12890" href="/20.07/Soundness/#12869" class="Bound">x</a> <a id="12892" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#799" class="Function Operator">â‰¢</a> <a id="12894" href="/20.07/Soundness/#12871" class="Bound">y</a>
    <a id="12900" class="Comment">-------------------</a>
  <a id="12922" class="Symbol">â†’</a> <a id="12924" href="/20.07/Soundness/#12464" class="Function">const-env</a> <a id="12934" href="/20.07/Soundness/#12869" class="Bound">x</a> <a id="12936" href="/20.07/Soundness/#12883" class="Bound">v</a> <a id="12938" href="/20.07/Soundness/#12871" class="Bound">y</a> <a id="12940" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">â‰¡</a> <a id="12942" href="/20.07/Denotational/#4171" class="InductiveConstructor">âŠ¥</a>
<a id="12944" href="/20.07/Soundness/#12846" class="Function">diff-const-env</a> <a id="12959" class="Symbol">{</a><a id="12960" href="/20.07/Soundness/#12960" class="Bound">Î“</a><a id="12961" class="Symbol">}</a> <a id="12963" class="Symbol">{</a><a id="12964" href="/20.07/Soundness/#12964" class="Bound">x</a><a id="12965" class="Symbol">}</a> <a id="12967" class="Symbol">{</a><a id="12968" href="/20.07/Soundness/#12968" class="Bound">y</a><a id="12969" class="Symbol">}</a> <a id="12971" href="/20.07/Soundness/#12971" class="Bound">neq</a> <a id="12975" class="Keyword">with</a> <a id="12980" href="/20.07/Soundness/#12964" class="Bound">x</a> <a id="12982" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="12987" href="/20.07/Soundness/#12968" class="Bound">y</a>
<a id="12989" class="Symbol">...</a>  <a id="12994" class="Symbol">|</a> <a id="12996" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="13000" href="/20.07/Soundness/#13000" class="Bound">eq</a>  <a id="13004" class="Symbol">=</a>  <a id="13007" href="https://agda.github.io/agda-stdlib/v1.1/Data.Empty.html#294" class="Function">âŠ¥-elim</a> <a id="13014" class="Symbol">(</a><a id="13015" class="Bound">neq</a> <a id="13019" href="/20.07/Soundness/#13000" class="Bound">eq</a><a id="13021" class="Symbol">)</a>
<a id="13023" class="Symbol">...</a>  <a id="13028" class="Symbol">|</a> <a id="13030" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="13033" class="Symbol">_</a>    <a id="13038" class="Symbol">=</a>  <a id="13041" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre><p>So we choose <code class="language-plaintext highlighter-rouge">const-env x v</code> for <code class="language-plaintext highlighter-rouge">Î´</code> and obtain <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ x â†“ v</code> with the <code class="language-plaintext highlighter-rouge">var</code> rule.</p><p>It remains to prove that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ â†“ Î´</code> and <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ M â†“ v</code> for any <code class="language-plaintext highlighter-rouge">k</code>, given that we have chosen <code class="language-plaintext highlighter-rouge">const-env x v</code> for <code class="language-plaintext highlighter-rouge">Î´</code>. We shall have two cases to consider, <code class="language-plaintext highlighter-rouge">x â‰¡ y</code> or <code class="language-plaintext highlighter-rouge">x â‰¢ y</code>.</p><p>Now to finish the two cases of the proof.</p><ul><li>In the case where <code class="language-plaintext highlighter-rouge">x â‰¡ y</code>, we need to show that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ y â†“ v</code>, but thatâ€™s just our premise.</li><li>In the case where <code class="language-plaintext highlighter-rouge">x â‰¢ y,</code> we need to show that <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ y â†“ âŠ¥</code>, which we do via rule <code class="language-plaintext highlighter-rouge">âŠ¥-intro</code>.</li></ul><p>Thus, we have completed the variable case of the proof that simultaneous substitution reflects denotations. Here is the proof again, formally.</p><pre class="Agda"><a id="subst-reflect-var"></a><a id="13697" href="/20.07/Soundness/#13697" class="Function">subst-reflect-var</a> <a id="13715" class="Symbol">:</a> <a id="13717" class="Symbol">âˆ€</a> <a id="13719" class="Symbol">{</a><a id="13720" href="/20.07/Soundness/#13720" class="Bound">Î“</a> <a id="13722" href="/20.07/Soundness/#13722" class="Bound">Î”</a><a id="13723" class="Symbol">}</a> <a id="13725" class="Symbol">{</a><a id="13726" href="/20.07/Soundness/#13726" class="Bound">Î³</a> <a id="13728" class="Symbol">:</a> <a id="13730" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="13734" href="/20.07/Soundness/#13722" class="Bound">Î”</a><a id="13735" class="Symbol">}</a> <a id="13737" class="Symbol">{</a><a id="13738" href="/20.07/Soundness/#13738" class="Bound">x</a> <a id="13740" class="Symbol">:</a> <a id="13742" href="/20.07/Soundness/#13720" class="Bound">Î“</a> <a id="13744" href="/20.07/Untyped/#3521" class="Datatype Operator">âˆ‹</a> <a id="13746" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="13747" class="Symbol">}</a> <a id="13749" class="Symbol">{</a><a id="13750" href="/20.07/Soundness/#13750" class="Bound">v</a><a id="13751" class="Symbol">}</a> <a id="13753" class="Symbol">{</a><a id="13754" href="/20.07/Soundness/#13754" class="Bound">Ïƒ</a> <a id="13756" class="Symbol">:</a> <a id="13758" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="13764" href="/20.07/Soundness/#13720" class="Bound">Î“</a> <a id="13766" href="/20.07/Soundness/#13722" class="Bound">Î”</a><a id="13767" class="Symbol">}</a>
  <a id="13771" class="Symbol">â†’</a> <a id="13773" href="/20.07/Soundness/#13726" class="Bound">Î³</a> <a id="13775" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="13777" href="/20.07/Soundness/#13754" class="Bound">Ïƒ</a> <a id="13779" href="/20.07/Soundness/#13738" class="Bound">x</a> <a id="13781" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="13783" href="/20.07/Soundness/#13750" class="Bound">v</a>
    <a id="13789" class="Comment">-----------------------------------------</a>
  <a id="13833" class="Symbol">â†’</a> <a id="13835" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Î£[</a> <a id="13838" href="/20.07/Soundness/#13838" class="Bound">Î´</a> <a id="13840" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">âˆˆ</a> <a id="13842" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="13846" href="/20.07/Soundness/#13720" class="Bound">Î“</a> <a id="13848" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">]</a> <a id="13850" href="/20.07/Soundness/#13726" class="Bound">Î³</a> <a id="13852" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="13855" href="/20.07/Soundness/#13754" class="Bound">Ïƒ</a> <a id="13857" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="13859" href="/20.07/Soundness/#13838" class="Bound">Î´</a>  <a id="13862" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">Ã—</a>  <a id="13865" href="/20.07/Soundness/#13838" class="Bound">Î´</a> <a id="13867" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="13869" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="13871" href="/20.07/Soundness/#13738" class="Bound">x</a> <a id="13873" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="13875" href="/20.07/Soundness/#13750" class="Bound">v</a>
<a id="13877" href="/20.07/Soundness/#13697" class="Function">subst-reflect-var</a> <a id="13895" class="Symbol">{</a><a id="13896" href="/20.07/Soundness/#13896" class="Bound">Î“</a><a id="13897" class="Symbol">}{</a><a id="13899" href="/20.07/Soundness/#13899" class="Bound">Î”</a><a id="13900" class="Symbol">}{</a><a id="13902" href="/20.07/Soundness/#13902" class="Bound">Î³</a><a id="13903" class="Symbol">}{</a><a id="13905" href="/20.07/Soundness/#13905" class="Bound">x</a><a id="13906" class="Symbol">}{</a><a id="13908" href="/20.07/Soundness/#13908" class="Bound">v</a><a id="13909" class="Symbol">}{</a><a id="13911" href="/20.07/Soundness/#13911" class="Bound">Ïƒ</a><a id="13912" class="Symbol">}</a> <a id="13914" href="/20.07/Soundness/#13914" class="Bound">xv</a>
  <a id="13919" class="Keyword">rewrite</a> <a id="13927" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="13931" class="Symbol">(</a><a id="13932" href="/20.07/Soundness/#12668" class="Function">same-const-env</a> <a id="13947" class="Symbol">{</a><a id="13948" href="/20.07/Soundness/#13896" class="Bound">Î“</a><a id="13949" class="Symbol">}{</a><a id="13951" href="/20.07/Soundness/#13905" class="Bound">x</a><a id="13952" class="Symbol">}{</a><a id="13954" href="/20.07/Soundness/#13908" class="Bound">v</a><a id="13955" class="Symbol">})</a> <a id="13958" class="Symbol">=</a>
    <a id="13964" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="13966" href="/20.07/Soundness/#12464" class="Function">const-env</a> <a id="13976" href="/20.07/Soundness/#13905" class="Bound">x</a> <a id="13978" href="/20.07/Soundness/#13908" class="Bound">v</a> <a id="13980" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="13982" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="13984" href="/20.07/Soundness/#14017" class="Function">const-env-ok</a> <a id="13997" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="13999" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="14003" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="14005" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>
  <a id="14009" class="Keyword">where</a>
  <a id="14017" href="/20.07/Soundness/#14017" class="Function">const-env-ok</a> <a id="14030" class="Symbol">:</a> <a id="14032" href="/20.07/Soundness/#13902" class="Bound">Î³</a> <a id="14034" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="14037" href="/20.07/Soundness/#13911" class="Bound">Ïƒ</a> <a id="14039" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="14041" href="/20.07/Soundness/#12464" class="Function">const-env</a> <a id="14051" href="/20.07/Soundness/#13905" class="Bound">x</a> <a id="14053" href="/20.07/Soundness/#13908" class="Bound">v</a>
  <a id="14057" href="/20.07/Soundness/#14017" class="Function">const-env-ok</a> <a id="14070" href="/20.07/Soundness/#14070" class="Bound">y</a> <a id="14072" class="Keyword">with</a> <a id="14077" href="/20.07/Soundness/#13905" class="Bound">x</a> <a id="14079" href="/20.07/Soundness/#12048" class="Function Operator">varâ‰Ÿ</a> <a id="14084" href="/20.07/Soundness/#14070" class="Bound">y</a>
  <a id="14088" class="Symbol">...</a> <a id="14092" class="Symbol">|</a> <a id="14094" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="14098" href="/20.07/Soundness/#14098" class="Bound">xâ‰¡y</a> <a id="14102" class="Keyword">rewrite</a> <a id="14110" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="14114" href="/20.07/Soundness/#14098" class="Bound">xâ‰¡y</a> <a id="14118" class="Symbol">|</a> <a id="14120" href="/20.07/Soundness/#12668" class="Function">same-const-env</a> <a id="14135" class="Symbol">{</a><a id="14136" href="/20.07/Soundness/#13896" class="Bound">Î“</a><a id="14137" class="Symbol">}{</a><a id="14139" href="/20.07/Soundness/#13905" class="Bound">x</a><a id="14140" class="Symbol">}{</a><a id="14142" href="/20.07/Soundness/#13908" class="Bound">v</a><a id="14143" class="Symbol">}</a> <a id="14145" class="Symbol">=</a> <a id="14147" href="/20.07/Soundness/#13914" class="Bound">xv</a>
  <a id="14152" class="Symbol">...</a> <a id="14156" class="Symbol">|</a> <a id="14158" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="14161" href="/20.07/Soundness/#14161" class="Bound">xâ‰¢y</a> <a id="14165" class="Keyword">rewrite</a> <a id="14173" href="/20.07/Soundness/#12846" class="Function">diff-const-env</a> <a id="14188" class="Symbol">{</a><a id="14189" href="/20.07/Soundness/#13896" class="Bound">Î“</a><a id="14190" class="Symbol">}{</a><a id="14192" href="/20.07/Soundness/#13905" class="Bound">x</a><a id="14193" class="Symbol">}{</a><a id="14195" class="Bound">y</a><a id="14196" class="Symbol">}{</a><a id="14198" href="/20.07/Soundness/#13908" class="Bound">v</a><a id="14199" class="Symbol">}</a> <a id="14201" href="/20.07/Soundness/#14161" class="Bound">xâ‰¢y</a> <a id="14205" class="Symbol">=</a> <a id="14207" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a>
</pre><h3 id="substitutions-and-environment-construction">Substitutions and environment construction</h3><p>Every substitution produces terms that can evaluate to <code class="language-plaintext highlighter-rouge">âŠ¥</code>.</p><pre class="Agda"><a id="subst-âŠ¥"></a><a id="14334" href="/20.07/Soundness/#14334" class="Function">subst-âŠ¥</a> <a id="14342" class="Symbol">:</a> <a id="14344" class="Symbol">âˆ€{</a><a id="14346" href="/20.07/Soundness/#14346" class="Bound">Î“</a> <a id="14348" href="/20.07/Soundness/#14348" class="Bound">Î”</a><a id="14349" class="Symbol">}{</a><a id="14351" href="/20.07/Soundness/#14351" class="Bound">Î³</a> <a id="14353" class="Symbol">:</a> <a id="14355" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="14359" href="/20.07/Soundness/#14348" class="Bound">Î”</a><a id="14360" class="Symbol">}{</a><a id="14362" href="/20.07/Soundness/#14362" class="Bound">Ïƒ</a> <a id="14364" class="Symbol">:</a> <a id="14366" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="14372" href="/20.07/Soundness/#14346" class="Bound">Î“</a> <a id="14374" href="/20.07/Soundness/#14348" class="Bound">Î”</a><a id="14375" class="Symbol">}</a>
    <a id="14381" class="Comment">-----------------</a>
  <a id="14401" class="Symbol">â†’</a> <a id="14403" href="/20.07/Soundness/#14351" class="Bound">Î³</a> <a id="14405" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="14408" href="/20.07/Soundness/#14362" class="Bound">Ïƒ</a> <a id="14410" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="14412" href="/20.07/Denotational/#8311" class="Function">`âŠ¥</a>
<a id="14415" href="/20.07/Soundness/#14334" class="Function">subst-âŠ¥</a> <a id="14423" href="/20.07/Soundness/#14423" class="Bound">x</a> <a id="14425" class="Symbol">=</a> <a id="14427" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a>
</pre><p>If a substitution produces terms that evaluate to the values in both <code class="language-plaintext highlighter-rouge">Î³â‚</code> and <code class="language-plaintext highlighter-rouge">Î³â‚‚</code>, then those terms also evaluate to the values in <code class="language-plaintext highlighter-rouge">Î³â‚ âŠ” Î³â‚‚</code>.</p><pre class="Agda"><a id="subst-âŠ”"></a><a id="14588" href="/20.07/Soundness/#14588" class="Function">subst-âŠ”</a> <a id="14596" class="Symbol">:</a> <a id="14598" class="Symbol">âˆ€{</a><a id="14600" href="/20.07/Soundness/#14600" class="Bound">Î“</a> <a id="14602" href="/20.07/Soundness/#14602" class="Bound">Î”</a><a id="14603" class="Symbol">}{</a><a id="14605" href="/20.07/Soundness/#14605" class="Bound">Î³</a> <a id="14607" class="Symbol">:</a> <a id="14609" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="14613" href="/20.07/Soundness/#14602" class="Bound">Î”</a><a id="14614" class="Symbol">}{</a><a id="14616" href="/20.07/Soundness/#14616" class="Bound">Î³â‚</a> <a id="14619" href="/20.07/Soundness/#14619" class="Bound">Î³â‚‚</a> <a id="14622" class="Symbol">:</a> <a id="14624" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="14628" href="/20.07/Soundness/#14600" class="Bound">Î“</a><a id="14629" class="Symbol">}{</a><a id="14631" href="/20.07/Soundness/#14631" class="Bound">Ïƒ</a> <a id="14633" class="Symbol">:</a> <a id="14635" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="14641" href="/20.07/Soundness/#14600" class="Bound">Î“</a> <a id="14643" href="/20.07/Soundness/#14602" class="Bound">Î”</a><a id="14644" class="Symbol">}</a>
           <a id="14657" class="Symbol">â†’</a> <a id="14659" href="/20.07/Soundness/#14605" class="Bound">Î³</a> <a id="14661" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="14664" href="/20.07/Soundness/#14631" class="Bound">Ïƒ</a> <a id="14666" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="14668" href="/20.07/Soundness/#14616" class="Bound">Î³â‚</a>
           <a id="14682" class="Symbol">â†’</a> <a id="14684" href="/20.07/Soundness/#14605" class="Bound">Î³</a> <a id="14686" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="14689" href="/20.07/Soundness/#14631" class="Bound">Ïƒ</a> <a id="14691" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="14693" href="/20.07/Soundness/#14619" class="Bound">Î³â‚‚</a>
             <a id="14709" class="Comment">-------------------------</a>
           <a id="14746" class="Symbol">â†’</a> <a id="14748" href="/20.07/Soundness/#14605" class="Bound">Î³</a> <a id="14750" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="14753" href="/20.07/Soundness/#14631" class="Bound">Ïƒ</a> <a id="14755" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="14757" class="Symbol">(</a><a id="14758" href="/20.07/Soundness/#14616" class="Bound">Î³â‚</a> <a id="14761" href="/20.07/Denotational/#8340" class="Function Operator">`âŠ”</a> <a id="14764" href="/20.07/Soundness/#14619" class="Bound">Î³â‚‚</a><a id="14766" class="Symbol">)</a>
<a id="14768" href="/20.07/Soundness/#14588" class="Function">subst-âŠ”</a> <a id="14776" href="/20.07/Soundness/#14776" class="Bound">Î³â‚-ok</a> <a id="14782" href="/20.07/Soundness/#14782" class="Bound">Î³â‚‚-ok</a> <a id="14788" href="/20.07/Soundness/#14788" class="Bound">x</a> <a id="14790" class="Symbol">=</a> <a id="14792" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="14800" class="Symbol">(</a><a id="14801" href="/20.07/Soundness/#14776" class="Bound">Î³â‚-ok</a> <a id="14807" href="/20.07/Soundness/#14788" class="Bound">x</a><a id="14808" class="Symbol">)</a> <a id="14810" class="Symbol">(</a><a id="14811" href="/20.07/Soundness/#14782" class="Bound">Î³â‚‚-ok</a> <a id="14817" href="/20.07/Soundness/#14788" class="Bound">x</a><a id="14818" class="Symbol">)</a>
</pre><h3 id="the-lambda-constructor-is-injective">The Lambda constructor is injective</h3><pre class="Agda"><a id="lambda-inj"></a><a id="14870" href="/20.07/Soundness/#14870" class="Function">lambda-inj</a> <a id="14881" class="Symbol">:</a> <a id="14883" class="Symbol">âˆ€</a> <a id="14885" class="Symbol">{</a><a id="14886" href="/20.07/Soundness/#14886" class="Bound">Î“</a><a id="14887" class="Symbol">}</a> <a id="14889" class="Symbol">{</a><a id="14890" href="/20.07/Soundness/#14890" class="Bound">M</a> <a id="14892" href="/20.07/Soundness/#14892" class="Bound">N</a> <a id="14894" class="Symbol">:</a> <a id="14896" href="/20.07/Soundness/#14886" class="Bound">Î“</a> <a id="14898" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="14900" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a> <a id="14902" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="14904" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a> <a id="14906" class="Symbol">}</a>
  <a id="14910" class="Symbol">â†’</a> <a id="14912" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_â‰¡_</a> <a id="14916" class="Symbol">{</a><a id="14917" class="Argument">A</a> <a id="14919" class="Symbol">=</a> <a id="14921" href="/20.07/Soundness/#14886" class="Bound">Î“</a> <a id="14923" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="14925" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="14926" class="Symbol">}</a> <a id="14928" class="Symbol">(</a><a id="14929" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="14931" href="/20.07/Soundness/#14890" class="Bound">M</a><a id="14932" class="Symbol">)</a> <a id="14934" class="Symbol">(</a><a id="14935" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="14937" href="/20.07/Soundness/#14892" class="Bound">N</a><a id="14938" class="Symbol">)</a>
    <a id="14944" class="Comment">---------------------------</a>
  <a id="14974" class="Symbol">â†’</a> <a id="14976" href="/20.07/Soundness/#14890" class="Bound">M</a> <a id="14978" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">â‰¡</a> <a id="14980" href="/20.07/Soundness/#14892" class="Bound">N</a>
<a id="14982" href="/20.07/Soundness/#14870" class="Function">lambda-inj</a> <a id="14993" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="14998" class="Symbol">=</a> <a id="15000" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre><h3 id="simultaneous-substitution-reflects-denotations">Simultaneous substitution reflects denotations</h3><p>In this section we prove a central lemma, that substitution reflects denotations. That is, if <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ subst Ïƒ M â†“ v</code>, then <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ M â†“ v</code> and <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ â†“ Î´</code> for some <code class="language-plaintext highlighter-rouge">Î´</code>. We shall proceed by induction on the derivation of <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ subst Ïƒ M â†“ v</code>. This requires a minor restatement of the lemma, changing the premise to <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ L â†“ v</code> and <code class="language-plaintext highlighter-rouge">L â‰¡ subst Ïƒ M</code>.</p><pre class="Agda"><a id="split"></a><a id="15406" href="/20.07/Soundness/#15406" class="Function">split</a> <a id="15412" class="Symbol">:</a> <a id="15414" class="Symbol">âˆ€</a> <a id="15416" class="Symbol">{</a><a id="15417" href="/20.07/Soundness/#15417" class="Bound">Î“</a><a id="15418" class="Symbol">}</a> <a id="15420" class="Symbol">{</a><a id="15421" href="/20.07/Soundness/#15421" class="Bound">M</a> <a id="15423" class="Symbol">:</a> <a id="15425" href="/20.07/Soundness/#15417" class="Bound">Î“</a> <a id="15427" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="15429" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a> <a id="15431" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="15433" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="15434" class="Symbol">}</a> <a id="15436" class="Symbol">{</a><a id="15437" href="/20.07/Soundness/#15437" class="Bound">Î´</a> <a id="15439" class="Symbol">:</a> <a id="15441" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="15445" class="Symbol">(</a><a id="15446" href="/20.07/Soundness/#15417" class="Bound">Î“</a> <a id="15448" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="15450" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="15451" class="Symbol">)}</a> <a id="15454" class="Symbol">{</a><a id="15455" href="/20.07/Soundness/#15455" class="Bound">v</a><a id="15456" class="Symbol">}</a>
  <a id="15460" class="Symbol">â†’</a> <a id="15462" href="/20.07/Soundness/#15437" class="Bound">Î´</a> <a id="15464" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="15466" href="/20.07/Soundness/#15421" class="Bound">M</a> <a id="15468" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="15470" href="/20.07/Soundness/#15455" class="Bound">v</a>
    <a id="15476" class="Comment">--------------------------</a>
  <a id="15505" class="Symbol">â†’</a> <a id="15507" class="Symbol">(</a><a id="15508" href="/20.07/Denotational/#7686" class="Function">init</a> <a id="15513" href="/20.07/Soundness/#15437" class="Bound">Î´</a> <a id="15515" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="15518" href="/20.07/Denotational/#7741" class="Function">last</a> <a id="15523" href="/20.07/Soundness/#15437" class="Bound">Î´</a><a id="15524" class="Symbol">)</a> <a id="15526" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="15528" href="/20.07/Soundness/#15421" class="Bound">M</a> <a id="15530" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="15532" href="/20.07/Soundness/#15455" class="Bound">v</a>
<a id="15534" href="/20.07/Soundness/#15406" class="Function">split</a> <a id="15540" class="Symbol">{</a><a id="15541" class="Argument">Î´</a> <a id="15543" class="Symbol">=</a> <a id="15545" href="/20.07/Soundness/#15545" class="Bound">Î´</a><a id="15546" class="Symbol">}</a> <a id="15548" href="/20.07/Soundness/#15548" class="Bound">Î´Mv</a> <a id="15552" class="Keyword">rewrite</a> <a id="15560" href="/20.07/Denotational/#7790" class="Function">init-last</a> <a id="15570" href="/20.07/Soundness/#15545" class="Bound">Î´</a> <a id="15572" class="Symbol">=</a> <a id="15574" href="/20.07/Soundness/#15548" class="Bound">Î´Mv</a>

<a id="subst-reflect"></a><a id="15579" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="15593" class="Symbol">:</a> <a id="15595" class="Symbol">âˆ€</a> <a id="15597" class="Symbol">{</a><a id="15598" href="/20.07/Soundness/#15598" class="Bound">Î“</a> <a id="15600" href="/20.07/Soundness/#15600" class="Bound">Î”</a><a id="15601" class="Symbol">}</a> <a id="15603" class="Symbol">{</a><a id="15604" href="/20.07/Soundness/#15604" class="Bound">Î´</a> <a id="15606" class="Symbol">:</a> <a id="15608" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="15612" href="/20.07/Soundness/#15600" class="Bound">Î”</a><a id="15613" class="Symbol">}</a> <a id="15615" class="Symbol">{</a><a id="15616" href="/20.07/Soundness/#15616" class="Bound">M</a> <a id="15618" class="Symbol">:</a> <a id="15620" href="/20.07/Soundness/#15598" class="Bound">Î“</a> <a id="15622" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="15624" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="15625" class="Symbol">}</a> <a id="15627" class="Symbol">{</a><a id="15628" href="/20.07/Soundness/#15628" class="Bound">v</a><a id="15629" class="Symbol">}</a> <a id="15631" class="Symbol">{</a><a id="15632" href="/20.07/Soundness/#15632" class="Bound">L</a> <a id="15634" class="Symbol">:</a> <a id="15636" href="/20.07/Soundness/#15600" class="Bound">Î”</a> <a id="15638" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="15640" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="15641" class="Symbol">}</a> <a id="15643" class="Symbol">{</a><a id="15644" href="/20.07/Soundness/#15644" class="Bound">Ïƒ</a> <a id="15646" class="Symbol">:</a> <a id="15648" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="15654" href="/20.07/Soundness/#15598" class="Bound">Î“</a> <a id="15656" href="/20.07/Soundness/#15600" class="Bound">Î”</a><a id="15657" class="Symbol">}</a>
  <a id="15661" class="Symbol">â†’</a> <a id="15663" href="/20.07/Soundness/#15604" class="Bound">Î´</a> <a id="15665" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="15667" href="/20.07/Soundness/#15632" class="Bound">L</a> <a id="15669" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="15671" href="/20.07/Soundness/#15628" class="Bound">v</a>
  <a id="15675" class="Symbol">â†’</a> <a id="15677" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="15683" href="/20.07/Soundness/#15644" class="Bound">Ïƒ</a> <a id="15685" href="/20.07/Soundness/#15616" class="Bound">M</a> <a id="15687" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">â‰¡</a> <a id="15689" href="/20.07/Soundness/#15632" class="Bound">L</a>
    <a id="15695" class="Comment">---------------------------------------</a>
  <a id="15737" class="Symbol">â†’</a> <a id="15739" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Î£[</a> <a id="15742" href="/20.07/Soundness/#15742" class="Bound">Î³</a> <a id="15744" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">âˆˆ</a> <a id="15746" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="15750" href="/20.07/Soundness/#15598" class="Bound">Î“</a> <a id="15752" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">]</a> <a id="15754" href="/20.07/Soundness/#15604" class="Bound">Î´</a> <a id="15756" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="15759" href="/20.07/Soundness/#15644" class="Bound">Ïƒ</a> <a id="15761" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="15763" href="/20.07/Soundness/#15742" class="Bound">Î³</a>  <a id="15766" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">Ã—</a>  <a id="15769" href="/20.07/Soundness/#15742" class="Bound">Î³</a> <a id="15771" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="15773" href="/20.07/Soundness/#15616" class="Bound">M</a> <a id="15775" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="15777" href="/20.07/Soundness/#15628" class="Bound">v</a>

<a id="15780" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="15794" class="Symbol">{</a><a id="15795" class="Argument">M</a> <a id="15797" class="Symbol">=</a> <a id="15799" href="/20.07/Soundness/#15799" class="Bound">M</a><a id="15800" class="Symbol">}{</a><a id="15802" class="Argument">Ïƒ</a> <a id="15804" class="Symbol">=</a> <a id="15806" href="/20.07/Soundness/#15806" class="Bound">Ïƒ</a><a id="15807" class="Symbol">}</a> <a id="15809" class="Symbol">(</a><a id="15810" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="15814" class="Symbol">{</a><a id="15815" class="Argument">x</a> <a id="15817" class="Symbol">=</a> <a id="15819" href="/20.07/Soundness/#15819" class="Bound">y</a><a id="15820" class="Symbol">})</a> <a id="15823" href="/20.07/Soundness/#15823" class="Bound">eqL</a> <a id="15827" class="Keyword">with</a> <a id="15832" href="/20.07/Soundness/#15799" class="Bound">M</a>
<a id="15834" class="Symbol">...</a> <a id="15838" class="Symbol">|</a> <a id="15840" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="15842" href="/20.07/Soundness/#15842" class="Bound">x</a>  <a id="15845" class="Keyword">with</a> <a id="15850" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="15854" class="Symbol">{</a><a id="15855" class="Argument">x</a> <a id="15857" class="Symbol">=</a> <a id="15859" class="Bound">y</a><a id="15860" class="Symbol">}</a>
<a id="15862" class="Symbol">...</a>           <a id="15876" class="Symbol">|</a> <a id="15878" href="/20.07/Soundness/#15878" class="Bound">yv</a>  <a id="15882" class="Keyword">rewrite</a> <a id="15890" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="15894" class="Bound">eqL</a> <a id="15898" class="Symbol">=</a> <a id="15900" href="/20.07/Soundness/#13697" class="Function">subst-reflect-var</a> <a id="15918" class="Symbol">{</a><a id="15919" class="Argument">Ïƒ</a> <a id="15921" class="Symbol">=</a> <a id="15923" class="Bound">Ïƒ</a><a id="15924" class="Symbol">}</a> <a id="15926" href="/20.07/Soundness/#15878" class="Bound">yv</a>
<a id="15929" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="15943" class="Symbol">{</a><a id="15944" class="Argument">M</a> <a id="15946" class="Symbol">=</a> <a id="15948" href="/20.07/Soundness/#15948" class="Bound">M</a><a id="15949" class="Symbol">}</a> <a id="15951" class="Symbol">(</a><a id="15952" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="15956" class="Symbol">{</a><a id="15957" class="Argument">x</a> <a id="15959" class="Symbol">=</a> <a id="15961" href="/20.07/Soundness/#15961" class="Bound">y</a><a id="15962" class="Symbol">})</a> <a id="15965" class="Symbol">()</a> <a id="15968" class="Symbol">|</a> <a id="15970" href="/20.07/Soundness/#15970" class="Bound">Mâ‚</a> <a id="15973" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">Â·</a> <a id="15975" href="/20.07/Soundness/#15975" class="Bound">Mâ‚‚</a>
<a id="15978" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="15992" class="Symbol">{</a><a id="15993" class="Argument">M</a> <a id="15995" class="Symbol">=</a> <a id="15997" href="/20.07/Soundness/#15997" class="Bound">M</a><a id="15998" class="Symbol">}</a> <a id="16000" class="Symbol">(</a><a id="16001" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="16005" class="Symbol">{</a><a id="16006" class="Argument">x</a> <a id="16008" class="Symbol">=</a> <a id="16010" href="/20.07/Soundness/#16010" class="Bound">y</a><a id="16011" class="Symbol">})</a> <a id="16014" class="Symbol">()</a> <a id="16017" class="Symbol">|</a> <a id="16019" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="16021" href="/20.07/Soundness/#16021" class="Bound">Mâ€²</a>

<a id="16025" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="16039" class="Symbol">{</a><a id="16040" class="Argument">M</a> <a id="16042" class="Symbol">=</a> <a id="16044" href="/20.07/Soundness/#16044" class="Bound">M</a><a id="16045" class="Symbol">}{</a><a id="16047" class="Argument">Ïƒ</a> <a id="16049" class="Symbol">=</a> <a id="16051" href="/20.07/Soundness/#16051" class="Bound">Ïƒ</a><a id="16052" class="Symbol">}</a> <a id="16054" class="Symbol">(</a><a id="16055" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="16062" href="/20.07/Soundness/#16062" class="Bound">dâ‚</a> <a id="16065" href="/20.07/Soundness/#16065" class="Bound">dâ‚‚</a><a id="16067" class="Symbol">)</a> <a id="16069" href="/20.07/Soundness/#16069" class="Bound">eqL</a>
         <a id="16082" class="Keyword">with</a> <a id="16087" href="/20.07/Soundness/#16044" class="Bound">M</a>
<a id="16089" class="Symbol">...</a>    <a id="16096" class="Symbol">|</a> <a id="16098" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="16100" href="/20.07/Soundness/#16100" class="Bound">x</a> <a id="16102" class="Keyword">with</a> <a id="16107" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="16114" class="Bound">dâ‚</a> <a id="16117" class="Bound">dâ‚‚</a>
<a id="16120" class="Symbol">...</a>    <a id="16127" class="Symbol">|</a> <a id="16129" href="/20.07/Soundness/#16129" class="Bound">dâ€²</a> <a id="16132" class="Keyword">rewrite</a> <a id="16140" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="16144" class="Bound">eqL</a> <a id="16148" class="Symbol">=</a> <a id="16150" href="/20.07/Soundness/#13697" class="Function">subst-reflect-var</a> <a id="16168" class="Symbol">{</a><a id="16169" class="Argument">Ïƒ</a> <a id="16171" class="Symbol">=</a> <a id="16173" class="Bound">Ïƒ</a><a id="16174" class="Symbol">}</a> <a id="16176" href="/20.07/Soundness/#16129" class="Bound">dâ€²</a>
<a id="16179" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="16193" class="Symbol">(</a><a id="16194" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="16201" href="/20.07/Soundness/#16201" class="Bound">dâ‚</a> <a id="16204" href="/20.07/Soundness/#16204" class="Bound">dâ‚‚</a><a id="16206" class="Symbol">)</a> <a id="16208" class="Symbol">()</a> <a id="16211" class="Symbol">|</a> <a id="16213" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="16215" href="/20.07/Soundness/#16215" class="Bound">Mâ€²</a>
<a id="16218" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a><a id="16231" class="Symbol">{</a><a id="16232" href="/20.07/Soundness/#16232" class="Bound">Î“</a><a id="16233" class="Symbol">}{</a><a id="16235" href="/20.07/Soundness/#16235" class="Bound">Î”</a><a id="16236" class="Symbol">}{</a><a id="16238" href="/20.07/Soundness/#16238" class="Bound">Î³</a><a id="16239" class="Symbol">}{</a><a id="16241" class="Argument">Ïƒ</a> <a id="16243" class="Symbol">=</a> <a id="16245" href="/20.07/Soundness/#16245" class="Bound">Ïƒ</a><a id="16246" class="Symbol">}</a> <a id="16248" class="Symbol">(</a><a id="16249" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="16256" href="/20.07/Soundness/#16256" class="Bound">dâ‚</a> <a id="16259" href="/20.07/Soundness/#16259" class="Bound">dâ‚‚</a><a id="16261" class="Symbol">)</a>
   <a id="16266" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="16271" class="Symbol">|</a> <a id="16273" href="/20.07/Soundness/#16273" class="Bound">Mâ‚</a> <a id="16276" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">Â·</a> <a id="16278" href="/20.07/Soundness/#16278" class="Bound">Mâ‚‚</a>
     <a id="16286" class="Keyword">with</a> <a id="16291" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="16305" class="Symbol">{</a><a id="16306" class="Argument">M</a> <a id="16308" class="Symbol">=</a> <a id="16310" href="/20.07/Soundness/#16273" class="Bound">Mâ‚</a><a id="16312" class="Symbol">}</a> <a id="16314" href="/20.07/Soundness/#16256" class="Bound">dâ‚</a> <a id="16317" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="16322" class="Symbol">|</a> <a id="16324" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="16338" class="Symbol">{</a><a id="16339" class="Argument">M</a> <a id="16341" class="Symbol">=</a> <a id="16343" href="/20.07/Soundness/#16278" class="Bound">Mâ‚‚</a><a id="16345" class="Symbol">}</a> <a id="16347" href="/20.07/Soundness/#16259" class="Bound">dâ‚‚</a> <a id="16350" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="16355" class="Symbol">...</a>     <a id="16363" class="Symbol">|</a> <a id="16365" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16367" href="/20.07/Soundness/#16367" class="Bound">Î´â‚</a> <a id="16370" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16372" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16374" href="/20.07/Soundness/#16374" class="Bound">subst-Î´â‚</a> <a id="16383" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16385" href="/20.07/Soundness/#16385" class="Bound">m1</a> <a id="16388" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="16390" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="16392" class="Symbol">|</a> <a id="16394" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16396" href="/20.07/Soundness/#16396" class="Bound">Î´â‚‚</a> <a id="16399" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16401" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16403" href="/20.07/Soundness/#16403" class="Bound">subst-Î´â‚‚</a> <a id="16412" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16414" href="/20.07/Soundness/#16414" class="Bound">m2</a> <a id="16417" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="16419" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="16421" class="Symbol">=</a>
     <a id="16428" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16430" href="/20.07/Soundness/#16367" class="Bound">Î´â‚</a> <a id="16433" href="/20.07/Denotational/#8340" class="Function Operator">`âŠ”</a> <a id="16436" href="/20.07/Soundness/#16396" class="Bound">Î´â‚‚</a> <a id="16439" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16441" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16443" href="/20.07/Soundness/#14588" class="Function">subst-âŠ”</a> <a id="16451" class="Symbol">{</a><a id="16452" class="Argument">Î³â‚</a> <a id="16455" class="Symbol">=</a> <a id="16457" href="/20.07/Soundness/#16367" class="Bound">Î´â‚</a><a id="16459" class="Symbol">}{</a><a id="16461" class="Argument">Î³â‚‚</a> <a id="16464" class="Symbol">=</a> <a id="16466" href="/20.07/Soundness/#16396" class="Bound">Î´â‚‚</a><a id="16468" class="Symbol">}{</a><a id="16470" class="Argument">Ïƒ</a> <a id="16472" class="Symbol">=</a> <a id="16474" class="Bound">Ïƒ</a><a id="16475" class="Symbol">}</a> <a id="16477" href="/20.07/Soundness/#16374" class="Bound">subst-Î´â‚</a> <a id="16486" href="/20.07/Soundness/#16403" class="Bound">subst-Î´â‚‚</a> <a id="16495" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>
                    <a id="16517" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="16524" class="Symbol">(</a><a id="16525" href="/20.07/Denotational/#25713" class="Function">âŠ‘-env</a> <a id="16531" href="/20.07/Soundness/#16385" class="Bound">m1</a> <a id="16534" class="Symbol">(</a><a id="16535" href="/20.07/Denotational/#8670" class="Function">âŠ‘-env-conj-R1</a> <a id="16549" href="/20.07/Soundness/#16367" class="Bound">Î´â‚</a> <a id="16552" href="/20.07/Soundness/#16396" class="Bound">Î´â‚‚</a><a id="16554" class="Symbol">))</a>
                           <a id="16584" class="Symbol">(</a><a id="16585" href="/20.07/Denotational/#25713" class="Function">âŠ‘-env</a> <a id="16591" href="/20.07/Soundness/#16414" class="Bound">m2</a> <a id="16594" class="Symbol">(</a><a id="16595" href="/20.07/Denotational/#8776" class="Function">âŠ‘-env-conj-R2</a> <a id="16609" href="/20.07/Soundness/#16367" class="Bound">Î´â‚</a> <a id="16612" href="/20.07/Soundness/#16396" class="Bound">Î´â‚‚</a><a id="16614" class="Symbol">))</a> <a id="16617" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="16619" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>

<a id="16622" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="16636" class="Symbol">{</a><a id="16637" class="Argument">M</a> <a id="16639" class="Symbol">=</a> <a id="16641" href="/20.07/Soundness/#16641" class="Bound">M</a><a id="16642" class="Symbol">}{</a><a id="16644" class="Argument">Ïƒ</a> <a id="16646" class="Symbol">=</a> <a id="16648" href="/20.07/Soundness/#16648" class="Bound">Ïƒ</a><a id="16649" class="Symbol">}</a> <a id="16651" class="Symbol">(</a><a id="16652" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="16660" href="/20.07/Soundness/#16660" class="Bound">d</a><a id="16661" class="Symbol">)</a> <a id="16663" href="/20.07/Soundness/#16663" class="Bound">eqL</a> <a id="16667" class="Keyword">with</a> <a id="16672" href="/20.07/Soundness/#16641" class="Bound">M</a>
<a id="16674" class="Symbol">...</a>    <a id="16681" class="Symbol">|</a> <a id="16683" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="16685" href="/20.07/Soundness/#16685" class="Bound">x</a> <a id="16687" class="Keyword">with</a> <a id="16692" class="Symbol">(</a><a id="16693" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="16701" class="Bound">d</a><a id="16702" class="Symbol">)</a>
<a id="16704" class="Symbol">...</a>             <a id="16720" class="Symbol">|</a> <a id="16722" href="/20.07/Soundness/#16722" class="Bound">dâ€²</a> <a id="16725" class="Keyword">rewrite</a> <a id="16733" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="16737" class="Bound">eqL</a> <a id="16741" class="Symbol">=</a> <a id="16743" href="/20.07/Soundness/#13697" class="Function">subst-reflect-var</a> <a id="16761" class="Symbol">{</a><a id="16762" class="Argument">Ïƒ</a> <a id="16764" class="Symbol">=</a> <a id="16766" class="Bound">Ïƒ</a><a id="16767" class="Symbol">}</a> <a id="16769" href="/20.07/Soundness/#16722" class="Bound">dâ€²</a>
<a id="16772" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="16786" class="Symbol">{</a><a id="16787" class="Argument">Ïƒ</a> <a id="16789" class="Symbol">=</a> <a id="16791" href="/20.07/Soundness/#16791" class="Bound">Ïƒ</a><a id="16792" class="Symbol">}</a> <a id="16794" class="Symbol">(</a><a id="16795" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="16803" href="/20.07/Soundness/#16803" class="Bound">d</a><a id="16804" class="Symbol">)</a> <a id="16806" href="/20.07/Soundness/#16806" class="Bound">eq</a> <a id="16809" class="Symbol">|</a> <a id="16811" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="16813" href="/20.07/Soundness/#16813" class="Bound">Mâ€²</a>
      <a id="16822" class="Keyword">with</a> <a id="16827" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="16841" class="Symbol">{</a><a id="16842" class="Argument">Ïƒ</a> <a id="16844" class="Symbol">=</a> <a id="16846" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="16851" href="/20.07/Soundness/#16791" class="Bound">Ïƒ</a><a id="16852" class="Symbol">}</a> <a id="16854" href="/20.07/Soundness/#16803" class="Bound">d</a> <a id="16856" class="Symbol">(</a><a id="16857" href="/20.07/Soundness/#14870" class="Function">lambda-inj</a> <a id="16868" href="/20.07/Soundness/#16806" class="Bound">eq</a><a id="16870" class="Symbol">)</a>
<a id="16872" class="Symbol">...</a> <a id="16876" class="Symbol">|</a> <a id="16878" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16880" href="/20.07/Soundness/#16880" class="Bound">Î´â€²</a> <a id="16883" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16885" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16887" href="/20.07/Soundness/#16887" class="Bound">exts-Ïƒ-Î´â€²</a> <a id="16897" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16899" href="/20.07/Soundness/#16899" class="Bound">mâ€²</a> <a id="16902" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="16904" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="16906" class="Symbol">=</a>
    <a id="16912" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16914" href="/20.07/Denotational/#7686" class="Function">init</a> <a id="16919" href="/20.07/Soundness/#16880" class="Bound">Î´â€²</a> <a id="16922" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16924" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="16926" class="Symbol">((Î»</a> <a id="16930" href="/20.07/Soundness/#16930" class="Bound">x</a> <a id="16932" class="Symbol">â†’</a> <a id="16934" href="/20.07/Soundness/#11148" class="Function">rename-inc-reflect</a> <a id="16953" class="Symbol">(</a><a id="16954" href="/20.07/Soundness/#16887" class="Bound">exts-Ïƒ-Î´â€²</a> <a id="16964" class="Symbol">(</a><a id="16965" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="16967" href="/20.07/Soundness/#16930" class="Bound">x</a><a id="16968" class="Symbol">))))</a> <a id="16973" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>
             <a id="16988" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="16996" class="Symbol">(</a><a id="16997" href="/20.07/Denotational/#26158" class="Function">up-env</a> <a id="17004" class="Symbol">(</a><a id="17005" href="/20.07/Soundness/#15406" class="Function">split</a> <a id="17011" href="/20.07/Soundness/#16899" class="Bound">mâ€²</a><a id="17013" class="Symbol">)</a> <a id="17015" class="Symbol">(</a><a id="17016" href="/20.07/Compositional/#10012" class="Function">var-inv</a> <a id="17024" class="Symbol">(</a><a id="17025" href="/20.07/Soundness/#16887" class="Bound">exts-Ïƒ-Î´â€²</a> <a id="17035" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="17036" class="Symbol">)))</a> <a id="17040" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17042" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>
<a id="17044" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="17058" class="Symbol">(</a><a id="17059" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="17067" href="/20.07/Soundness/#17067" class="Bound">d</a><a id="17068" class="Symbol">)</a> <a id="17070" class="Symbol">()</a> <a id="17073" class="Symbol">|</a> <a id="17075" href="/20.07/Soundness/#17075" class="Bound">Mâ‚</a> <a id="17078" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">Â·</a> <a id="17080" href="/20.07/Soundness/#17080" class="Bound">Mâ‚‚</a>

<a id="17084" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="17098" class="Symbol">{</a><a id="17099" class="Argument">Ïƒ</a> <a id="17101" class="Symbol">=</a> <a id="17103" href="/20.07/Soundness/#17103" class="Bound">Ïƒ</a><a id="17104" class="Symbol">}</a> <a id="17106" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a> <a id="17114" href="/20.07/Soundness/#17114" class="Bound">eq</a> <a id="17117" class="Symbol">=</a>
    <a id="17123" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17125" href="/20.07/Denotational/#8311" class="Function">`âŠ¥</a> <a id="17128" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17130" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17132" href="/20.07/Soundness/#14334" class="Function">subst-âŠ¥</a> <a id="17140" class="Symbol">{</a><a id="17141" class="Argument">Ïƒ</a> <a id="17143" class="Symbol">=</a> <a id="17145" href="/20.07/Soundness/#17103" class="Bound">Ïƒ</a><a id="17146" class="Symbol">}</a> <a id="17148" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17150" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a> <a id="17158" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17160" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>

<a id="17163" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="17177" class="Symbol">{</a><a id="17178" class="Argument">Ïƒ</a> <a id="17180" class="Symbol">=</a> <a id="17182" href="/20.07/Soundness/#17182" class="Bound">Ïƒ</a><a id="17183" class="Symbol">}</a> <a id="17185" class="Symbol">(</a><a id="17186" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="17194" href="/20.07/Soundness/#17194" class="Bound">dâ‚</a> <a id="17197" href="/20.07/Soundness/#17197" class="Bound">dâ‚‚</a><a id="17199" class="Symbol">)</a> <a id="17201" href="/20.07/Soundness/#17201" class="Bound">eq</a>
  <a id="17206" class="Keyword">with</a> <a id="17211" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="17225" class="Symbol">{</a><a id="17226" class="Argument">Ïƒ</a> <a id="17228" class="Symbol">=</a> <a id="17230" href="/20.07/Soundness/#17182" class="Bound">Ïƒ</a><a id="17231" class="Symbol">}</a> <a id="17233" href="/20.07/Soundness/#17194" class="Bound">dâ‚</a> <a id="17236" href="/20.07/Soundness/#17201" class="Bound">eq</a> <a id="17239" class="Symbol">|</a> <a id="17241" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="17255" class="Symbol">{</a><a id="17256" class="Argument">Ïƒ</a> <a id="17258" class="Symbol">=</a> <a id="17260" href="/20.07/Soundness/#17182" class="Bound">Ïƒ</a><a id="17261" class="Symbol">}</a> <a id="17263" href="/20.07/Soundness/#17197" class="Bound">dâ‚‚</a> <a id="17266" href="/20.07/Soundness/#17201" class="Bound">eq</a>
<a id="17269" class="Symbol">...</a> <a id="17273" class="Symbol">|</a> <a id="17275" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17277" href="/20.07/Soundness/#17277" class="Bound">Î´â‚</a> <a id="17280" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17282" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17284" href="/20.07/Soundness/#17284" class="Bound">subst-Î´â‚</a> <a id="17293" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17295" href="/20.07/Soundness/#17295" class="Bound">m1</a> <a id="17298" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17300" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17302" class="Symbol">|</a> <a id="17304" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17306" href="/20.07/Soundness/#17306" class="Bound">Î´â‚‚</a> <a id="17309" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17311" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17313" href="/20.07/Soundness/#17313" class="Bound">subst-Î´â‚‚</a> <a id="17322" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17324" href="/20.07/Soundness/#17324" class="Bound">m2</a> <a id="17327" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17329" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17331" class="Symbol">=</a>
     <a id="17338" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17340" href="/20.07/Soundness/#17277" class="Bound">Î´â‚</a> <a id="17343" href="/20.07/Denotational/#8340" class="Function Operator">`âŠ”</a> <a id="17346" href="/20.07/Soundness/#17306" class="Bound">Î´â‚‚</a> <a id="17349" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17351" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17353" href="/20.07/Soundness/#14588" class="Function">subst-âŠ”</a> <a id="17361" class="Symbol">{</a><a id="17362" class="Argument">Î³â‚</a> <a id="17365" class="Symbol">=</a> <a id="17367" href="/20.07/Soundness/#17277" class="Bound">Î´â‚</a><a id="17369" class="Symbol">}{</a><a id="17371" class="Argument">Î³â‚‚</a> <a id="17374" class="Symbol">=</a> <a id="17376" href="/20.07/Soundness/#17306" class="Bound">Î´â‚‚</a><a id="17378" class="Symbol">}{</a><a id="17380" class="Argument">Ïƒ</a> <a id="17382" class="Symbol">=</a> <a id="17384" class="Bound">Ïƒ</a><a id="17385" class="Symbol">}</a> <a id="17387" href="/20.07/Soundness/#17284" class="Bound">subst-Î´â‚</a> <a id="17396" href="/20.07/Soundness/#17313" class="Bound">subst-Î´â‚‚</a> <a id="17405" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>
                    <a id="17427" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="17435" class="Symbol">(</a><a id="17436" href="/20.07/Denotational/#25713" class="Function">âŠ‘-env</a> <a id="17442" href="/20.07/Soundness/#17295" class="Bound">m1</a> <a id="17445" class="Symbol">(</a><a id="17446" href="/20.07/Denotational/#8670" class="Function">âŠ‘-env-conj-R1</a> <a id="17460" href="/20.07/Soundness/#17277" class="Bound">Î´â‚</a> <a id="17463" href="/20.07/Soundness/#17306" class="Bound">Î´â‚‚</a><a id="17465" class="Symbol">))</a>
                            <a id="17496" class="Symbol">(</a><a id="17497" href="/20.07/Denotational/#25713" class="Function">âŠ‘-env</a> <a id="17503" href="/20.07/Soundness/#17324" class="Bound">m2</a> <a id="17506" class="Symbol">(</a><a id="17507" href="/20.07/Denotational/#8776" class="Function">âŠ‘-env-conj-R2</a> <a id="17521" href="/20.07/Soundness/#17277" class="Bound">Î´â‚</a> <a id="17524" href="/20.07/Soundness/#17306" class="Bound">Î´â‚‚</a><a id="17526" class="Symbol">))</a> <a id="17529" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17531" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>
<a id="17533" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="17547" class="Symbol">(</a><a id="17548" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="17552" href="/20.07/Soundness/#17552" class="Bound">d</a> <a id="17554" href="/20.07/Soundness/#17554" class="Bound">lt</a><a id="17556" class="Symbol">)</a> <a id="17558" href="/20.07/Soundness/#17558" class="Bound">eq</a>
    <a id="17565" class="Keyword">with</a> <a id="17570" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="17584" href="/20.07/Soundness/#17552" class="Bound">d</a> <a id="17586" href="/20.07/Soundness/#17558" class="Bound">eq</a>
<a id="17589" class="Symbol">...</a> <a id="17593" class="Symbol">|</a> <a id="17595" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17597" href="/20.07/Soundness/#17597" class="Bound">Î´</a> <a id="17599" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17601" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17603" href="/20.07/Soundness/#17603" class="Bound">subst-Î´</a> <a id="17611" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17613" href="/20.07/Soundness/#17613" class="Bound">m</a> <a id="17615" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17617" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17619" class="Symbol">=</a> <a id="17621" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17623" href="/20.07/Soundness/#17597" class="Bound">Î´</a> <a id="17625" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17627" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="17629" href="/20.07/Soundness/#17603" class="Bound">subst-Î´</a> <a id="17637" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17639" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="17643" href="/20.07/Soundness/#17613" class="Bound">m</a> <a id="17645" class="Bound">lt</a> <a id="17648" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="17650" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>
</pre><ul><li><p>Case <code class="language-plaintext highlighter-rouge">var</code>: We have subst <code class="language-plaintext highlighter-rouge">Ïƒ M â‰¡ y</code>, so <code class="language-plaintext highlighter-rouge">M</code> must also be a variable, say <code class="language-plaintext highlighter-rouge">x</code>. We apply the lemma <code class="language-plaintext highlighter-rouge">subst-reflect-var</code> to conclude.</p></li><li>Case <code class="language-plaintext highlighter-rouge">â†¦-elim</code>: We have <code class="language-plaintext highlighter-rouge">subst Ïƒ M â‰¡ Lâ‚ Â· Lâ‚‚</code>. We proceed by cases on <code class="language-plaintext highlighter-rouge">M</code>.<ul><li><p>Case <code class="language-plaintext highlighter-rouge">M â‰¡ x</code>: We apply the <code class="language-plaintext highlighter-rouge">subst-reflect-var</code> lemma again to conclude.</p></li><li><p>Case <code class="language-plaintext highlighter-rouge">M â‰¡ Mâ‚ Â· Mâ‚‚</code>: By the induction hypothesis, we have some <code class="language-plaintext highlighter-rouge">Î´â‚</code> and <code class="language-plaintext highlighter-rouge">Î´â‚‚</code> such that <code class="language-plaintext highlighter-rouge">Î´â‚ âŠ¢ Mâ‚ â†“ vâ‚ â†¦ vâ‚ƒ</code> and <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ â†“ Î´â‚</code>, as well as <code class="language-plaintext highlighter-rouge">Î´â‚‚ âŠ¢ Mâ‚‚ â†“ vâ‚</code> and <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ â†“ Î´â‚‚</code>. By <code class="language-plaintext highlighter-rouge">âŠ‘-env</code> we have <code class="language-plaintext highlighter-rouge">Î´â‚ âŠ” Î´â‚‚ âŠ¢ Mâ‚ â†“ vâ‚ â†¦ vâ‚ƒ</code> and <code class="language-plaintext highlighter-rouge">Î´â‚ âŠ” Î´â‚‚ âŠ¢ Mâ‚‚ â†“ vâ‚</code> (using <code class="language-plaintext highlighter-rouge">âŠ‘-env-conj-R1</code> and <code class="language-plaintext highlighter-rouge">âŠ‘-env-conj-R2</code>), and therefore <code class="language-plaintext highlighter-rouge">Î´â‚ âŠ” Î´â‚‚ âŠ¢ Mâ‚ Â· Mâ‚‚ â†“ vâ‚ƒ</code>. We conclude this case by obtaining <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ Ïƒ â†“ Î´â‚ âŠ” Î´â‚‚</code> by the <code class="language-plaintext highlighter-rouge">subst-âŠ”</code> lemma.</p></li></ul></li><li>Case <code class="language-plaintext highlighter-rouge">â†¦-intro</code>: We have <code class="language-plaintext highlighter-rouge">subst Ïƒ M â‰¡ Æ› Lâ€²</code>. We proceed by cases on <code class="language-plaintext highlighter-rouge">M</code>.<ul><li><p>Case <code class="language-plaintext highlighter-rouge">M â‰¡ x</code>: We apply the <code class="language-plaintext highlighter-rouge">subst-reflect-var</code> lemma.</p></li><li><p>Case <code class="language-plaintext highlighter-rouge">M â‰¡ Æ› Mâ€²</code>: By the induction hypothesis, we have <code class="language-plaintext highlighter-rouge">(Î´â€² , vâ€²) âŠ¢ Mâ€² â†“ vâ‚‚</code> and <code class="language-plaintext highlighter-rouge">(Î´ , vâ‚) âŠ¢ exts Ïƒ â†“ (Î´â€² , vâ€²)</code>. From the later we have <code class="language-plaintext highlighter-rouge">(Î´ , vâ‚) âŠ¢ # 0 â†“ vâ€²</code>. By the lemma <code class="language-plaintext highlighter-rouge">var-inv</code> we have <code class="language-plaintext highlighter-rouge">vâ€² âŠ‘ vâ‚</code>, so by the <code class="language-plaintext highlighter-rouge">up-env</code> lemma we have <code class="language-plaintext highlighter-rouge">(Î´â€² , vâ‚) âŠ¢ Mâ€² â†“ vâ‚‚</code> and therefore <code class="language-plaintext highlighter-rouge">Î´â€² âŠ¢ Æ› Mâ€² â†“ vâ‚ â†’ vâ‚‚</code>. We also need to show that <code class="language-plaintext highlighter-rouge">Î´</code>âŠ¢ Ïƒ â†“ Î´â€²<code class="language-plaintext highlighter-rouge">. Fix</code>k<code class="language-plaintext highlighter-rouge">. We have</code>(Î´ , vâ‚) âŠ¢ rename S_ Ïƒ k â†“ Î´ kâ€²<code class="language-plaintext highlighter-rouge">. We then apply the lemma</code>rename-inc-reflect<code class="language-plaintext highlighter-rouge">to obtain</code>Î´ âŠ¢ Ïƒ k â†“ Î´ kâ€²`, so this case is complete.</p></li></ul></li><li><p>Case <code class="language-plaintext highlighter-rouge">âŠ¥-intro</code>: We choose <code class="language-plaintext highlighter-rouge">âŠ¥</code> for <code class="language-plaintext highlighter-rouge">Î´</code>. We have <code class="language-plaintext highlighter-rouge">âŠ¥ âŠ¢ M â†“ âŠ¥</code> by <code class="language-plaintext highlighter-rouge">âŠ¥-intro</code>. We have <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ Ïƒ â†“ âŠ¥</code> by the lemma <code class="language-plaintext highlighter-rouge">subst-empty</code>.</p></li><li>Case <code class="language-plaintext highlighter-rouge">âŠ”-intro</code>: By the induction hypothesis we have <code class="language-plaintext highlighter-rouge">Î´â‚ âŠ¢ M â†“ vâ‚</code>, <code class="language-plaintext highlighter-rouge">Î´â‚‚ âŠ¢ M â†“ vâ‚‚</code>, <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ Ïƒ â†“ Î´â‚</code>, and <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ Ïƒ â†“ Î´â‚‚</code>. We have <code class="language-plaintext highlighter-rouge">Î´â‚ âŠ” Î´â‚‚ âŠ¢ M â†“ vâ‚</code> and <code class="language-plaintext highlighter-rouge">Î´â‚ âŠ” Î´â‚‚ âŠ¢ M â†“ vâ‚‚</code> by <code class="language-plaintext highlighter-rouge">âŠ‘-env</code> with <code class="language-plaintext highlighter-rouge">âŠ‘-env-conj-R1</code> and <code class="language-plaintext highlighter-rouge">âŠ‘-env-conj-R2</code>. So by <code class="language-plaintext highlighter-rouge">âŠ”-intro</code> we have <code class="language-plaintext highlighter-rouge">Î´â‚ âŠ” Î´â‚‚ âŠ¢ M â†“ vâ‚ âŠ” vâ‚‚</code>. By <code class="language-plaintext highlighter-rouge">subst-âŠ”</code> we conclude that <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ Ïƒ â†“ Î´â‚ âŠ” Î´â‚‚</code>.</li></ul><h3 id="single-substitution-reflects-denotations">Single substitution reflects denotations</h3><p>Most of the work is now behind us. We have proved that simultaneous substitution reflects denotations. Of course, Î² reduction uses single substitution, so we need a corollary that proves that single substitution reflects denotations. That is, given terms <code class="language-plaintext highlighter-rouge">N : (Î“ , â˜… âŠ¢ â˜…)</code> and <code class="language-plaintext highlighter-rouge">M : (Î“ âŠ¢ â˜…)</code>, if <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ N [ M ] â†“ w</code>, then <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ M â†“ v</code> and <code class="language-plaintext highlighter-rouge">(Î³ , v) âŠ¢ N â†“ w</code> for some value <code class="language-plaintext highlighter-rouge">v</code>. We have <code class="language-plaintext highlighter-rouge">N [ M ] = subst (subst-zero M) N</code>.</p><p>We first prove a lemma about <code class="language-plaintext highlighter-rouge">subst-zero</code>, that if <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ subst-zero M â†“ Î³</code>, then <code class="language-plaintext highlighter-rouge">Î³ âŠ‘ (Î´ , w) Ã— Î´ âŠ¢ M â†“ w</code> for some <code class="language-plaintext highlighter-rouge">w</code>.</p><pre class="Agda"><a id="subst-zero-reflect"></a><a id="20080" href="/20.07/Soundness/#20080" class="Function">subst-zero-reflect</a> <a id="20099" class="Symbol">:</a> <a id="20101" class="Symbol">âˆ€</a> <a id="20103" class="Symbol">{</a><a id="20104" href="/20.07/Soundness/#20104" class="Bound">Î”</a><a id="20105" class="Symbol">}</a> <a id="20107" class="Symbol">{</a><a id="20108" href="/20.07/Soundness/#20108" class="Bound">Î´</a> <a id="20110" class="Symbol">:</a> <a id="20112" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="20116" href="/20.07/Soundness/#20104" class="Bound">Î”</a><a id="20117" class="Symbol">}</a> <a id="20119" class="Symbol">{</a><a id="20120" href="/20.07/Soundness/#20120" class="Bound">Î³</a> <a id="20122" class="Symbol">:</a> <a id="20124" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="20128" class="Symbol">(</a><a id="20129" href="/20.07/Soundness/#20104" class="Bound">Î”</a> <a id="20131" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="20133" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="20134" class="Symbol">)}</a> <a id="20137" class="Symbol">{</a><a id="20138" href="/20.07/Soundness/#20138" class="Bound">M</a> <a id="20140" class="Symbol">:</a> <a id="20142" href="/20.07/Soundness/#20104" class="Bound">Î”</a> <a id="20144" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="20146" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="20147" class="Symbol">}</a>
  <a id="20151" class="Symbol">â†’</a> <a id="20153" href="/20.07/Soundness/#20108" class="Bound">Î´</a> <a id="20155" href="/20.07/Soundness/#3199" class="Function Operator">`âŠ¢</a> <a id="20158" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="20169" href="/20.07/Soundness/#20138" class="Bound">M</a> <a id="20171" href="/20.07/Soundness/#3199" class="Function Operator">â†“</a> <a id="20173" href="/20.07/Soundness/#20120" class="Bound">Î³</a>
    <a id="20179" class="Comment">----------------------------------------</a>
  <a id="20222" class="Symbol">â†’</a> <a id="20224" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Î£[</a> <a id="20227" href="/20.07/Soundness/#20227" class="Bound">w</a> <a id="20229" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">âˆˆ</a> <a id="20231" href="/20.07/Denotational/#4151" class="Datatype">Value</a> <a id="20237" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">]</a> <a id="20239" href="/20.07/Soundness/#20120" class="Bound">Î³</a> <a id="20241" href="/20.07/Denotational/#8108" class="Function Operator">`âŠ‘</a> <a id="20244" class="Symbol">(</a><a id="20245" href="/20.07/Soundness/#20108" class="Bound">Î´</a> <a id="20247" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="20250" href="/20.07/Soundness/#20227" class="Bound">w</a><a id="20251" class="Symbol">)</a> <a id="20253" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">Ã—</a> <a id="20255" href="/20.07/Soundness/#20108" class="Bound">Î´</a> <a id="20257" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="20259" href="/20.07/Soundness/#20138" class="Bound">M</a> <a id="20261" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="20263" href="/20.07/Soundness/#20227" class="Bound">w</a>
<a id="20265" href="/20.07/Soundness/#20080" class="Function">subst-zero-reflect</a> <a id="20284" class="Symbol">{</a><a id="20285" class="Argument">Î´</a> <a id="20287" class="Symbol">=</a> <a id="20289" href="/20.07/Soundness/#20289" class="Bound">Î´</a><a id="20290" class="Symbol">}</a> <a id="20292" class="Symbol">{</a><a id="20293" class="Argument">Î³</a> <a id="20295" class="Symbol">=</a> <a id="20297" href="/20.07/Soundness/#20297" class="Bound">Î³</a><a id="20298" class="Symbol">}</a> <a id="20300" href="/20.07/Soundness/#20300" class="Bound">Î´ÏƒÎ³</a> <a id="20304" class="Symbol">=</a> <a id="20306" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="20308" href="/20.07/Denotational/#7741" class="Function">last</a> <a id="20313" href="/20.07/Soundness/#20297" class="Bound">Î³</a> <a id="20315" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="20317" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="20319" href="/20.07/Soundness/#20347" class="Function">lemma</a> <a id="20325" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="20327" href="/20.07/Soundness/#20300" class="Bound">Î´ÏƒÎ³</a> <a id="20331" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="20333" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="20335" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>
  <a id="20339" class="Keyword">where</a>
  <a id="20347" href="/20.07/Soundness/#20347" class="Function">lemma</a> <a id="20353" class="Symbol">:</a> <a id="20355" href="/20.07/Soundness/#20297" class="Bound">Î³</a> <a id="20357" href="/20.07/Denotational/#8108" class="Function Operator">`âŠ‘</a> <a id="20360" class="Symbol">(</a><a id="20361" href="/20.07/Soundness/#20289" class="Bound">Î´</a> <a id="20363" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="20366" href="/20.07/Denotational/#7741" class="Function">last</a> <a id="20371" href="/20.07/Soundness/#20297" class="Bound">Î³</a><a id="20372" class="Symbol">)</a>
  <a id="20376" href="/20.07/Soundness/#20347" class="Function">lemma</a> <a id="20382" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a>  <a id="20385" class="Symbol">=</a>  <a id="20388" href="/20.07/Denotational/#5638" class="Function">âŠ‘-refl</a>
  <a id="20397" href="/20.07/Soundness/#20347" class="Function">lemma</a> <a id="20403" class="Symbol">(</a><a id="20404" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="20406" href="/20.07/Soundness/#20406" class="Bound">x</a><a id="20407" class="Symbol">)</a> <a id="20409" class="Symbol">=</a> <a id="20411" href="/20.07/Compositional/#10012" class="Function">var-inv</a> <a id="20419" class="Symbol">(</a><a id="20420" href="/20.07/Soundness/#20300" class="Bound">Î´ÏƒÎ³</a> <a id="20424" class="Symbol">(</a><a id="20425" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="20427" href="/20.07/Soundness/#20406" class="Bound">x</a><a id="20428" class="Symbol">))</a>
</pre><p>We choose <code class="language-plaintext highlighter-rouge">w</code> to be the last value in <code class="language-plaintext highlighter-rouge">Î³</code> and we obtain <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ M â†“ w</code> by applying the premise to variable <code class="language-plaintext highlighter-rouge">Z</code>. Finally, to prove <code class="language-plaintext highlighter-rouge">Î³ âŠ‘ (Î´ , w)</code>, we prove a lemma by induction in the input variable. The base case is trivial because of our choice of <code class="language-plaintext highlighter-rouge">w</code>. In the induction case, <code class="language-plaintext highlighter-rouge">S x</code>, the premise <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ subst-zero M â†“ Î³</code> gives us <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ x â†“ Î³ (S x)</code> and then using <code class="language-plaintext highlighter-rouge">var-inv</code> we conclude that <code class="language-plaintext highlighter-rouge">Î³ (S x) âŠ‘ (Î´</code>, w) (S x)`.</p><p>Now to prove that substitution reflects denotations.</p><pre class="Agda"><a id="substitution-reflect"></a><a id="20907" href="/20.07/Soundness/#20907" class="Function">substitution-reflect</a> <a id="20928" class="Symbol">:</a> <a id="20930" class="Symbol">âˆ€</a> <a id="20932" class="Symbol">{</a><a id="20933" href="/20.07/Soundness/#20933" class="Bound">Î”</a><a id="20934" class="Symbol">}</a> <a id="20936" class="Symbol">{</a><a id="20937" href="/20.07/Soundness/#20937" class="Bound">Î´</a> <a id="20939" class="Symbol">:</a> <a id="20941" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="20945" href="/20.07/Soundness/#20933" class="Bound">Î”</a><a id="20946" class="Symbol">}</a> <a id="20948" class="Symbol">{</a><a id="20949" href="/20.07/Soundness/#20949" class="Bound">N</a> <a id="20951" class="Symbol">:</a> <a id="20953" href="/20.07/Soundness/#20933" class="Bound">Î”</a> <a id="20955" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="20957" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a> <a id="20959" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="20961" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="20962" class="Symbol">}</a> <a id="20964" class="Symbol">{</a><a id="20965" href="/20.07/Soundness/#20965" class="Bound">M</a> <a id="20967" class="Symbol">:</a> <a id="20969" href="/20.07/Soundness/#20933" class="Bound">Î”</a> <a id="20971" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="20973" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="20974" class="Symbol">}</a> <a id="20976" class="Symbol">{</a><a id="20977" href="/20.07/Soundness/#20977" class="Bound">v</a><a id="20978" class="Symbol">}</a>
  <a id="20982" class="Symbol">â†’</a> <a id="20984" href="/20.07/Soundness/#20937" class="Bound">Î´</a> <a id="20986" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="20988" href="/20.07/Soundness/#20949" class="Bound">N</a> <a id="20990" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="20992" href="/20.07/Soundness/#20965" class="Bound">M</a> <a id="20994" href="/20.07/Untyped/#7491" class="Function Operator">]</a> <a id="20996" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="20998" href="/20.07/Soundness/#20977" class="Bound">v</a>
    <a id="21004" class="Comment">------------------------------------------------</a>
  <a id="21055" class="Symbol">â†’</a> <a id="21057" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Î£[</a> <a id="21060" href="/20.07/Soundness/#21060" class="Bound">w</a> <a id="21062" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">âˆˆ</a> <a id="21064" href="/20.07/Denotational/#4151" class="Datatype">Value</a> <a id="21070" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">]</a> <a id="21072" href="/20.07/Soundness/#20937" class="Bound">Î´</a> <a id="21074" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="21076" href="/20.07/Soundness/#20965" class="Bound">M</a> <a id="21078" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="21080" href="/20.07/Soundness/#21060" class="Bound">w</a>  <a id="21083" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">Ã—</a>  <a id="21086" class="Symbol">(</a><a id="21087" href="/20.07/Soundness/#20937" class="Bound">Î´</a> <a id="21089" href="/20.07/Denotational/#7445" class="Function Operator">`,</a> <a id="21092" href="/20.07/Soundness/#21060" class="Bound">w</a><a id="21093" class="Symbol">)</a> <a id="21095" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="21097" href="/20.07/Soundness/#20949" class="Bound">N</a> <a id="21099" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="21101" href="/20.07/Soundness/#20977" class="Bound">v</a>
<a id="21103" href="/20.07/Soundness/#20907" class="Function">substitution-reflect</a> <a id="21124" href="/20.07/Soundness/#21124" class="Bound">d</a> <a id="21126" class="Keyword">with</a> <a id="21131" href="/20.07/Soundness/#15579" class="Function">subst-reflect</a> <a id="21145" href="/20.07/Soundness/#21124" class="Bound">d</a> <a id="21147" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="21152" class="Symbol">...</a>  <a id="21157" class="Symbol">|</a> <a id="21159" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="21161" href="/20.07/Soundness/#21161" class="Bound">Î³</a> <a id="21163" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21165" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="21167" href="/20.07/Soundness/#21167" class="Bound">Î´ÏƒÎ³</a> <a id="21171" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21173" href="/20.07/Soundness/#21173" class="Bound">Î³Nv</a> <a id="21177" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="21179" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="21181" class="Keyword">with</a> <a id="21186" href="/20.07/Soundness/#20080" class="Function">subst-zero-reflect</a> <a id="21205" href="/20.07/Soundness/#21167" class="Bound">Î´ÏƒÎ³</a>
<a id="21209" class="Symbol">...</a>    <a id="21216" class="Symbol">|</a> <a id="21218" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="21220" href="/20.07/Soundness/#21220" class="Bound">w</a> <a id="21222" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21224" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="21226" href="/20.07/Soundness/#21226" class="Bound">ineq</a> <a id="21231" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21233" href="/20.07/Soundness/#21233" class="Bound">Î´Mw</a> <a id="21237" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="21239" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="21241" class="Symbol">=</a> <a id="21243" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="21245" href="/20.07/Soundness/#21220" class="Bound">w</a> <a id="21247" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21249" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="21251" href="/20.07/Soundness/#21233" class="Bound">Î´Mw</a> <a id="21255" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21257" href="/20.07/Denotational/#25713" class="Function">âŠ‘-env</a> <a id="21263" class="Bound">Î³Nv</a> <a id="21267" href="/20.07/Soundness/#21226" class="Bound">ineq</a> <a id="21272" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="21274" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>
</pre><p>We apply the <code class="language-plaintext highlighter-rouge">subst-reflect</code> lemma to obtain <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ subst-zero M â†“ Î³</code> and <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ N â†“ v</code> for some <code class="language-plaintext highlighter-rouge">Î³</code>. Using the former, the <code class="language-plaintext highlighter-rouge">subst-zero-reflect</code> lemma gives us <code class="language-plaintext highlighter-rouge">Î³ âŠ‘ (Î´ , w)</code> and <code class="language-plaintext highlighter-rouge">Î´ âŠ¢ M â†“ w</code>. We conclude that <code class="language-plaintext highlighter-rouge">Î´ , w âŠ¢ N â†“ v</code> by applying the <code class="language-plaintext highlighter-rouge">âŠ‘-env</code> lemma, using <code class="language-plaintext highlighter-rouge">Î³ âŠ¢ N â†“ v</code> and <code class="language-plaintext highlighter-rouge">Î³ âŠ‘ (Î´ , w)</code>.</p><h3 id="reduction-reflects-denotations-1">Reduction reflects denotations</h3><p>Now that we have proved that substitution reflects denotations, we can easily prove that reduction does too.</p><pre class="Agda"><a id="reflect-beta"></a><a id="21721" href="/20.07/Soundness/#21721" class="Function">reflect-beta</a> <a id="21734" class="Symbol">:</a> <a id="21736" class="Symbol">âˆ€{</a><a id="21738" href="/20.07/Soundness/#21738" class="Bound">Î“</a><a id="21739" class="Symbol">}{</a><a id="21741" href="/20.07/Soundness/#21741" class="Bound">Î³</a> <a id="21743" class="Symbol">:</a> <a id="21745" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="21749" href="/20.07/Soundness/#21738" class="Bound">Î“</a><a id="21750" class="Symbol">}{</a><a id="21752" href="/20.07/Soundness/#21752" class="Bound">M</a> <a id="21754" href="/20.07/Soundness/#21754" class="Bound">N</a><a id="21755" class="Symbol">}{</a><a id="21757" href="/20.07/Soundness/#21757" class="Bound">v</a><a id="21758" class="Symbol">}</a>
    <a id="21764" class="Symbol">â†’</a> <a id="21766" href="/20.07/Soundness/#21741" class="Bound">Î³</a> <a id="21768" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="21770" class="Symbol">(</a><a id="21771" href="/20.07/Soundness/#21754" class="Bound">N</a> <a id="21773" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="21775" href="/20.07/Soundness/#21752" class="Bound">M</a> <a id="21777" href="/20.07/Untyped/#7491" class="Function Operator">]</a><a id="21778" class="Symbol">)</a> <a id="21780" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="21782" href="/20.07/Soundness/#21757" class="Bound">v</a>
    <a id="21788" class="Symbol">â†’</a> <a id="21790" href="/20.07/Soundness/#21741" class="Bound">Î³</a> <a id="21792" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="21794" class="Symbol">(</a><a id="21795" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="21797" href="/20.07/Soundness/#21754" class="Bound">N</a><a id="21798" class="Symbol">)</a> <a id="21800" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">Â·</a> <a id="21802" href="/20.07/Soundness/#21752" class="Bound">M</a> <a id="21804" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="21806" href="/20.07/Soundness/#21757" class="Bound">v</a>
<a id="21808" href="/20.07/Soundness/#21721" class="Function">reflect-beta</a> <a id="21821" href="/20.07/Soundness/#21821" class="Bound">d</a>
    <a id="21827" class="Keyword">with</a> <a id="21832" href="/20.07/Soundness/#20907" class="Function">substitution-reflect</a> <a id="21853" href="/20.07/Soundness/#21821" class="Bound">d</a>
<a id="21855" class="Symbol">...</a> <a id="21859" class="Symbol">|</a> <a id="21861" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="21863" href="/20.07/Soundness/#21863" class="Bound">vâ‚‚â€²</a> <a id="21867" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21869" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="21871" href="/20.07/Soundness/#21871" class="Bound">dâ‚â€²</a> <a id="21875" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21877" href="/20.07/Soundness/#21877" class="Bound">dâ‚‚â€²</a> <a id="21881" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="21883" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a> <a id="21885" class="Symbol">=</a> <a id="21887" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="21894" class="Symbol">(</a><a id="21895" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="21903" href="/20.07/Soundness/#21877" class="Bound">dâ‚‚â€²</a><a id="21906" class="Symbol">)</a> <a id="21908" href="/20.07/Soundness/#21871" class="Bound">dâ‚â€²</a>


<a id="reflect"></a><a id="21914" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="21922" class="Symbol">:</a> <a id="21924" class="Symbol">âˆ€</a> <a id="21926" class="Symbol">{</a><a id="21927" href="/20.07/Soundness/#21927" class="Bound">Î“</a><a id="21928" class="Symbol">}</a> <a id="21930" class="Symbol">{</a><a id="21931" href="/20.07/Soundness/#21931" class="Bound">Î³</a> <a id="21933" class="Symbol">:</a> <a id="21935" href="/20.07/Denotational/#7288" class="Function">Env</a> <a id="21939" href="/20.07/Soundness/#21927" class="Bound">Î“</a><a id="21940" class="Symbol">}</a> <a id="21942" class="Symbol">{</a><a id="21943" href="/20.07/Soundness/#21943" class="Bound">M</a> <a id="21945" href="/20.07/Soundness/#21945" class="Bound">Mâ€²</a> <a id="21948" href="/20.07/Soundness/#21948" class="Bound">N</a> <a id="21950" href="/20.07/Soundness/#21950" class="Bound">v</a><a id="21951" class="Symbol">}</a>
  <a id="21955" class="Symbol">â†’</a> <a id="21957" href="/20.07/Soundness/#21931" class="Bound">Î³</a> <a id="21959" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="21961" href="/20.07/Soundness/#21948" class="Bound">N</a> <a id="21963" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="21965" href="/20.07/Soundness/#21950" class="Bound">v</a>  <a id="21968" class="Symbol">â†’</a>  <a id="21971" href="/20.07/Soundness/#21943" class="Bound">M</a> <a id="21973" href="/20.07/Untyped/#9948" class="Datatype Operator">â€”â†’</a> <a id="21976" href="/20.07/Soundness/#21945" class="Bound">Mâ€²</a>  <a id="21980" class="Symbol">â†’</a>   <a id="21984" href="/20.07/Soundness/#21945" class="Bound">Mâ€²</a> <a id="21987" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">â‰¡</a> <a id="21989" href="/20.07/Soundness/#21948" class="Bound">N</a>
    <a id="21995" class="Comment">---------------------------------</a>
  <a id="22031" class="Symbol">â†’</a> <a id="22033" href="/20.07/Soundness/#21931" class="Bound">Î³</a> <a id="22035" href="/20.07/Denotational/#9346" class="Datatype Operator">âŠ¢</a> <a id="22037" href="/20.07/Soundness/#21943" class="Bound">M</a> <a id="22039" href="/20.07/Denotational/#9346" class="Datatype Operator">â†“</a> <a id="22041" href="/20.07/Soundness/#21950" class="Bound">v</a>
<a id="22043" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22051" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="22055" class="Symbol">(</a><a id="22056" href="/20.07/Untyped/#9998" class="InductiveConstructor">Î¾â‚</a> <a id="22059" href="/20.07/Soundness/#22059" class="Bound">r</a><a id="22060" class="Symbol">)</a> <a id="22062" class="Symbol">()</a>
<a id="22065" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22073" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="22077" class="Symbol">(</a><a id="22078" href="/20.07/Untyped/#10088" class="InductiveConstructor">Î¾â‚‚</a> <a id="22081" href="/20.07/Soundness/#22081" class="Bound">r</a><a id="22082" class="Symbol">)</a> <a id="22084" class="Symbol">()</a>
<a id="22087" href="/20.07/Soundness/#21914" class="Function">reflect</a><a id="22094" class="Symbol">{</a><a id="22095" class="Argument">Î³</a> <a id="22097" class="Symbol">=</a> <a id="22099" href="/20.07/Soundness/#22099" class="Bound">Î³</a><a id="22100" class="Symbol">}</a> <a id="22102" class="Symbol">(</a><a id="22103" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a><a id="22106" class="Symbol">{</a><a id="22107" class="Argument">x</a> <a id="22109" class="Symbol">=</a> <a id="22111" href="/20.07/Soundness/#22111" class="Bound">x</a><a id="22112" class="Symbol">})</a> <a id="22115" href="/20.07/Untyped/#10178" class="InductiveConstructor">Î²</a> <a id="22117" href="/20.07/Soundness/#22117" class="Bound">mn</a>
    <a id="22124" class="Keyword">with</a> <a id="22129" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a><a id="22132" class="Symbol">{</a><a id="22133" class="Argument">Î³</a> <a id="22135" class="Symbol">=</a> <a id="22137" href="/20.07/Soundness/#22099" class="Bound">Î³</a><a id="22138" class="Symbol">}{</a><a id="22140" class="Argument">x</a> <a id="22142" class="Symbol">=</a> <a id="22144" href="/20.07/Soundness/#22111" class="Bound">x</a><a id="22145" class="Symbol">}</a>
<a id="22147" class="Symbol">...</a> <a id="22151" class="Symbol">|</a> <a id="22153" href="/20.07/Soundness/#22153" class="Bound">dâ€²</a> <a id="22156" class="Keyword">rewrite</a> <a id="22164" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="22168" class="Bound">mn</a> <a id="22171" class="Symbol">=</a> <a id="22173" href="/20.07/Soundness/#21721" class="Function">reflect-beta</a> <a id="22186" href="/20.07/Soundness/#22153" class="Bound">dâ€²</a>
<a id="22189" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22197" href="/20.07/Denotational/#9400" class="InductiveConstructor">var</a> <a id="22201" class="Symbol">(</a><a id="22202" href="/20.07/Untyped/#10286" class="InductiveConstructor">Î¶</a> <a id="22204" href="/20.07/Soundness/#22204" class="Bound">r</a><a id="22205" class="Symbol">)</a> <a id="22207" class="Symbol">()</a>
<a id="22210" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22218" class="Symbol">(</a><a id="22219" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="22226" href="/20.07/Soundness/#22226" class="Bound">dâ‚</a> <a id="22229" href="/20.07/Soundness/#22229" class="Bound">dâ‚‚</a><a id="22231" class="Symbol">)</a> <a id="22233" class="Symbol">(</a><a id="22234" href="/20.07/Untyped/#9998" class="InductiveConstructor">Î¾â‚</a> <a id="22237" href="/20.07/Soundness/#22237" class="Bound">r</a><a id="22238" class="Symbol">)</a> <a id="22240" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="22245" class="Symbol">=</a> <a id="22247" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="22254" class="Symbol">(</a><a id="22255" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22263" href="/20.07/Soundness/#22226" class="Bound">dâ‚</a> <a id="22266" href="/20.07/Soundness/#22237" class="Bound">r</a> <a id="22268" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22272" class="Symbol">)</a> <a id="22274" href="/20.07/Soundness/#22229" class="Bound">dâ‚‚</a>
<a id="22277" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22285" class="Symbol">(</a><a id="22286" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="22293" href="/20.07/Soundness/#22293" class="Bound">dâ‚</a> <a id="22296" href="/20.07/Soundness/#22296" class="Bound">dâ‚‚</a><a id="22298" class="Symbol">)</a> <a id="22300" class="Symbol">(</a><a id="22301" href="/20.07/Untyped/#10088" class="InductiveConstructor">Î¾â‚‚</a> <a id="22304" href="/20.07/Soundness/#22304" class="Bound">r</a><a id="22305" class="Symbol">)</a> <a id="22307" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="22312" class="Symbol">=</a> <a id="22314" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="22321" href="/20.07/Soundness/#22293" class="Bound">dâ‚</a> <a id="22324" class="Symbol">(</a><a id="22325" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22333" href="/20.07/Soundness/#22296" class="Bound">dâ‚‚</a> <a id="22336" href="/20.07/Soundness/#22304" class="Bound">r</a> <a id="22338" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22342" class="Symbol">)</a>
<a id="22344" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22352" class="Symbol">(</a><a id="22353" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="22360" href="/20.07/Soundness/#22360" class="Bound">dâ‚</a> <a id="22363" href="/20.07/Soundness/#22363" class="Bound">dâ‚‚</a><a id="22365" class="Symbol">)</a> <a id="22367" href="/20.07/Untyped/#10178" class="InductiveConstructor">Î²</a> <a id="22369" href="/20.07/Soundness/#22369" class="Bound">mn</a>
    <a id="22376" class="Keyword">with</a> <a id="22381" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="22388" href="/20.07/Soundness/#22360" class="Bound">dâ‚</a> <a id="22391" href="/20.07/Soundness/#22363" class="Bound">dâ‚‚</a>
<a id="22394" class="Symbol">...</a> <a id="22398" class="Symbol">|</a> <a id="22400" href="/20.07/Soundness/#22400" class="Bound">dâ€²</a> <a id="22403" class="Keyword">rewrite</a> <a id="22411" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="22415" class="Bound">mn</a> <a id="22418" class="Symbol">=</a> <a id="22420" href="/20.07/Soundness/#21721" class="Function">reflect-beta</a> <a id="22433" href="/20.07/Soundness/#22400" class="Bound">dâ€²</a>
<a id="22436" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22444" class="Symbol">(</a><a id="22445" href="/20.07/Denotational/#9475" class="InductiveConstructor">â†¦-elim</a> <a id="22452" href="/20.07/Soundness/#22452" class="Bound">dâ‚</a> <a id="22455" href="/20.07/Soundness/#22455" class="Bound">dâ‚‚</a><a id="22457" class="Symbol">)</a> <a id="22459" class="Symbol">(</a><a id="22460" href="/20.07/Untyped/#10286" class="InductiveConstructor">Î¶</a> <a id="22462" href="/20.07/Soundness/#22462" class="Bound">r</a><a id="22463" class="Symbol">)</a> <a id="22465" class="Symbol">()</a>
<a id="22468" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22476" class="Symbol">(</a><a id="22477" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="22485" href="/20.07/Soundness/#22485" class="Bound">d</a><a id="22486" class="Symbol">)</a> <a id="22488" class="Symbol">(</a><a id="22489" href="/20.07/Untyped/#9998" class="InductiveConstructor">Î¾â‚</a> <a id="22492" href="/20.07/Soundness/#22492" class="Bound">r</a><a id="22493" class="Symbol">)</a> <a id="22495" class="Symbol">()</a>
<a id="22498" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22506" class="Symbol">(</a><a id="22507" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="22515" href="/20.07/Soundness/#22515" class="Bound">d</a><a id="22516" class="Symbol">)</a> <a id="22518" class="Symbol">(</a><a id="22519" href="/20.07/Untyped/#10088" class="InductiveConstructor">Î¾â‚‚</a> <a id="22522" href="/20.07/Soundness/#22522" class="Bound">r</a><a id="22523" class="Symbol">)</a> <a id="22525" class="Symbol">()</a>
<a id="22528" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22536" class="Symbol">(</a><a id="22537" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="22545" href="/20.07/Soundness/#22545" class="Bound">d</a><a id="22546" class="Symbol">)</a> <a id="22548" href="/20.07/Untyped/#10178" class="InductiveConstructor">Î²</a> <a id="22550" href="/20.07/Soundness/#22550" class="Bound">mn</a>
    <a id="22557" class="Keyword">with</a> <a id="22562" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="22570" href="/20.07/Soundness/#22545" class="Bound">d</a>
<a id="22572" class="Symbol">...</a> <a id="22576" class="Symbol">|</a> <a id="22578" href="/20.07/Soundness/#22578" class="Bound">dâ€²</a> <a id="22581" class="Keyword">rewrite</a> <a id="22589" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="22593" class="Bound">mn</a> <a id="22596" class="Symbol">=</a> <a id="22598" href="/20.07/Soundness/#21721" class="Function">reflect-beta</a> <a id="22611" href="/20.07/Soundness/#22578" class="Bound">dâ€²</a>
<a id="22614" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22622" class="Symbol">(</a><a id="22623" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="22631" href="/20.07/Soundness/#22631" class="Bound">d</a><a id="22632" class="Symbol">)</a> <a id="22634" class="Symbol">(</a><a id="22635" href="/20.07/Untyped/#10286" class="InductiveConstructor">Î¶</a> <a id="22637" href="/20.07/Soundness/#22637" class="Bound">r</a><a id="22638" class="Symbol">)</a> <a id="22640" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="22645" class="Symbol">=</a> <a id="22647" href="/20.07/Denotational/#9597" class="InductiveConstructor">â†¦-intro</a> <a id="22655" class="Symbol">(</a><a id="22656" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22664" href="/20.07/Soundness/#22631" class="Bound">d</a> <a id="22666" href="/20.07/Soundness/#22637" class="Bound">r</a> <a id="22668" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22672" class="Symbol">)</a>
<a id="22674" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22682" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a> <a id="22690" href="/20.07/Soundness/#22690" class="Bound">r</a> <a id="22692" href="/20.07/Soundness/#22692" class="Bound">mn</a> <a id="22695" class="Symbol">=</a> <a id="22697" href="/20.07/Denotational/#9709" class="InductiveConstructor">âŠ¥-intro</a>
<a id="22705" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22713" class="Symbol">(</a><a id="22714" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="22722" href="/20.07/Soundness/#22722" class="Bound">dâ‚</a> <a id="22725" href="/20.07/Soundness/#22725" class="Bound">dâ‚‚</a><a id="22727" class="Symbol">)</a> <a id="22729" href="/20.07/Soundness/#22729" class="Bound">r</a> <a id="22731" href="/20.07/Soundness/#22731" class="Bound">mn</a> <a id="22734" class="Keyword">rewrite</a> <a id="22742" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="22746" href="/20.07/Soundness/#22731" class="Bound">mn</a> <a id="22749" class="Symbol">=</a>
   <a id="22754" href="/20.07/Denotational/#9776" class="InductiveConstructor">âŠ”-intro</a> <a id="22762" class="Symbol">(</a><a id="22763" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22771" href="/20.07/Soundness/#22722" class="Bound">dâ‚</a> <a id="22774" href="/20.07/Soundness/#22729" class="Bound">r</a> <a id="22776" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22780" class="Symbol">)</a> <a id="22782" class="Symbol">(</a><a id="22783" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22791" href="/20.07/Soundness/#22725" class="Bound">dâ‚‚</a> <a id="22794" href="/20.07/Soundness/#22729" class="Bound">r</a> <a id="22796" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22800" class="Symbol">)</a>
<a id="22802" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22810" class="Symbol">(</a><a id="22811" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="22815" href="/20.07/Soundness/#22815" class="Bound">d</a> <a id="22817" href="/20.07/Soundness/#22817" class="Bound">lt</a><a id="22819" class="Symbol">)</a> <a id="22821" href="/20.07/Soundness/#22821" class="Bound">r</a> <a id="22823" href="/20.07/Soundness/#22823" class="Bound">mn</a> <a id="22826" class="Symbol">=</a> <a id="22828" href="/20.07/Denotational/#9891" class="InductiveConstructor">sub</a> <a id="22832" class="Symbol">(</a><a id="22833" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="22841" href="/20.07/Soundness/#22815" class="Bound">d</a> <a id="22843" href="/20.07/Soundness/#22821" class="Bound">r</a> <a id="22845" href="/20.07/Soundness/#22823" class="Bound">mn</a><a id="22847" class="Symbol">)</a> <a id="22849" href="/20.07/Soundness/#22817" class="Bound">lt</a>
</pre><h2 id="reduction-implies-denotational-equality">Reduction implies denotational equality</h2><p>We have proved that reduction both preserves and reflects denotations. Thus, reduction implies denotational equality.</p><pre class="Agda"><a id="reduce-equal"></a><a id="23024" href="/20.07/Soundness/#23024" class="Function">reduce-equal</a> <a id="23037" class="Symbol">:</a> <a id="23039" class="Symbol">âˆ€</a> <a id="23041" class="Symbol">{</a><a id="23042" href="/20.07/Soundness/#23042" class="Bound">Î“</a><a id="23043" class="Symbol">}</a> <a id="23045" class="Symbol">{</a><a id="23046" href="/20.07/Soundness/#23046" class="Bound">M</a> <a id="23048" class="Symbol">:</a> <a id="23050" href="/20.07/Soundness/#23042" class="Bound">Î“</a> <a id="23052" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="23054" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="23055" class="Symbol">}</a> <a id="23057" class="Symbol">{</a><a id="23058" href="/20.07/Soundness/#23058" class="Bound">N</a> <a id="23060" class="Symbol">:</a> <a id="23062" href="/20.07/Soundness/#23042" class="Bound">Î“</a> <a id="23064" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="23066" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="23067" class="Symbol">}</a>
  <a id="23071" class="Symbol">â†’</a> <a id="23073" href="/20.07/Soundness/#23046" class="Bound">M</a> <a id="23075" href="/20.07/Untyped/#9948" class="Datatype Operator">â€”â†’</a> <a id="23078" href="/20.07/Soundness/#23058" class="Bound">N</a>
    <a id="23084" class="Comment">---------</a>
  <a id="23096" class="Symbol">â†’</a> <a id="23098" href="/20.07/Denotational/#17486" class="Function">â„°</a> <a id="23100" href="/20.07/Soundness/#23046" class="Bound">M</a> <a id="23102" href="/20.07/Denotational/#17668" class="Function Operator">â‰ƒ</a> <a id="23104" href="/20.07/Denotational/#17486" class="Function">â„°</a> <a id="23106" href="/20.07/Soundness/#23058" class="Bound">N</a>
<a id="23108" href="/20.07/Soundness/#23024" class="Function">reduce-equal</a> <a id="23121" class="Symbol">{</a><a id="23122" href="/20.07/Soundness/#23122" class="Bound">Î“</a><a id="23123" class="Symbol">}{</a><a id="23125" href="/20.07/Soundness/#23125" class="Bound">M</a><a id="23126" class="Symbol">}{</a><a id="23128" href="/20.07/Soundness/#23128" class="Bound">N</a><a id="23129" class="Symbol">}</a> <a id="23131" href="/20.07/Soundness/#23131" class="Bound">r</a> <a id="23133" href="/20.07/Soundness/#23133" class="Bound">Î³</a> <a id="23135" href="/20.07/Soundness/#23135" class="Bound">v</a> <a id="23137" class="Symbol">=</a>
    <a id="23143" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="23145" class="Symbol">(Î»</a> <a id="23148" href="/20.07/Soundness/#23148" class="Bound">m</a> <a id="23150" class="Symbol">â†’</a> <a id="23152" href="/20.07/Soundness/#6614" class="Function">preserve</a> <a id="23161" href="/20.07/Soundness/#23148" class="Bound">m</a> <a id="23163" href="/20.07/Soundness/#23131" class="Bound">r</a><a id="23164" class="Symbol">)</a> <a id="23166" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="23168" class="Symbol">(Î»</a> <a id="23171" href="/20.07/Soundness/#23171" class="Bound">n</a> <a id="23173" class="Symbol">â†’</a> <a id="23175" href="/20.07/Soundness/#21914" class="Function">reflect</a> <a id="23183" href="/20.07/Soundness/#23171" class="Bound">n</a> <a id="23185" href="/20.07/Soundness/#23131" class="Bound">r</a> <a id="23187" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="23191" class="Symbol">)</a> <a id="23193" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>
</pre><p>We conclude with the <em>soundness property</em>, that multi-step reduction to a lambda abstraction implies denotational equivalence with a lambda abstraction.</p><pre class="Agda"><a id="soundness"></a><a id="23358" href="/20.07/Soundness/#23358" class="Function">soundness</a> <a id="23368" class="Symbol">:</a> <a id="23370" class="Symbol">âˆ€{</a><a id="23372" href="/20.07/Soundness/#23372" class="Bound">Î“</a><a id="23373" class="Symbol">}</a> <a id="23375" class="Symbol">{</a><a id="23376" href="/20.07/Soundness/#23376" class="Bound">M</a> <a id="23378" class="Symbol">:</a> <a id="23380" href="/20.07/Soundness/#23372" class="Bound">Î“</a> <a id="23382" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="23384" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="23385" class="Symbol">}</a> <a id="23387" class="Symbol">{</a><a id="23388" href="/20.07/Soundness/#23388" class="Bound">N</a> <a id="23390" class="Symbol">:</a> <a id="23392" href="/20.07/Soundness/#23372" class="Bound">Î“</a> <a id="23394" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="23396" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a> <a id="23398" href="/20.07/Untyped/#4294" class="Datatype Operator">âŠ¢</a> <a id="23400" href="/20.07/Untyped/#2888" class="InductiveConstructor">â˜…</a><a id="23401" class="Symbol">}</a>
  <a id="23405" class="Symbol">â†’</a> <a id="23407" href="/20.07/Soundness/#23376" class="Bound">M</a> <a id="23409" href="/20.07/Untyped/#11068" class="Datatype Operator">â€”â† </a> <a id="23412" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="23414" href="/20.07/Soundness/#23388" class="Bound">N</a>
    <a id="23420" class="Comment">-----------------</a>
  <a id="23440" class="Symbol">â†’</a> <a id="23442" href="/20.07/Denotational/#17486" class="Function">â„°</a> <a id="23444" href="/20.07/Soundness/#23376" class="Bound">M</a> <a id="23446" href="/20.07/Denotational/#17668" class="Function Operator">â‰ƒ</a> <a id="23448" href="/20.07/Denotational/#17486" class="Function">â„°</a> <a id="23450" class="Symbol">(</a><a id="23451" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">Æ›</a> <a id="23453" href="/20.07/Soundness/#23388" class="Bound">N</a><a id="23454" class="Symbol">)</a>
<a id="23456" href="/20.07/Soundness/#23358" class="Function">soundness</a> <a id="23466" class="Symbol">(</a><a id="23467" class="DottedPattern Symbol">.(</a><a id="23469" href="/20.07/Untyped/#4382" class="DottedPattern InductiveConstructor Operator">Æ›</a> <a id="23471" class="DottedPattern Symbol">_)</a> <a id="23474" href="/20.07/Untyped/#11118" class="InductiveConstructor Operator">âˆ</a><a id="23475" class="Symbol">)</a> <a id="23477" href="/20.07/Soundness/#23477" class="Bound">Î³</a> <a id="23479" href="/20.07/Soundness/#23479" class="Bound">v</a> <a id="23481" class="Symbol">=</a> <a id="23483" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ¨</a> <a id="23485" class="Symbol">(Î»</a> <a id="23488" href="/20.07/Soundness/#23488" class="Bound">x</a> <a id="23490" class="Symbol">â†’</a> <a id="23492" href="/20.07/Soundness/#23488" class="Bound">x</a><a id="23493" class="Symbol">)</a> <a id="23495" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="23497" class="Symbol">(Î»</a> <a id="23500" href="/20.07/Soundness/#23500" class="Bound">x</a> <a id="23502" class="Symbol">â†’</a> <a id="23504" href="/20.07/Soundness/#23500" class="Bound">x</a><a id="23505" class="Symbol">)</a> <a id="23507" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">âŸ©</a>
<a id="23509" href="/20.07/Soundness/#23358" class="Function">soundness</a> <a id="23519" class="Symbol">{</a><a id="23520" href="/20.07/Soundness/#23520" class="Bound">Î“</a><a id="23521" class="Symbol">}</a> <a id="23523" class="Symbol">(</a><a id="23524" href="/20.07/Soundness/#23524" class="Bound">L</a> <a id="23526" href="/20.07/Untyped/#11174" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="23530" href="/20.07/Soundness/#23530" class="Bound">r</a> <a id="23532" href="/20.07/Untyped/#11174" class="InductiveConstructor Operator">âŸ©</a> <a id="23534" href="/20.07/Soundness/#23534" class="Bound">Mâ€”â† N</a><a id="23538" class="Symbol">)</a> <a id="23540" href="/20.07/Soundness/#23540" class="Bound">Î³</a> <a id="23542" href="/20.07/Soundness/#23542" class="Bound">v</a> <a id="23544" class="Symbol">=</a>
   <a id="23549" class="Keyword">let</a> <a id="23553" href="/20.07/Soundness/#23553" class="Bound">ih</a> <a id="23556" class="Symbol">=</a> <a id="23558" href="/20.07/Soundness/#23358" class="Function">soundness</a> <a id="23568" href="/20.07/Soundness/#23534" class="Bound">Mâ€”â† N</a> <a id="23573" class="Keyword">in</a>
   <a id="23579" class="Keyword">let</a> <a id="23583" href="/20.07/Soundness/#23583" class="Bound">e</a> <a id="23585" class="Symbol">=</a> <a id="23587" href="/20.07/Soundness/#23024" class="Function">reduce-equal</a> <a id="23600" href="/20.07/Soundness/#23530" class="Bound">r</a> <a id="23602" class="Keyword">in</a>
   <a id="23608" href="/20.07/Denotational/#18073" class="Function">â‰ƒ-trans</a> <a id="23616" class="Symbol">{</a><a id="23617" href="/20.07/Soundness/#23520" class="Bound">Î“</a><a id="23618" class="Symbol">}</a> <a id="23620" href="/20.07/Soundness/#23583" class="Bound">e</a> <a id="23622" href="/20.07/Soundness/#23553" class="Bound">ih</a> <a id="23625" href="/20.07/Soundness/#23540" class="Bound">Î³</a> <a id="23627" href="/20.07/Soundness/#23542" class="Bound">v</a>
</pre><h2 id="unicode">Unicode</h2><p>This chapter uses the following unicode:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â‰Ÿ  U+225F  QUESTIONED EQUAL TO (\?=)
</code></pre></div></div></div><p style="text-align:center"><a alt="Previous chapter" href="/20.07/Compositional/">Prev</a> &bullet; <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev-20.07/src/plfa/part3/Soundness.lagda.md">Source</a> &bullet; <a alt="Next chapter" href="/20.07/Adequacy/">Next</a></p></article></div></main><footer class="site-footer h-card"><data class="u-url" href="/20.07/"></data><div class="wrapper"><h2 class="footer-heading">Programming Language Foundations in Agda</h2><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Philip Wadler</li><li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk">wadler@inf.ed.ac.uk</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wadler"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wadler</span></a></li></ul></div><div class="footer-col footer-col-3"></div></div><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Wen Kokke</li><li><a class="u-email" href="mailto:wen.kokke@ed.ac.uk">wen.kokke@ed.ac.uk</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wenkokke"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wenkokke</span></a></li><li><a href="https://www.twitter.com/wenkokke"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">wenkokke</span></a></li></ul></div><div class="footer-col footer-col-3"></div></div><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Jeremy G. Siek</li><li><a class="u-email" href="mailto:jsiek@indiana.edu">jsiek@indiana.edu</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jsiek"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jsiek</span></a></li><li><a href="https://www.twitter.com/jeremysiek"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jeremysiek</span></a></li></ul></div><div class="footer-col footer-col-3"></div></div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a></div></footer><script type="text/javascript" src="/20.07/assets/jquery.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha256-E4RlfxwyJVmkkk0szw7LYJxuPlp6evtPSBDlWHsYYL8=" crossorigin="anonymous"></script><script type="text/javascript">anchors.add()</script><script type="text/javascript">$(".menu-icon").click(function(){$(".trigger").toggle()}),$("div.foldable pre").each(function(){var i=$(this).height(),t=parseFloat($(this).css("line-height")),h=$("<div></div>"),e=$("<div></div>"),o=$("<div></div>");$(this).prepend(h),h.css({position:"relative",float:"right",right:"-"+(.5*t-1.5)+"px",width:t,height:t}),o.css({position:"relative",height:t,width:"3px","background-color":"#C1E0FF"}),e.css({position:"relative",top:"-"+(.5*t+1.5)+"px",left:"-"+(.5*t-1.5)+"px",height:"3px",width:t,"background-color":"#C1E0FF"}),h.append(o),h.append(e),$(this).height(2*t),$(this).css("overflow","hidden"),$(this).click(function(){$(this).height()==i?($(this).height(2*t),h.show()):($(this).height("auto"),h.hide())})})</script><script type="text/javascript" src="/20.07/assets/katex.js"></script><script type="text/javascript">$("script[type='math/tex']").replaceWith(function(){var t=$(this).text();return'<span class="inline-equation">'+katex.renderToString(t)+"</span>"}),$("script[type='math/tex; mode=display']").replaceWith(function(){var t=$(this).text().replace(/%.*?(\n|$)/g,"");return'<div class="equation">'+katex.renderToString("\\displaystyle "+t)+"</div>"})</script></body></html>