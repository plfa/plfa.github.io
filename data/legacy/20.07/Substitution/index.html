<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Substitution: Substitution in the untyped lambda calculus | Programming Language Foundations in Agda
</title><!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Substitution: Substitution in the untyped lambda calculus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Programming Language Foundations in Agda" />
<meta property="og:description" content="Programming Language Foundations in Agda" />
<link rel="canonical" href="https://plfa.github.io/20.07/Substitution/" />
<meta property="og:url" content="https://plfa.github.io/20.07/Substitution/" />
<meta property="og:site_name" content="Programming Language Foundations in Agda" />
<script type="application/ld+json">
{"url":"https://plfa.github.io/20.07/Substitution/","headline":"Substitution: Substitution in the untyped lambda calculus","description":"Programming Language Foundations in Agda","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/20.07/assets/main.css"></head>
<body><header class="site-header" role="banner">

    <div class="wrapper">

        <a class="site-title" href="/20.07/">Programming Language Foundations in Agda
</a>

        <nav class="site-nav">
            <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span>

            <div class="trigger">
                <a class="page-link" href="/20.07/">The Book</a>
                <a class="page-link" href="/20.07/Announcements/">Announcements</a>
                <a class="page-link" href="/20.07/GettingStarted/">Getting Started</a>
                <a class="page-link" href="/20.07/Citing/">Citing</a>
                <a class="page-link" href="https://agda-zh.github.io/PLFA-zh/">中文</a>
            </div>
        </nav>

    </div>

</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
      <h1 class="post-title">Substitution: Substitution in the untyped lambda calculus</h1>
  </header>

  <p style="text-align:center;">

    <a alt="Previous chapter" href="/20.07/ContextualEquivalence/">Prev</a>


    &bullet;


    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev-20.07/src/plfa/part2/Substitution.lagda.md">Source</a>


    &bullet;


    <a alt="Next chapter" href="/20.07/Acknowledgements/">Next</a>

</p>


  <div class="post-content">
    <pre class="Agda"><a id="198" class="Keyword">module</a> <a id="205" href="/20.07/Substitution/" class="Module">plfa.part2.Substitution</a> <a id="229" class="Keyword">where</a>
</pre>
<h2 id="introduction">Introduction</h2>

<p>The primary purpose of this chapter is to prove that substitution
commutes with itself. Barendgredt (1984) refers to this
as the substitution lemma:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [x:=N] [y:=L] = M [y:=L] [x:= N[y:=L] ]
</code></pre></div></div>

<p>In our setting, with de Bruijn indices for variables, the statement of
the lemma becomes:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [ N ] [ L ] ≡  M〔 L 〕[ N [ L ] ]                     (substitution)
</code></pre></div></div>

<p>where the notation <code class="language-plaintext highlighter-rouge">M 〔 L 〕</code> is for substituting L for index 1 inside
M.  In addition, because we define substitution in terms of parallel
substitution, we have the following generalization, replacing the
substitution of L with an arbitrary parallel substitution σ.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst σ (M [ N ]) ≡ (subst (exts σ) M) [ subst σ N ]    (subst-commute)
</code></pre></div></div>

<p>The special case for renamings is also useful.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (M [ N ]) ≡ (rename (ext ρ) M) [ rename ρ N ]
                                                 (rename-subst-commute)
</code></pre></div></div>

<p>The secondary purpose of this chapter is to define the σ algebra of
parallel substitution due to Abadi, Cardelli, Curien, and Levy
(1991). The equations of this algebra not only help us prove the
substitution lemma, but they are generally useful. Furthermore, when
the equations are applied from left to right, they form a rewrite
system that <em>decides</em> whether any two substitutions are equal.</p>

<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="1559" class="Keyword">import</a> <a id="1566" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1604" class="Symbol">as</a> <a id="1607" class="Module">Eq</a>
<a id="1610" class="Keyword">open</a> <a id="1615" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="1618" class="Keyword">using</a> <a id="1624" class="Symbol">(</a><a id="1625" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a><a id="1628" class="Symbol">;</a> <a id="1630" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1634" class="Symbol">;</a> <a id="1636" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a><a id="1639" class="Symbol">;</a> <a id="1641" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a><a id="1645" class="Symbol">;</a> <a id="1647" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong₂</a><a id="1652" class="Symbol">;</a> <a id="1654" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a><a id="1662" class="Symbol">)</a>
<a id="1664" class="Keyword">open</a> <a id="1669" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2499" class="Module">Eq.≡-Reasoning</a> <a id="1684" class="Keyword">using</a> <a id="1690" class="Symbol">(</a><a id="1691" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin_</a><a id="1697" class="Symbol">;</a> <a id="1699" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">_≡⟨⟩_</a><a id="1704" class="Symbol">;</a> <a id="1706" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">_≡⟨_⟩_</a><a id="1712" class="Symbol">;</a> <a id="1714" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">_∎</a><a id="1716" class="Symbol">)</a>
<a id="1718" class="Keyword">open</a> <a id="1723" class="Keyword">import</a> <a id="1730" href="https://agda.github.io/agda-stdlib/v1.1/Function.html" class="Module">Function</a> <a id="1739" class="Keyword">using</a> <a id="1745" class="Symbol">(</a><a id="1746" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">_∘_</a><a id="1749" class="Symbol">)</a>
<a id="1751" class="Keyword">open</a> <a id="1756" class="Keyword">import</a> <a id="1763" href="/20.07/Untyped/" class="Module">plfa.part2.Untyped</a>
     <a id="1787" class="Keyword">using</a> <a id="1793" class="Symbol">(</a><a id="1794" href="/20.07/Untyped/#2869" class="Datatype">Type</a><a id="1798" class="Symbol">;</a> <a id="1800" href="/20.07/Untyped/#3153" class="Datatype">Context</a><a id="1807" class="Symbol">;</a> <a id="1809" href="/20.07/Untyped/#4294" class="Datatype Operator">_⊢_</a><a id="1812" class="Symbol">;</a> <a id="1814" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="1815" class="Symbol">;</a> <a id="1817" href="/20.07/Untyped/#3521" class="Datatype Operator">_∋_</a><a id="1820" class="Symbol">;</a> <a id="1822" href="/20.07/Untyped/#3175" class="InductiveConstructor">∅</a><a id="1823" class="Symbol">;</a> <a id="1825" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">_,_</a><a id="1828" class="Symbol">;</a> <a id="1830" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="1831" class="Symbol">;</a> <a id="1833" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a><a id="1835" class="Symbol">;</a> <a id="1837" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`_</a><a id="1839" class="Symbol">;</a> <a id="1841" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a><a id="1843" class="Symbol">;</a> <a id="1845" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_·_</a><a id="1848" class="Symbol">;</a>
            <a id="1862" href="/20.07/Untyped/#6235" class="Function">rename</a><a id="1868" class="Symbol">;</a> <a id="1870" href="/20.07/Untyped/#6963" class="Function">subst</a><a id="1875" class="Symbol">;</a> <a id="1877" href="/20.07/Untyped/#5925" class="Function">ext</a><a id="1880" class="Symbol">;</a> <a id="1882" href="/20.07/Untyped/#6671" class="Function">exts</a><a id="1886" class="Symbol">;</a> <a id="1888" href="/20.07/Untyped/#7491" class="Function Operator">_[_]</a><a id="1892" class="Symbol">;</a> <a id="1894" href="/20.07/Untyped/#7375" class="Function">subst-zero</a><a id="1904" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="1915" class="Keyword">postulate</a>
  <a id="extensionality"></a><a id="1927" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="1942" class="Symbol">:</a> <a id="1944" class="Symbol">∀</a> <a id="1946" class="Symbol">{</a><a id="1947" href="/20.07/Substitution/#1947" class="Bound">A</a> <a id="1949" href="/20.07/Substitution/#1949" class="Bound">B</a> <a id="1951" class="Symbol">:</a> <a id="1953" class="PrimitiveType">Set</a><a id="1956" class="Symbol">}</a> <a id="1958" class="Symbol">{</a><a id="1959" href="/20.07/Substitution/#1959" class="Bound">f</a> <a id="1961" href="/20.07/Substitution/#1961" class="Bound">g</a> <a id="1963" class="Symbol">:</a> <a id="1965" href="/20.07/Substitution/#1947" class="Bound">A</a> <a id="1967" class="Symbol">→</a> <a id="1969" href="/20.07/Substitution/#1949" class="Bound">B</a><a id="1970" class="Symbol">}</a>
    <a id="1976" class="Symbol">→</a> <a id="1978" class="Symbol">(∀</a> <a id="1981" class="Symbol">(</a><a id="1982" href="/20.07/Substitution/#1982" class="Bound">x</a> <a id="1984" class="Symbol">:</a> <a id="1986" href="/20.07/Substitution/#1947" class="Bound">A</a><a id="1987" class="Symbol">)</a> <a id="1989" class="Symbol">→</a> <a id="1991" href="/20.07/Substitution/#1959" class="Bound">f</a> <a id="1993" href="/20.07/Substitution/#1982" class="Bound">x</a> <a id="1995" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="1997" href="/20.07/Substitution/#1961" class="Bound">g</a> <a id="1999" href="/20.07/Substitution/#1982" class="Bound">x</a><a id="2000" class="Symbol">)</a>
      <a id="2008" class="Comment">-----------------------</a>
    <a id="2036" class="Symbol">→</a> <a id="2038" href="/20.07/Substitution/#1959" class="Bound">f</a> <a id="2040" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="2042" href="/20.07/Substitution/#1961" class="Bound">g</a>
</pre>
<h2 id="notation">Notation</h2>

<p>We introduce the following shorthand for the type of a <em>renaming</em> from
variables in context <code class="language-plaintext highlighter-rouge">Γ</code> to variables in context <code class="language-plaintext highlighter-rouge">Δ</code>.</p>

<pre class="Agda"><a id="Rename"></a><a id="2192" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="2199" class="Symbol">:</a> <a id="2201" href="/20.07/Untyped/#3153" class="Datatype">Context</a> <a id="2209" class="Symbol">→</a> <a id="2211" href="/20.07/Untyped/#3153" class="Datatype">Context</a> <a id="2219" class="Symbol">→</a> <a id="2221" class="PrimitiveType">Set</a>
<a id="2225" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="2232" href="/20.07/Substitution/#2232" class="Bound">Γ</a> <a id="2234" href="/20.07/Substitution/#2234" class="Bound">Δ</a> <a id="2236" class="Symbol">=</a> <a id="2238" class="Symbol">∀{</a><a id="2240" href="/20.07/Substitution/#2240" class="Bound">A</a><a id="2241" class="Symbol">}</a> <a id="2243" class="Symbol">→</a> <a id="2245" href="/20.07/Substitution/#2232" class="Bound">Γ</a> <a id="2247" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="2249" href="/20.07/Substitution/#2240" class="Bound">A</a> <a id="2251" class="Symbol">→</a> <a id="2253" href="/20.07/Substitution/#2234" class="Bound">Δ</a> <a id="2255" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="2257" href="/20.07/Substitution/#2240" class="Bound">A</a>
</pre>
<p>Similarly, we introduce the following shorthand for the type of a
<em>substitution</em> from variables in context <code class="language-plaintext highlighter-rouge">Γ</code> to terms in context <code class="language-plaintext highlighter-rouge">Δ</code>.</p>

<pre class="Agda"><a id="Subst"></a><a id="2405" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="2411" class="Symbol">:</a> <a id="2413" href="/20.07/Untyped/#3153" class="Datatype">Context</a> <a id="2421" class="Symbol">→</a> <a id="2423" href="/20.07/Untyped/#3153" class="Datatype">Context</a> <a id="2431" class="Symbol">→</a> <a id="2433" class="PrimitiveType">Set</a>
<a id="2437" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="2443" href="/20.07/Substitution/#2443" class="Bound">Γ</a> <a id="2445" href="/20.07/Substitution/#2445" class="Bound">Δ</a> <a id="2447" class="Symbol">=</a> <a id="2449" class="Symbol">∀{</a><a id="2451" href="/20.07/Substitution/#2451" class="Bound">A</a><a id="2452" class="Symbol">}</a> <a id="2454" class="Symbol">→</a> <a id="2456" href="/20.07/Substitution/#2443" class="Bound">Γ</a> <a id="2458" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="2460" href="/20.07/Substitution/#2451" class="Bound">A</a> <a id="2462" class="Symbol">→</a> <a id="2464" href="/20.07/Substitution/#2445" class="Bound">Δ</a> <a id="2466" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="2468" href="/20.07/Substitution/#2451" class="Bound">A</a>
</pre>
<p>We use the following more succinct notation the <code class="language-plaintext highlighter-rouge">subst</code> function.</p>

<pre class="Agda"><a id="⟪_⟫"></a><a id="2546" href="/20.07/Substitution/#2546" class="Function Operator">⟪_⟫</a> <a id="2550" class="Symbol">:</a> <a id="2552" class="Symbol">∀{</a><a id="2554" href="/20.07/Substitution/#2554" class="Bound">Γ</a> <a id="2556" href="/20.07/Substitution/#2556" class="Bound">Δ</a> <a id="2558" href="/20.07/Substitution/#2558" class="Bound">A</a><a id="2559" class="Symbol">}</a> <a id="2561" class="Symbol">→</a> <a id="2563" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="2569" href="/20.07/Substitution/#2554" class="Bound">Γ</a> <a id="2571" href="/20.07/Substitution/#2556" class="Bound">Δ</a> <a id="2573" class="Symbol">→</a> <a id="2575" href="/20.07/Substitution/#2554" class="Bound">Γ</a> <a id="2577" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="2579" href="/20.07/Substitution/#2558" class="Bound">A</a> <a id="2581" class="Symbol">→</a> <a id="2583" href="/20.07/Substitution/#2556" class="Bound">Δ</a> <a id="2585" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="2587" href="/20.07/Substitution/#2558" class="Bound">A</a>
<a id="2589" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="2591" href="/20.07/Substitution/#2591" class="Bound">σ</a> <a id="2593" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="2595" class="Symbol">=</a> <a id="2597" class="Symbol">λ</a> <a id="2599" href="/20.07/Substitution/#2599" class="Bound">M</a> <a id="2601" class="Symbol">→</a> <a id="2603" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="2609" href="/20.07/Substitution/#2591" class="Bound">σ</a> <a id="2611" href="/20.07/Substitution/#2599" class="Bound">M</a>
</pre>

<h2 id="the-σ-algebra-of-substitution">The σ algebra of substitution</h2>

<p>Substitutions map de Bruijn indices (natural numbers) to terms, so we
can view a substitution simply as a sequence of terms, or more
precisely, as an infinite sequence of terms. The σ algebra consists of
four operations for building such sequences: identity <code class="language-plaintext highlighter-rouge">ids</code>, shift
<code class="language-plaintext highlighter-rouge">↑</code>, cons <code class="language-plaintext highlighter-rouge">M • σ</code>, and sequencing <code class="language-plaintext highlighter-rouge">σ ⨟ τ</code>.  The sequence <code class="language-plaintext highlighter-rouge">0, 1, 2, ...</code>
is constructed by the identity substitution.</p>

<pre class="Agda"><a id="ids"></a><a id="3046" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="3050" class="Symbol">:</a> <a id="3052" class="Symbol">∀{</a><a id="3054" href="/20.07/Substitution/#3054" class="Bound">Γ</a><a id="3055" class="Symbol">}</a> <a id="3057" class="Symbol">→</a> <a id="3059" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3065" href="/20.07/Substitution/#3054" class="Bound">Γ</a> <a id="3067" href="/20.07/Substitution/#3054" class="Bound">Γ</a>
<a id="3069" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="3073" href="/20.07/Substitution/#3073" class="Bound">x</a> <a id="3075" class="Symbol">=</a> <a id="3077" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="3079" href="/20.07/Substitution/#3073" class="Bound">x</a>
</pre>
<p>The shift operation <code class="language-plaintext highlighter-rouge">↑</code> constructs the sequence</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1, 2, 3, ...
</code></pre></div></div>

<p>and is defined as follows.</p>

<pre class="Agda"><a id="↑"></a><a id="3185" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="3187" class="Symbol">:</a> <a id="3189" class="Symbol">∀{</a><a id="3191" href="/20.07/Substitution/#3191" class="Bound">Γ</a> <a id="3193" href="/20.07/Substitution/#3193" class="Bound">A</a><a id="3194" class="Symbol">}</a> <a id="3196" class="Symbol">→</a> <a id="3198" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3204" href="/20.07/Substitution/#3191" class="Bound">Γ</a> <a id="3206" class="Symbol">(</a><a id="3207" href="/20.07/Substitution/#3191" class="Bound">Γ</a> <a id="3209" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="3211" href="/20.07/Substitution/#3193" class="Bound">A</a><a id="3212" class="Symbol">)</a>
<a id="3214" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="3216" href="/20.07/Substitution/#3216" class="Bound">x</a> <a id="3218" class="Symbol">=</a> <a id="3220" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="3222" class="Symbol">(</a><a id="3223" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="3225" href="/20.07/Substitution/#3216" class="Bound">x</a><a id="3226" class="Symbol">)</a>
</pre>
<p>Given a term <code class="language-plaintext highlighter-rouge">M</code> and substitution <code class="language-plaintext highlighter-rouge">σ</code>, the operation
<code class="language-plaintext highlighter-rouge">M • σ</code> constructs the sequence</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M , σ 0, σ 1, σ 2, ...
</code></pre></div></div>

<p>This operation is analogous to the <code class="language-plaintext highlighter-rouge">cons</code> operation of Lisp.</p>

<pre class="Agda"><a id="3413" class="Keyword">infixr</a> <a id="3420" class="Number">6</a> <a id="3422" href="/20.07/Substitution/#3427" class="Function Operator">_•_</a>

<a id="_•_"></a><a id="3427" href="/20.07/Substitution/#3427" class="Function Operator">_•_</a> <a id="3431" class="Symbol">:</a> <a id="3433" class="Symbol">∀{</a><a id="3435" href="/20.07/Substitution/#3435" class="Bound">Γ</a> <a id="3437" href="/20.07/Substitution/#3437" class="Bound">Δ</a> <a id="3439" href="/20.07/Substitution/#3439" class="Bound">A</a><a id="3440" class="Symbol">}</a> <a id="3442" class="Symbol">→</a> <a id="3444" class="Symbol">(</a><a id="3445" href="/20.07/Substitution/#3437" class="Bound">Δ</a> <a id="3447" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="3449" href="/20.07/Substitution/#3439" class="Bound">A</a><a id="3450" class="Symbol">)</a> <a id="3452" class="Symbol">→</a> <a id="3454" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3460" href="/20.07/Substitution/#3435" class="Bound">Γ</a> <a id="3462" href="/20.07/Substitution/#3437" class="Bound">Δ</a> <a id="3464" class="Symbol">→</a> <a id="3466" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3472" class="Symbol">(</a><a id="3473" href="/20.07/Substitution/#3435" class="Bound">Γ</a> <a id="3475" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="3477" href="/20.07/Substitution/#3439" class="Bound">A</a><a id="3478" class="Symbol">)</a> <a id="3480" href="/20.07/Substitution/#3437" class="Bound">Δ</a>
<a id="3482" class="Symbol">(</a><a id="3483" href="/20.07/Substitution/#3483" class="Bound">M</a> <a id="3485" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="3487" href="/20.07/Substitution/#3487" class="Bound">σ</a><a id="3488" class="Symbol">)</a> <a id="3490" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="3492" class="Symbol">=</a> <a id="3494" href="/20.07/Substitution/#3483" class="Bound">M</a>
<a id="3496" class="Symbol">(</a><a id="3497" href="/20.07/Substitution/#3497" class="Bound">M</a> <a id="3499" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="3501" href="/20.07/Substitution/#3501" class="Bound">σ</a><a id="3502" class="Symbol">)</a> <a id="3504" class="Symbol">(</a><a id="3505" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="3507" href="/20.07/Substitution/#3507" class="Bound">x</a><a id="3508" class="Symbol">)</a> <a id="3510" class="Symbol">=</a> <a id="3512" href="/20.07/Substitution/#3501" class="Bound">σ</a> <a id="3514" href="/20.07/Substitution/#3507" class="Bound">x</a>
</pre>
<p>Given two substitutions <code class="language-plaintext highlighter-rouge">σ</code> and <code class="language-plaintext highlighter-rouge">τ</code>, the sequencing operation <code class="language-plaintext highlighter-rouge">σ ⨟ τ</code>
produces the sequence</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪τ⟫(σ 0), ⟪τ⟫(σ 1), ⟪τ⟫(σ 2), ...
</code></pre></div></div>

<p>That is, it composes the two substitutions by first applying
<code class="language-plaintext highlighter-rouge">σ</code> and then applying <code class="language-plaintext highlighter-rouge">τ</code>.</p>

<pre class="Agda"><a id="3746" class="Keyword">infixr</a> <a id="3753" class="Number">5</a> <a id="3755" href="/20.07/Substitution/#3760" class="Function Operator">_⨟_</a>

<a id="_⨟_"></a><a id="3760" href="/20.07/Substitution/#3760" class="Function Operator">_⨟_</a> <a id="3764" class="Symbol">:</a> <a id="3766" class="Symbol">∀{</a><a id="3768" href="/20.07/Substitution/#3768" class="Bound">Γ</a> <a id="3770" href="/20.07/Substitution/#3770" class="Bound">Δ</a> <a id="3772" href="/20.07/Substitution/#3772" class="Bound">Σ</a><a id="3773" class="Symbol">}</a> <a id="3775" class="Symbol">→</a> <a id="3777" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3783" href="/20.07/Substitution/#3768" class="Bound">Γ</a> <a id="3785" href="/20.07/Substitution/#3770" class="Bound">Δ</a> <a id="3787" class="Symbol">→</a> <a id="3789" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3795" href="/20.07/Substitution/#3770" class="Bound">Δ</a> <a id="3797" href="/20.07/Substitution/#3772" class="Bound">Σ</a> <a id="3799" class="Symbol">→</a> <a id="3801" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="3807" href="/20.07/Substitution/#3768" class="Bound">Γ</a> <a id="3809" href="/20.07/Substitution/#3772" class="Bound">Σ</a>
<a id="3811" href="/20.07/Substitution/#3811" class="Bound">σ</a> <a id="3813" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="3815" href="/20.07/Substitution/#3815" class="Bound">τ</a> <a id="3817" class="Symbol">=</a> <a id="3819" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="3821" href="/20.07/Substitution/#3815" class="Bound">τ</a> <a id="3823" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="3825" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="3827" href="/20.07/Substitution/#3811" class="Bound">σ</a>
</pre>
<p>For the sequencing operation, Abadi et al. use the notation of
function composition, writing <code class="language-plaintext highlighter-rouge">σ ∘ τ</code>, but still with <code class="language-plaintext highlighter-rouge">σ</code> applied
before <code class="language-plaintext highlighter-rouge">τ</code>, which is the opposite of standard mathematical
practice. We instead write <code class="language-plaintext highlighter-rouge">σ ⨟ τ</code>, because semicolon is
the standard notation for forward function composition.</p>

<h2 id="the-σ-algebra-equations">The σ algebra equations</h2>

<p>The σ algebra includes the following equations.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(sub-head)  ⟪ M • σ ⟫ (` Z) ≡ M
(sub-tail)  ↑ ⨟ (M • σ)    ≡ σ
(sub-η)     (⟪ σ ⟫ (` Z)) • (↑ ⨟ σ) ≡ σ
(Z-shift)   (` Z) • ↑      ≡ ids

(sub-id)    ⟪ ids ⟫ M      ≡ M
(sub-app)   ⟪ σ ⟫ (L · M)  ≡ (⟪ σ ⟫ L) · (⟪ σ ⟫ M)
(sub-abs)   ⟪ σ ⟫ (ƛ N)    ≡ ƛ ⟪ σ ⟫ N
(sub-sub)   ⟪ τ ⟫ ⟪ σ ⟫ M  ≡ ⟪ σ ⨟ τ ⟫ M

(sub-idL)   ids ⨟ σ        ≡ σ
(sub-idR)   σ ⨟ ids        ≡ σ
(sub-assoc) (σ ⨟ τ) ⨟ θ    ≡ σ ⨟ (τ ⨟ θ)
(sub-dist)  (M • σ) ⨟ τ    ≡ (⟪ τ ⟫ M) • (σ ⨟ τ)
</code></pre></div></div>

<p>The first group of equations describe how the <code class="language-plaintext highlighter-rouge">•</code> operator acts like cons.
The equation <code class="language-plaintext highlighter-rouge">sub-head</code> says that the variable zero <code class="language-plaintext highlighter-rouge">Z</code> returns the
head of the sequence (it acts like the <code class="language-plaintext highlighter-rouge">car</code> of Lisp).  Similarly,
<code class="language-plaintext highlighter-rouge">sub-tail</code> says that sequencing with shift <code class="language-plaintext highlighter-rouge">↑</code> returns the tail of the
sequence (it acts like <code class="language-plaintext highlighter-rouge">cdr</code> of Lisp).  The <code class="language-plaintext highlighter-rouge">sub-η</code> equation is the
η-expansion rule for sequences, saying that taking the head and tail
of a sequence, and then cons’ing them together yields the original
sequence. The <code class="language-plaintext highlighter-rouge">Z-shift</code> equation says that cons’ing zero onto the
shifted sequence produces the identity sequence.</p>

<p>The next four equations involve applying substitutions to terms.  The
equation <code class="language-plaintext highlighter-rouge">sub-id</code> says that the identity substitution returns the term
unchanged. The equations <code class="language-plaintext highlighter-rouge">sub-app</code> and <code class="language-plaintext highlighter-rouge">sub-abs</code> says that
substitution is a congruence for the lambda calculus. The <code class="language-plaintext highlighter-rouge">sub-sub</code>
equation says that the sequence operator <code class="language-plaintext highlighter-rouge">⨟</code> behaves as intended.</p>

<p>The last four equations concern the sequencing of substitutions.
The first two equations, <code class="language-plaintext highlighter-rouge">sub-idL</code> and <code class="language-plaintext highlighter-rouge">sub-idR</code>, say that
<code class="language-plaintext highlighter-rouge">ids</code> is the left and right unit of the sequencing operator.
The <code class="language-plaintext highlighter-rouge">sub-assoc</code> equation says that sequencing is associative.
Finally, <code class="language-plaintext highlighter-rouge">sub-dist</code> says that post-sequencing distributes through cons.</p>

<h2 id="relating-the-σ-algebra-and-substitution-functions">Relating the σ algebra and substitution functions</h2>

<p>The definitions of substitution <code class="language-plaintext highlighter-rouge">N [ M ]</code> and parallel substitution
<code class="language-plaintext highlighter-rouge">subst σ N</code> depend on several auxiliary functions: <code class="language-plaintext highlighter-rouge">rename</code>, <code class="language-plaintext highlighter-rouge">exts</code>,
<code class="language-plaintext highlighter-rouge">ext</code>, and <code class="language-plaintext highlighter-rouge">subst-zero</code>. We shall relate those functions to terms in
the σ algebra.</p>

<p>To begin with, renaming can be expressed in terms of substitution.
We have</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⟪ ren ρ ⟫ M               (rename-subst-ren)
</code></pre></div></div>

<p>where <code class="language-plaintext highlighter-rouge">ren</code> turns a renaming <code class="language-plaintext highlighter-rouge">ρ</code> into a substitution by post-composing
<code class="language-plaintext highlighter-rouge">ρ</code> with the identity substitution.</p>

<pre class="Agda"><a id="ren"></a><a id="6498" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="6502" class="Symbol">:</a> <a id="6504" class="Symbol">∀{</a><a id="6506" href="/20.07/Substitution/#6506" class="Bound">Γ</a> <a id="6508" href="/20.07/Substitution/#6508" class="Bound">Δ</a><a id="6509" class="Symbol">}</a> <a id="6511" class="Symbol">→</a> <a id="6513" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="6520" href="/20.07/Substitution/#6506" class="Bound">Γ</a> <a id="6522" href="/20.07/Substitution/#6508" class="Bound">Δ</a> <a id="6524" class="Symbol">→</a> <a id="6526" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="6532" href="/20.07/Substitution/#6506" class="Bound">Γ</a> <a id="6534" href="/20.07/Substitution/#6508" class="Bound">Δ</a>
<a id="6536" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="6540" href="/20.07/Substitution/#6540" class="Bound">ρ</a> <a id="6542" class="Symbol">=</a> <a id="6544" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="6548" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="6550" href="/20.07/Substitution/#6540" class="Bound">ρ</a>
</pre>
<p>When the renaming is the increment function, then it is equivalent to
shift.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren S_ ≡ ↑                             (ren-shift)

rename S_ M ≡ ⟪ ↑ ⟫ M                  (rename-shift)
</code></pre></div></div>

<p>Renaming with the identity renaming leaves the term unchanged.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename (λ {A} x → x) M ≡ M             (rename-id)
</code></pre></div></div>

<p>Next we relate the <code class="language-plaintext highlighter-rouge">exts</code> function to the σ algebra.  Recall that the
<code class="language-plaintext highlighter-rouge">exts</code> function extends a substitution as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ = ` Z, rename S_ (σ 0), rename S_ (σ 1), rename S_ (σ 2), ...
</code></pre></div></div>

<p>So <code class="language-plaintext highlighter-rouge">exts</code> is equivalent to cons’ing Z onto the sequence formed
by applying <code class="language-plaintext highlighter-rouge">σ</code> and then shifting.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ≡ ` Z • (σ ⨟ ↑)                (exts-cons-shift)
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">ext</code> function does the same job as <code class="language-plaintext highlighter-rouge">exts</code> but for renamings
instead of substitutions. So composing <code class="language-plaintext highlighter-rouge">ext</code> with <code class="language-plaintext highlighter-rouge">ren</code> is the same as
composing <code class="language-plaintext highlighter-rouge">ren</code> with <code class="language-plaintext highlighter-rouge">exts</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ exts (ren ρ)            (ren-ext)
</code></pre></div></div>

<p>Thus, we can recast the <code class="language-plaintext highlighter-rouge">exts-cons-shift</code> equation in terms of
renamings.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ ` Z • (ren ρ ⨟ ↑)       (ext-cons-Z-shift)
</code></pre></div></div>

<p>It is also useful to specialize the <code class="language-plaintext highlighter-rouge">sub-sub</code> equation of the σ
algebra to the situation where the first substitution is a renaming.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ σ ⟫ (rename ρ M) ≡ ⟪ σ ∘ ρ ⟫ M       (rename-subst)
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing
<code class="language-plaintext highlighter-rouge">M</code> onto the identity substitution.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst-zero M ≡ M • ids                (subst-Z-cons-ids)
</code></pre></div></div>

<p>Finally, sequencing <code class="language-plaintext highlighter-rouge">exts σ</code> with <code class="language-plaintext highlighter-rouge">subst-zero M</code> is equivalent to
cons’ing <code class="language-plaintext highlighter-rouge">M</code> onto <code class="language-plaintext highlighter-rouge">σ</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ⨟ subst-zero M ≡ (M • σ)       (subst-zero-exts-cons)
</code></pre></div></div>

<h2 id="proofs-of-sub-head-sub-tail-sub-η-z-shift-sub-idl-sub-dist-and-sub-app">Proofs of sub-head, sub-tail, sub-η, Z-shift, sub-idL, sub-dist, and sub-app</h2>

<p>We start with the proofs that are immediate from the definitions of
the operators.</p>

<pre class="Agda"><a id="sub-head"></a><a id="8259" href="/20.07/Substitution/#8259" class="Function">sub-head</a> <a id="8268" class="Symbol">:</a> <a id="8270" class="Symbol">∀</a> <a id="8272" class="Symbol">{</a><a id="8273" href="/20.07/Substitution/#8273" class="Bound">Γ</a> <a id="8275" href="/20.07/Substitution/#8275" class="Bound">Δ</a><a id="8276" class="Symbol">}</a> <a id="8278" class="Symbol">{</a><a id="8279" href="/20.07/Substitution/#8279" class="Bound">A</a><a id="8280" class="Symbol">}</a> <a id="8282" class="Symbol">{</a><a id="8283" href="/20.07/Substitution/#8283" class="Bound">M</a> <a id="8285" class="Symbol">:</a> <a id="8287" href="/20.07/Substitution/#8275" class="Bound">Δ</a> <a id="8289" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="8291" href="/20.07/Substitution/#8279" class="Bound">A</a><a id="8292" class="Symbol">}{</a><a id="8294" href="/20.07/Substitution/#8294" class="Bound">σ</a> <a id="8296" class="Symbol">:</a> <a id="8298" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="8304" href="/20.07/Substitution/#8273" class="Bound">Γ</a> <a id="8306" href="/20.07/Substitution/#8275" class="Bound">Δ</a><a id="8307" class="Symbol">}</a>
         <a id="8318" class="Symbol">→</a> <a id="8320" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="8322" href="/20.07/Substitution/#8283" class="Bound">M</a> <a id="8324" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="8326" href="/20.07/Substitution/#8294" class="Bound">σ</a> <a id="8328" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="8330" class="Symbol">(</a><a id="8331" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="8333" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="8334" class="Symbol">)</a> <a id="8336" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="8338" href="/20.07/Substitution/#8283" class="Bound">M</a>
<a id="8340" href="/20.07/Substitution/#8259" class="Function">sub-head</a> <a id="8349" class="Symbol">=</a> <a id="8351" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<pre class="Agda"><a id="sub-tail"></a><a id="8365" href="/20.07/Substitution/#8365" class="Function">sub-tail</a> <a id="8374" class="Symbol">:</a> <a id="8376" class="Symbol">∀{</a><a id="8378" href="/20.07/Substitution/#8378" class="Bound">Γ</a> <a id="8380" href="/20.07/Substitution/#8380" class="Bound">Δ</a><a id="8381" class="Symbol">}</a> <a id="8383" class="Symbol">{</a><a id="8384" href="/20.07/Substitution/#8384" class="Bound">A</a> <a id="8386" href="/20.07/Substitution/#8386" class="Bound">B</a><a id="8387" class="Symbol">}</a> <a id="8389" class="Symbol">{</a><a id="8390" href="/20.07/Substitution/#8390" class="Bound">M</a> <a id="8392" class="Symbol">:</a> <a id="8394" href="/20.07/Substitution/#8380" class="Bound">Δ</a> <a id="8396" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="8398" href="/20.07/Substitution/#8384" class="Bound">A</a><a id="8399" class="Symbol">}</a> <a id="8401" class="Symbol">{</a><a id="8402" href="/20.07/Substitution/#8402" class="Bound">σ</a> <a id="8404" class="Symbol">:</a> <a id="8406" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="8412" href="/20.07/Substitution/#8378" class="Bound">Γ</a> <a id="8414" href="/20.07/Substitution/#8380" class="Bound">Δ</a><a id="8415" class="Symbol">}</a>
         <a id="8426" class="Symbol">→</a> <a id="8428" class="Symbol">(</a><a id="8429" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="8431" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="8433" href="/20.07/Substitution/#8390" class="Bound">M</a> <a id="8435" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="8437" href="/20.07/Substitution/#8402" class="Bound">σ</a><a id="8438" class="Symbol">)</a> <a id="8440" class="Symbol">{</a><a id="8441" class="Argument">A</a> <a id="8443" class="Symbol">=</a> <a id="8445" href="/20.07/Substitution/#8386" class="Bound">B</a><a id="8446" class="Symbol">}</a> <a id="8448" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="8450" href="/20.07/Substitution/#8402" class="Bound">σ</a>
<a id="8452" href="/20.07/Substitution/#8365" class="Function">sub-tail</a> <a id="8461" class="Symbol">=</a> <a id="8463" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="8478" class="Symbol">λ</a> <a id="8480" href="/20.07/Substitution/#8480" class="Bound">x</a> <a id="8482" class="Symbol">→</a> <a id="8484" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<pre class="Agda"><a id="sub-η"></a><a id="8498" href="/20.07/Substitution/#8498" class="Function">sub-η</a> <a id="8504" class="Symbol">:</a> <a id="8506" class="Symbol">∀{</a><a id="8508" href="/20.07/Substitution/#8508" class="Bound">Γ</a> <a id="8510" href="/20.07/Substitution/#8510" class="Bound">Δ</a><a id="8511" class="Symbol">}</a> <a id="8513" class="Symbol">{</a><a id="8514" href="/20.07/Substitution/#8514" class="Bound">A</a> <a id="8516" href="/20.07/Substitution/#8516" class="Bound">B</a><a id="8517" class="Symbol">}</a> <a id="8519" class="Symbol">{</a><a id="8520" href="/20.07/Substitution/#8520" class="Bound">σ</a> <a id="8522" class="Symbol">:</a> <a id="8524" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="8530" class="Symbol">(</a><a id="8531" href="/20.07/Substitution/#8508" class="Bound">Γ</a> <a id="8533" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="8535" href="/20.07/Substitution/#8514" class="Bound">A</a><a id="8536" class="Symbol">)</a> <a id="8538" href="/20.07/Substitution/#8510" class="Bound">Δ</a><a id="8539" class="Symbol">}</a>
      <a id="8547" class="Symbol">→</a> <a id="8549" class="Symbol">(</a><a id="8550" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="8552" href="/20.07/Substitution/#8520" class="Bound">σ</a> <a id="8554" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="8556" class="Symbol">(</a><a id="8557" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="8559" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="8560" class="Symbol">)</a> <a id="8562" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="8564" class="Symbol">(</a><a id="8565" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="8567" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="8569" href="/20.07/Substitution/#8520" class="Bound">σ</a><a id="8570" class="Symbol">))</a> <a id="8573" class="Symbol">{</a><a id="8574" class="Argument">A</a> <a id="8576" class="Symbol">=</a> <a id="8578" href="/20.07/Substitution/#8516" class="Bound">B</a><a id="8579" class="Symbol">}</a> <a id="8581" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="8583" href="/20.07/Substitution/#8520" class="Bound">σ</a>
<a id="8585" href="/20.07/Substitution/#8498" class="Function">sub-η</a> <a id="8591" class="Symbol">{</a><a id="8592" href="/20.07/Substitution/#8592" class="Bound">Γ</a><a id="8593" class="Symbol">}{</a><a id="8595" href="/20.07/Substitution/#8595" class="Bound">Δ</a><a id="8596" class="Symbol">}{</a><a id="8598" href="/20.07/Substitution/#8598" class="Bound">A</a><a id="8599" class="Symbol">}{</a><a id="8601" href="/20.07/Substitution/#8601" class="Bound">B</a><a id="8602" class="Symbol">}{</a><a id="8604" href="/20.07/Substitution/#8604" class="Bound">σ</a><a id="8605" class="Symbol">}</a> <a id="8607" class="Symbol">=</a> <a id="8609" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="8624" class="Symbol">λ</a> <a id="8626" href="/20.07/Substitution/#8626" class="Bound">x</a> <a id="8628" class="Symbol">→</a> <a id="8630" href="/20.07/Substitution/#8648" class="Function">lemma</a>
   <a id="8639" class="Keyword">where</a>
   <a id="8648" href="/20.07/Substitution/#8648" class="Function">lemma</a> <a id="8654" class="Symbol">:</a> <a id="8656" class="Symbol">∀</a> <a id="8658" class="Symbol">{</a><a id="8659" href="/20.07/Substitution/#8659" class="Bound">x</a><a id="8660" class="Symbol">}</a> <a id="8662" class="Symbol">→</a> <a id="8664" class="Symbol">((</a><a id="8666" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="8668" href="/20.07/Substitution/#8604" class="Bound">σ</a> <a id="8670" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="8672" class="Symbol">(</a><a id="8673" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="8675" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="8676" class="Symbol">))</a> <a id="8679" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="8681" class="Symbol">(</a><a id="8682" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="8684" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="8686" href="/20.07/Substitution/#8604" class="Bound">σ</a><a id="8687" class="Symbol">))</a> <a id="8690" href="/20.07/Substitution/#8659" class="Bound">x</a> <a id="8692" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="8694" href="/20.07/Substitution/#8604" class="Bound">σ</a> <a id="8696" href="/20.07/Substitution/#8659" class="Bound">x</a>
   <a id="8701" href="/20.07/Substitution/#8648" class="Function">lemma</a> <a id="8707" class="Symbol">{</a><a id="8708" class="Argument">x</a> <a id="8710" class="Symbol">=</a> <a id="8712" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="8713" class="Symbol">}</a> <a id="8715" class="Symbol">=</a> <a id="8717" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
   <a id="8725" href="/20.07/Substitution/#8648" class="Function">lemma</a> <a id="8731" class="Symbol">{</a><a id="8732" class="Argument">x</a> <a id="8734" class="Symbol">=</a> <a id="8736" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="8738" href="/20.07/Substitution/#8738" class="Bound">x</a><a id="8739" class="Symbol">}</a> <a id="8741" class="Symbol">=</a> <a id="8743" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<pre class="Agda"><a id="Z-shift"></a><a id="8757" href="/20.07/Substitution/#8757" class="Function">Z-shift</a> <a id="8765" class="Symbol">:</a> <a id="8767" class="Symbol">∀{</a><a id="8769" href="/20.07/Substitution/#8769" class="Bound">Γ</a><a id="8770" class="Symbol">}{</a><a id="8772" href="/20.07/Substitution/#8772" class="Bound">A</a> <a id="8774" href="/20.07/Substitution/#8774" class="Bound">B</a><a id="8775" class="Symbol">}</a>
        <a id="8785" class="Symbol">→</a> <a id="8787" class="Symbol">((</a><a id="8789" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="8791" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="8792" class="Symbol">)</a> <a id="8794" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="8796" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="8797" class="Symbol">)</a> <a id="8799" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="8801" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="8805" class="Symbol">{</a><a id="8806" href="/20.07/Substitution/#8769" class="Bound">Γ</a> <a id="8808" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="8810" href="/20.07/Substitution/#8772" class="Bound">A</a><a id="8811" class="Symbol">}</a> <a id="8813" class="Symbol">{</a><a id="8814" href="/20.07/Substitution/#8774" class="Bound">B</a><a id="8815" class="Symbol">}</a>
<a id="8817" href="/20.07/Substitution/#8757" class="Function">Z-shift</a> <a id="8825" class="Symbol">{</a><a id="8826" href="/20.07/Substitution/#8826" class="Bound">Γ</a><a id="8827" class="Symbol">}{</a><a id="8829" href="/20.07/Substitution/#8829" class="Bound">A</a><a id="8830" class="Symbol">}{</a><a id="8832" href="/20.07/Substitution/#8832" class="Bound">B</a><a id="8833" class="Symbol">}</a> <a id="8835" class="Symbol">=</a> <a id="8837" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="8852" href="/20.07/Substitution/#8870" class="Function">lemma</a>
   <a id="8861" class="Keyword">where</a>
   <a id="8870" href="/20.07/Substitution/#8870" class="Function">lemma</a> <a id="8876" class="Symbol">:</a> <a id="8878" class="Symbol">(</a><a id="8879" href="/20.07/Substitution/#8879" class="Bound">x</a> <a id="8881" class="Symbol">:</a> <a id="8883" href="/20.07/Substitution/#8826" class="Bound">Γ</a> <a id="8885" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="8887" href="/20.07/Substitution/#8829" class="Bound">A</a> <a id="8889" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="8891" href="/20.07/Substitution/#8832" class="Bound">B</a><a id="8892" class="Symbol">)</a> <a id="8894" class="Symbol">→</a> <a id="8896" class="Symbol">((</a><a id="8898" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="8900" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="8901" class="Symbol">)</a> <a id="8903" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="8905" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="8906" class="Symbol">)</a> <a id="8908" href="/20.07/Substitution/#8879" class="Bound">x</a> <a id="8910" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="8912" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="8916" href="/20.07/Substitution/#8879" class="Bound">x</a>
   <a id="8921" href="/20.07/Substitution/#8870" class="Function">lemma</a> <a id="8927" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="8929" class="Symbol">=</a> <a id="8931" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
   <a id="8939" href="/20.07/Substitution/#8870" class="Function">lemma</a> <a id="8945" class="Symbol">(</a><a id="8946" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="8948" href="/20.07/Substitution/#8948" class="Bound">y</a><a id="8949" class="Symbol">)</a> <a id="8951" class="Symbol">=</a> <a id="8953" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<pre class="Agda"><a id="sub-idL"></a><a id="8967" href="/20.07/Substitution/#8967" class="Function">sub-idL</a> <a id="8975" class="Symbol">:</a> <a id="8977" class="Symbol">∀{</a><a id="8979" href="/20.07/Substitution/#8979" class="Bound">Γ</a> <a id="8981" href="/20.07/Substitution/#8981" class="Bound">Δ</a><a id="8982" class="Symbol">}</a> <a id="8984" class="Symbol">{</a><a id="8985" href="/20.07/Substitution/#8985" class="Bound">σ</a> <a id="8987" class="Symbol">:</a> <a id="8989" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="8995" href="/20.07/Substitution/#8979" class="Bound">Γ</a> <a id="8997" href="/20.07/Substitution/#8981" class="Bound">Δ</a><a id="8998" class="Symbol">}</a> <a id="9000" class="Symbol">{</a><a id="9001" href="/20.07/Substitution/#9001" class="Bound">A</a><a id="9002" class="Symbol">}</a>
       <a id="9011" class="Symbol">→</a> <a id="9013" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="9017" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="9019" href="/20.07/Substitution/#8985" class="Bound">σ</a> <a id="9021" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="9023" href="/20.07/Substitution/#8985" class="Bound">σ</a> <a id="9025" class="Symbol">{</a><a id="9026" href="/20.07/Substitution/#9001" class="Bound">A</a><a id="9027" class="Symbol">}</a>
<a id="9029" href="/20.07/Substitution/#8967" class="Function">sub-idL</a> <a id="9037" class="Symbol">=</a> <a id="9039" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="9054" class="Symbol">λ</a> <a id="9056" href="/20.07/Substitution/#9056" class="Bound">x</a> <a id="9058" class="Symbol">→</a> <a id="9060" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<pre class="Agda"><a id="sub-dist"></a><a id="9074" href="/20.07/Substitution/#9074" class="Function">sub-dist</a> <a id="9083" class="Symbol">:</a>  <a id="9086" class="Symbol">∀{</a><a id="9088" href="/20.07/Substitution/#9088" class="Bound">Γ</a> <a id="9090" href="/20.07/Substitution/#9090" class="Bound">Δ</a> <a id="9092" href="/20.07/Substitution/#9092" class="Bound">Σ</a> <a id="9094" class="Symbol">:</a> <a id="9096" href="/20.07/Untyped/#3153" class="Datatype">Context</a><a id="9103" class="Symbol">}</a> <a id="9105" class="Symbol">{</a><a id="9106" href="/20.07/Substitution/#9106" class="Bound">A</a> <a id="9108" href="/20.07/Substitution/#9108" class="Bound">B</a><a id="9109" class="Symbol">}</a> <a id="9111" class="Symbol">{</a><a id="9112" href="/20.07/Substitution/#9112" class="Bound">σ</a> <a id="9114" class="Symbol">:</a> <a id="9116" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="9122" href="/20.07/Substitution/#9088" class="Bound">Γ</a> <a id="9124" href="/20.07/Substitution/#9090" class="Bound">Δ</a><a id="9125" class="Symbol">}</a> <a id="9127" class="Symbol">{</a><a id="9128" href="/20.07/Substitution/#9128" class="Bound">τ</a> <a id="9130" class="Symbol">:</a> <a id="9132" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="9138" href="/20.07/Substitution/#9090" class="Bound">Δ</a> <a id="9140" href="/20.07/Substitution/#9092" class="Bound">Σ</a><a id="9141" class="Symbol">}</a>
              <a id="9157" class="Symbol">{</a><a id="9158" href="/20.07/Substitution/#9158" class="Bound">M</a> <a id="9160" class="Symbol">:</a> <a id="9162" href="/20.07/Substitution/#9090" class="Bound">Δ</a> <a id="9164" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="9166" href="/20.07/Substitution/#9106" class="Bound">A</a><a id="9167" class="Symbol">}</a>
         <a id="9178" class="Symbol">→</a> <a id="9180" class="Symbol">((</a><a id="9182" href="/20.07/Substitution/#9158" class="Bound">M</a> <a id="9184" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="9186" href="/20.07/Substitution/#9112" class="Bound">σ</a><a id="9187" class="Symbol">)</a> <a id="9189" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="9191" href="/20.07/Substitution/#9128" class="Bound">τ</a><a id="9192" class="Symbol">)</a> <a id="9194" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="9196" class="Symbol">((</a><a id="9198" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="9204" href="/20.07/Substitution/#9128" class="Bound">τ</a> <a id="9206" href="/20.07/Substitution/#9158" class="Bound">M</a><a id="9207" class="Symbol">)</a> <a id="9209" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="9211" class="Symbol">(</a><a id="9212" href="/20.07/Substitution/#9112" class="Bound">σ</a> <a id="9214" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="9216" href="/20.07/Substitution/#9128" class="Bound">τ</a><a id="9217" class="Symbol">))</a> <a id="9220" class="Symbol">{</a><a id="9221" href="/20.07/Substitution/#9108" class="Bound">B</a><a id="9222" class="Symbol">}</a>
<a id="9224" href="/20.07/Substitution/#9074" class="Function">sub-dist</a> <a id="9233" class="Symbol">{</a><a id="9234" href="/20.07/Substitution/#9234" class="Bound">Γ</a><a id="9235" class="Symbol">}{</a><a id="9237" href="/20.07/Substitution/#9237" class="Bound">Δ</a><a id="9238" class="Symbol">}{</a><a id="9240" href="/20.07/Substitution/#9240" class="Bound">Σ</a><a id="9241" class="Symbol">}{</a><a id="9243" href="/20.07/Substitution/#9243" class="Bound">A</a><a id="9244" class="Symbol">}{</a><a id="9246" href="/20.07/Substitution/#9246" class="Bound">B</a><a id="9247" class="Symbol">}{</a><a id="9249" href="/20.07/Substitution/#9249" class="Bound">σ</a><a id="9250" class="Symbol">}{</a><a id="9252" href="/20.07/Substitution/#9252" class="Bound">τ</a><a id="9253" class="Symbol">}{</a><a id="9255" href="/20.07/Substitution/#9255" class="Bound">M</a><a id="9256" class="Symbol">}</a> <a id="9258" class="Symbol">=</a> <a id="9260" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="9275" class="Symbol">λ</a> <a id="9277" href="/20.07/Substitution/#9277" class="Bound">x</a> <a id="9279" class="Symbol">→</a> <a id="9281" href="/20.07/Substitution/#9305" class="Function">lemma</a> <a id="9287" class="Symbol">{</a><a id="9288" class="Argument">x</a> <a id="9290" class="Symbol">=</a> <a id="9292" href="/20.07/Substitution/#9277" class="Bound">x</a><a id="9293" class="Symbol">}</a>
  <a id="9297" class="Keyword">where</a>
  <a id="9305" href="/20.07/Substitution/#9305" class="Function">lemma</a> <a id="9311" class="Symbol">:</a> <a id="9313" class="Symbol">∀</a> <a id="9315" class="Symbol">{</a><a id="9316" href="/20.07/Substitution/#9316" class="Bound">x</a> <a id="9318" class="Symbol">:</a> <a id="9320" href="/20.07/Substitution/#9234" class="Bound">Γ</a> <a id="9322" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="9324" href="/20.07/Substitution/#9243" class="Bound">A</a> <a id="9326" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="9328" href="/20.07/Substitution/#9246" class="Bound">B</a><a id="9329" class="Symbol">}</a> <a id="9331" class="Symbol">→</a> <a id="9333" class="Symbol">((</a><a id="9335" href="/20.07/Substitution/#9255" class="Bound">M</a> <a id="9337" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="9339" href="/20.07/Substitution/#9249" class="Bound">σ</a><a id="9340" class="Symbol">)</a> <a id="9342" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="9344" href="/20.07/Substitution/#9252" class="Bound">τ</a><a id="9345" class="Symbol">)</a> <a id="9347" href="/20.07/Substitution/#9316" class="Bound">x</a> <a id="9349" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="9351" class="Symbol">((</a><a id="9353" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="9359" href="/20.07/Substitution/#9252" class="Bound">τ</a> <a id="9361" href="/20.07/Substitution/#9255" class="Bound">M</a><a id="9362" class="Symbol">)</a> <a id="9364" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="9366" class="Symbol">(</a><a id="9367" href="/20.07/Substitution/#9249" class="Bound">σ</a> <a id="9369" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="9371" href="/20.07/Substitution/#9252" class="Bound">τ</a><a id="9372" class="Symbol">))</a> <a id="9375" href="/20.07/Substitution/#9316" class="Bound">x</a>
  <a id="9379" href="/20.07/Substitution/#9305" class="Function">lemma</a> <a id="9385" class="Symbol">{</a><a id="9386" class="Argument">x</a> <a id="9388" class="Symbol">=</a> <a id="9390" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="9391" class="Symbol">}</a> <a id="9393" class="Symbol">=</a> <a id="9395" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="9402" href="/20.07/Substitution/#9305" class="Function">lemma</a> <a id="9408" class="Symbol">{</a><a id="9409" class="Argument">x</a> <a id="9411" class="Symbol">=</a> <a id="9413" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="9415" href="/20.07/Substitution/#9415" class="Bound">x</a><a id="9416" class="Symbol">}</a> <a id="9418" class="Symbol">=</a> <a id="9420" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<pre class="Agda"><a id="sub-app"></a><a id="9434" href="/20.07/Substitution/#9434" class="Function">sub-app</a> <a id="9442" class="Symbol">:</a> <a id="9444" class="Symbol">∀{</a><a id="9446" href="/20.07/Substitution/#9446" class="Bound">Γ</a> <a id="9448" href="/20.07/Substitution/#9448" class="Bound">Δ</a><a id="9449" class="Symbol">}</a> <a id="9451" class="Symbol">{</a><a id="9452" href="/20.07/Substitution/#9452" class="Bound">σ</a> <a id="9454" class="Symbol">:</a> <a id="9456" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="9462" href="/20.07/Substitution/#9446" class="Bound">Γ</a> <a id="9464" href="/20.07/Substitution/#9448" class="Bound">Δ</a><a id="9465" class="Symbol">}</a> <a id="9467" class="Symbol">{</a><a id="9468" href="/20.07/Substitution/#9468" class="Bound">L</a> <a id="9470" class="Symbol">:</a> <a id="9472" href="/20.07/Substitution/#9446" class="Bound">Γ</a> <a id="9474" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="9476" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="9477" class="Symbol">}{</a><a id="9479" href="/20.07/Substitution/#9479" class="Bound">M</a> <a id="9481" class="Symbol">:</a> <a id="9483" href="/20.07/Substitution/#9446" class="Bound">Γ</a> <a id="9485" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="9487" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="9488" class="Symbol">}</a>
        <a id="9498" class="Symbol">→</a> <a id="9500" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="9502" href="/20.07/Substitution/#9452" class="Bound">σ</a> <a id="9504" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="9506" class="Symbol">(</a><a id="9507" href="/20.07/Substitution/#9468" class="Bound">L</a> <a id="9509" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="9511" href="/20.07/Substitution/#9479" class="Bound">M</a><a id="9512" class="Symbol">)</a>  <a id="9515" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="9517" class="Symbol">(</a><a id="9518" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="9520" href="/20.07/Substitution/#9452" class="Bound">σ</a> <a id="9522" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="9524" href="/20.07/Substitution/#9468" class="Bound">L</a><a id="9525" class="Symbol">)</a> <a id="9527" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="9529" class="Symbol">(</a><a id="9530" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="9532" href="/20.07/Substitution/#9452" class="Bound">σ</a> <a id="9534" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="9536" href="/20.07/Substitution/#9479" class="Bound">M</a><a id="9537" class="Symbol">)</a>
<a id="9539" href="/20.07/Substitution/#9434" class="Function">sub-app</a> <a id="9547" class="Symbol">=</a> <a id="9549" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>

<h2 id="interlude-congruences">Interlude: congruences</h2>

<p>In this section we establish congruence rules for the σ algebra
operators <code class="language-plaintext highlighter-rouge">•</code> and <code class="language-plaintext highlighter-rouge">⨟</code> and for <code class="language-plaintext highlighter-rouge">subst</code> and its helper functions <code class="language-plaintext highlighter-rouge">ext</code>,
<code class="language-plaintext highlighter-rouge">rename</code>, <code class="language-plaintext highlighter-rouge">exts</code>, and <code class="language-plaintext highlighter-rouge">subst-zero</code>. These congruence rules help with
the equational reasoning in the later sections of this chapter.</p>

<p>[JGS: I would have liked to prove all of these via cong and cong₂,
 but I have not yet found a way to make that work. It seems that
 various implicit parameters get in the way.]</p>

<pre class="Agda"><a id="cong-ext"></a><a id="10038" href="/20.07/Substitution/#10038" class="Function">cong-ext</a> <a id="10047" class="Symbol">:</a> <a id="10049" class="Symbol">∀{</a><a id="10051" href="/20.07/Substitution/#10051" class="Bound">Γ</a> <a id="10053" href="/20.07/Substitution/#10053" class="Bound">Δ</a><a id="10054" class="Symbol">}{</a><a id="10056" href="/20.07/Substitution/#10056" class="Bound">ρ</a> <a id="10058" href="/20.07/Substitution/#10058" class="Bound">ρ′</a> <a id="10061" class="Symbol">:</a> <a id="10063" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="10070" href="/20.07/Substitution/#10051" class="Bound">Γ</a> <a id="10072" href="/20.07/Substitution/#10053" class="Bound">Δ</a><a id="10073" class="Symbol">}{</a><a id="10075" href="/20.07/Substitution/#10075" class="Bound">B</a><a id="10076" class="Symbol">}</a>
   <a id="10081" class="Symbol">→</a> <a id="10083" class="Symbol">(∀{</a><a id="10086" href="/20.07/Substitution/#10086" class="Bound">A</a><a id="10087" class="Symbol">}</a> <a id="10089" class="Symbol">→</a> <a id="10091" href="/20.07/Substitution/#10056" class="Bound">ρ</a> <a id="10093" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="10095" href="/20.07/Substitution/#10058" class="Bound">ρ′</a> <a id="10098" class="Symbol">{</a><a id="10099" href="/20.07/Substitution/#10086" class="Bound">A</a><a id="10100" class="Symbol">})</a>
     <a id="10108" class="Comment">---------------------------------</a>
   <a id="10145" class="Symbol">→</a> <a id="10147" class="Symbol">∀{</a><a id="10149" href="/20.07/Substitution/#10149" class="Bound">A</a><a id="10150" class="Symbol">}</a> <a id="10152" class="Symbol">→</a> <a id="10154" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="10158" href="/20.07/Substitution/#10056" class="Bound">ρ</a> <a id="10160" class="Symbol">{</a><a id="10161" class="Argument">B</a> <a id="10163" class="Symbol">=</a> <a id="10165" href="/20.07/Substitution/#10075" class="Bound">B</a><a id="10166" class="Symbol">}</a> <a id="10168" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="10170" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="10174" href="/20.07/Substitution/#10058" class="Bound">ρ′</a> <a id="10177" class="Symbol">{</a><a id="10178" href="/20.07/Substitution/#10149" class="Bound">A</a><a id="10179" class="Symbol">}</a>
<a id="10181" href="/20.07/Substitution/#10038" class="Function">cong-ext</a><a id="10189" class="Symbol">{</a><a id="10190" href="/20.07/Substitution/#10190" class="Bound">Γ</a><a id="10191" class="Symbol">}{</a><a id="10193" href="/20.07/Substitution/#10193" class="Bound">Δ</a><a id="10194" class="Symbol">}{</a><a id="10196" href="/20.07/Substitution/#10196" class="Bound">ρ</a><a id="10197" class="Symbol">}{</a><a id="10199" href="/20.07/Substitution/#10199" class="Bound">ρ′</a><a id="10201" class="Symbol">}{</a><a id="10203" href="/20.07/Substitution/#10203" class="Bound">B</a><a id="10204" class="Symbol">}</a> <a id="10206" href="/20.07/Substitution/#10206" class="Bound">rr</a> <a id="10209" class="Symbol">{</a><a id="10210" href="/20.07/Substitution/#10210" class="Bound">A</a><a id="10211" class="Symbol">}</a> <a id="10213" class="Symbol">=</a> <a id="10215" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="10230" class="Symbol">λ</a> <a id="10232" href="/20.07/Substitution/#10232" class="Bound">x</a> <a id="10234" class="Symbol">→</a> <a id="10236" href="/20.07/Substitution/#10256" class="Function">lemma</a> <a id="10242" class="Symbol">{</a><a id="10243" href="/20.07/Substitution/#10232" class="Bound">x</a><a id="10244" class="Symbol">}</a>
  <a id="10248" class="Keyword">where</a>
  <a id="10256" href="/20.07/Substitution/#10256" class="Function">lemma</a> <a id="10262" class="Symbol">:</a> <a id="10264" class="Symbol">∀{</a><a id="10266" href="/20.07/Substitution/#10266" class="Bound">x</a> <a id="10268" class="Symbol">:</a> <a id="10270" href="/20.07/Substitution/#10190" class="Bound">Γ</a> <a id="10272" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="10274" href="/20.07/Substitution/#10203" class="Bound">B</a> <a id="10276" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="10278" href="/20.07/Substitution/#10210" class="Bound">A</a><a id="10279" class="Symbol">}</a> <a id="10281" class="Symbol">→</a> <a id="10283" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="10287" href="/20.07/Substitution/#10196" class="Bound">ρ</a> <a id="10289" href="/20.07/Substitution/#10266" class="Bound">x</a> <a id="10291" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="10293" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="10297" href="/20.07/Substitution/#10199" class="Bound">ρ′</a> <a id="10300" href="/20.07/Substitution/#10266" class="Bound">x</a>
  <a id="10304" href="/20.07/Substitution/#10256" class="Function">lemma</a> <a id="10310" class="Symbol">{</a><a id="10311" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="10312" class="Symbol">}</a> <a id="10314" class="Symbol">=</a> <a id="10316" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="10323" href="/20.07/Substitution/#10256" class="Function">lemma</a> <a id="10329" class="Symbol">{</a><a id="10330" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="10332" href="/20.07/Substitution/#10332" class="Bound">y</a><a id="10333" class="Symbol">}</a> <a id="10335" class="Symbol">=</a> <a id="10337" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="10342" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="10345" class="Symbol">(</a><a id="10346" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a> <a id="10355" href="/20.07/Substitution/#10206" class="Bound">rr</a> <a id="10358" href="/20.07/Substitution/#10332" class="Bound">y</a><a id="10359" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="cong-rename"></a><a id="10370" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="10382" class="Symbol">:</a> <a id="10384" class="Symbol">∀{</a><a id="10386" href="/20.07/Substitution/#10386" class="Bound">Γ</a> <a id="10388" href="/20.07/Substitution/#10388" class="Bound">Δ</a><a id="10389" class="Symbol">}{</a><a id="10391" href="/20.07/Substitution/#10391" class="Bound">ρ</a> <a id="10393" href="/20.07/Substitution/#10393" class="Bound">ρ′</a> <a id="10396" class="Symbol">:</a> <a id="10398" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="10405" href="/20.07/Substitution/#10386" class="Bound">Γ</a> <a id="10407" href="/20.07/Substitution/#10388" class="Bound">Δ</a><a id="10408" class="Symbol">}{</a><a id="10410" href="/20.07/Substitution/#10410" class="Bound">B</a><a id="10411" class="Symbol">}{</a><a id="10413" href="/20.07/Substitution/#10413" class="Bound">M</a> <a id="10415" class="Symbol">:</a> <a id="10417" href="/20.07/Substitution/#10386" class="Bound">Γ</a> <a id="10419" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="10421" href="/20.07/Substitution/#10410" class="Bound">B</a><a id="10422" class="Symbol">}</a>
        <a id="10432" class="Symbol">→</a> <a id="10434" class="Symbol">(∀{</a><a id="10437" href="/20.07/Substitution/#10437" class="Bound">A</a><a id="10438" class="Symbol">}</a> <a id="10440" class="Symbol">→</a> <a id="10442" href="/20.07/Substitution/#10391" class="Bound">ρ</a> <a id="10444" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="10446" href="/20.07/Substitution/#10393" class="Bound">ρ′</a> <a id="10449" class="Symbol">{</a><a id="10450" href="/20.07/Substitution/#10437" class="Bound">A</a><a id="10451" class="Symbol">})</a>
          <a id="10464" class="Comment">------------------------</a>
        <a id="10497" class="Symbol">→</a> <a id="10499" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="10506" href="/20.07/Substitution/#10391" class="Bound">ρ</a> <a id="10508" href="/20.07/Substitution/#10413" class="Bound">M</a> <a id="10510" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="10512" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="10519" href="/20.07/Substitution/#10393" class="Bound">ρ′</a> <a id="10522" href="/20.07/Substitution/#10413" class="Bound">M</a>
<a id="10524" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="10536" class="Symbol">{</a><a id="10537" class="Argument">M</a> <a id="10539" class="Symbol">=</a> <a id="10541" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="10543" href="/20.07/Substitution/#10543" class="Bound">x</a><a id="10544" class="Symbol">}</a> <a id="10546" href="/20.07/Substitution/#10546" class="Bound">rr</a> <a id="10549" class="Symbol">=</a> <a id="10551" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="10556" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`_</a> <a id="10559" class="Symbol">(</a><a id="10560" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a> <a id="10569" href="/20.07/Substitution/#10546" class="Bound">rr</a> <a id="10572" href="/20.07/Substitution/#10543" class="Bound">x</a><a id="10573" class="Symbol">)</a>
<a id="10575" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="10587" class="Symbol">{</a><a id="10588" class="Argument">ρ</a> <a id="10590" class="Symbol">=</a> <a id="10592" href="/20.07/Substitution/#10592" class="Bound">ρ</a><a id="10593" class="Symbol">}</a> <a id="10595" class="Symbol">{</a><a id="10596" class="Argument">ρ′</a> <a id="10599" class="Symbol">=</a> <a id="10601" href="/20.07/Substitution/#10601" class="Bound">ρ′</a><a id="10603" class="Symbol">}</a> <a id="10605" class="Symbol">{</a><a id="10606" class="Argument">M</a> <a id="10608" class="Symbol">=</a> <a id="10610" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="10612" href="/20.07/Substitution/#10612" class="Bound">N</a><a id="10613" class="Symbol">}</a> <a id="10615" href="/20.07/Substitution/#10615" class="Bound">rr</a> <a id="10618" class="Symbol">=</a>
   <a id="10623" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="10628" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="10631" class="Symbol">(</a><a id="10632" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="10644" class="Symbol">{</a><a id="10645" class="Argument">ρ</a> <a id="10647" class="Symbol">=</a> <a id="10649" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="10653" href="/20.07/Substitution/#10592" class="Bound">ρ</a><a id="10654" class="Symbol">}{</a><a id="10656" class="Argument">ρ′</a> <a id="10659" class="Symbol">=</a> <a id="10661" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="10665" href="/20.07/Substitution/#10601" class="Bound">ρ′</a><a id="10667" class="Symbol">}{</a><a id="10669" class="Argument">M</a> <a id="10671" class="Symbol">=</a> <a id="10673" href="/20.07/Substitution/#10612" class="Bound">N</a><a id="10674" class="Symbol">}</a> <a id="10676" class="Symbol">(</a><a id="10677" href="/20.07/Substitution/#10038" class="Function">cong-ext</a> <a id="10686" href="/20.07/Substitution/#10615" class="Bound">rr</a><a id="10688" class="Symbol">))</a>
<a id="10691" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="10703" class="Symbol">{</a><a id="10704" class="Argument">M</a> <a id="10706" class="Symbol">=</a> <a id="10708" href="/20.07/Substitution/#10708" class="Bound">L</a> <a id="10710" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="10712" href="/20.07/Substitution/#10712" class="Bound">M</a><a id="10713" class="Symbol">}</a> <a id="10715" href="/20.07/Substitution/#10715" class="Bound">rr</a> <a id="10718" class="Symbol">=</a>
   <a id="10723" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong₂</a> <a id="10729" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_·_</a> <a id="10733" class="Symbol">(</a><a id="10734" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="10746" href="/20.07/Substitution/#10715" class="Bound">rr</a><a id="10748" class="Symbol">)</a> <a id="10750" class="Symbol">(</a><a id="10751" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="10763" href="/20.07/Substitution/#10715" class="Bound">rr</a><a id="10765" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="cong-exts"></a><a id="10776" href="/20.07/Substitution/#10776" class="Function">cong-exts</a> <a id="10786" class="Symbol">:</a> <a id="10788" class="Symbol">∀{</a><a id="10790" href="/20.07/Substitution/#10790" class="Bound">Γ</a> <a id="10792" href="/20.07/Substitution/#10792" class="Bound">Δ</a><a id="10793" class="Symbol">}{</a><a id="10795" href="/20.07/Substitution/#10795" class="Bound">σ</a> <a id="10797" href="/20.07/Substitution/#10797" class="Bound">σ′</a> <a id="10800" class="Symbol">:</a> <a id="10802" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="10808" href="/20.07/Substitution/#10790" class="Bound">Γ</a> <a id="10810" href="/20.07/Substitution/#10792" class="Bound">Δ</a><a id="10811" class="Symbol">}{</a><a id="10813" href="/20.07/Substitution/#10813" class="Bound">B</a><a id="10814" class="Symbol">}</a>
   <a id="10819" class="Symbol">→</a> <a id="10821" class="Symbol">(∀{</a><a id="10824" href="/20.07/Substitution/#10824" class="Bound">A</a><a id="10825" class="Symbol">}</a> <a id="10827" class="Symbol">→</a> <a id="10829" href="/20.07/Substitution/#10795" class="Bound">σ</a> <a id="10831" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="10833" href="/20.07/Substitution/#10797" class="Bound">σ′</a> <a id="10836" class="Symbol">{</a><a id="10837" href="/20.07/Substitution/#10824" class="Bound">A</a><a id="10838" class="Symbol">})</a>
     <a id="10846" class="Comment">-----------------------------------</a>
   <a id="10885" class="Symbol">→</a> <a id="10887" class="Symbol">∀{</a><a id="10889" href="/20.07/Substitution/#10889" class="Bound">A</a><a id="10890" class="Symbol">}</a> <a id="10892" class="Symbol">→</a> <a id="10894" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="10899" href="/20.07/Substitution/#10795" class="Bound">σ</a> <a id="10901" class="Symbol">{</a><a id="10902" class="Argument">B</a> <a id="10904" class="Symbol">=</a> <a id="10906" href="/20.07/Substitution/#10813" class="Bound">B</a><a id="10907" class="Symbol">}</a> <a id="10909" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="10911" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="10916" href="/20.07/Substitution/#10797" class="Bound">σ′</a> <a id="10919" class="Symbol">{</a><a id="10920" href="/20.07/Substitution/#10889" class="Bound">A</a><a id="10921" class="Symbol">}</a>
<a id="10923" href="/20.07/Substitution/#10776" class="Function">cong-exts</a><a id="10932" class="Symbol">{</a><a id="10933" href="/20.07/Substitution/#10933" class="Bound">Γ</a><a id="10934" class="Symbol">}{</a><a id="10936" href="/20.07/Substitution/#10936" class="Bound">Δ</a><a id="10937" class="Symbol">}{</a><a id="10939" href="/20.07/Substitution/#10939" class="Bound">σ</a><a id="10940" class="Symbol">}{</a><a id="10942" href="/20.07/Substitution/#10942" class="Bound">σ′</a><a id="10944" class="Symbol">}{</a><a id="10946" href="/20.07/Substitution/#10946" class="Bound">B</a><a id="10947" class="Symbol">}</a> <a id="10949" href="/20.07/Substitution/#10949" class="Bound">ss</a> <a id="10952" class="Symbol">{</a><a id="10953" href="/20.07/Substitution/#10953" class="Bound">A</a><a id="10954" class="Symbol">}</a> <a id="10956" class="Symbol">=</a> <a id="10958" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="10973" class="Symbol">λ</a> <a id="10975" href="/20.07/Substitution/#10975" class="Bound">x</a> <a id="10977" class="Symbol">→</a> <a id="10979" href="/20.07/Substitution/#11001" class="Function">lemma</a> <a id="10985" class="Symbol">{</a><a id="10986" href="/20.07/Substitution/#10975" class="Bound">x</a><a id="10987" class="Symbol">}</a>
   <a id="10992" class="Keyword">where</a>
   <a id="11001" href="/20.07/Substitution/#11001" class="Function">lemma</a> <a id="11007" class="Symbol">:</a> <a id="11009" class="Symbol">∀{</a><a id="11011" href="/20.07/Substitution/#11011" class="Bound">x</a><a id="11012" class="Symbol">}</a> <a id="11014" class="Symbol">→</a> <a id="11016" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="11021" href="/20.07/Substitution/#10939" class="Bound">σ</a> <a id="11023" href="/20.07/Substitution/#11011" class="Bound">x</a> <a id="11025" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="11027" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="11032" href="/20.07/Substitution/#10942" class="Bound">σ′</a> <a id="11035" href="/20.07/Substitution/#11011" class="Bound">x</a>
   <a id="11040" href="/20.07/Substitution/#11001" class="Function">lemma</a> <a id="11046" class="Symbol">{</a><a id="11047" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="11048" class="Symbol">}</a> <a id="11050" class="Symbol">=</a> <a id="11052" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
   <a id="11060" href="/20.07/Substitution/#11001" class="Function">lemma</a> <a id="11066" class="Symbol">{</a><a id="11067" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="11069" href="/20.07/Substitution/#11069" class="Bound">x</a><a id="11070" class="Symbol">}</a> <a id="11072" class="Symbol">=</a> <a id="11074" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="11079" class="Symbol">(</a><a id="11080" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="11087" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a><a id="11089" class="Symbol">)</a> <a id="11091" class="Symbol">(</a><a id="11092" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a> <a id="11101" class="Symbol">(</a><a id="11102" href="/20.07/Substitution/#10949" class="Bound">ss</a> <a id="11105" class="Symbol">{</a><a id="11106" href="/20.07/Substitution/#10953" class="Bound">A</a><a id="11107" class="Symbol">})</a> <a id="11110" href="/20.07/Substitution/#11069" class="Bound">x</a><a id="11111" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="cong-sub"></a><a id="11122" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="11131" class="Symbol">:</a> <a id="11133" class="Symbol">∀{</a><a id="11135" href="/20.07/Substitution/#11135" class="Bound">Γ</a> <a id="11137" href="/20.07/Substitution/#11137" class="Bound">Δ</a><a id="11138" class="Symbol">}{</a><a id="11140" href="/20.07/Substitution/#11140" class="Bound">σ</a> <a id="11142" href="/20.07/Substitution/#11142" class="Bound">σ′</a> <a id="11145" class="Symbol">:</a> <a id="11147" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="11153" href="/20.07/Substitution/#11135" class="Bound">Γ</a> <a id="11155" href="/20.07/Substitution/#11137" class="Bound">Δ</a><a id="11156" class="Symbol">}{</a><a id="11158" href="/20.07/Substitution/#11158" class="Bound">A</a><a id="11159" class="Symbol">}{</a><a id="11161" href="/20.07/Substitution/#11161" class="Bound">M</a> <a id="11163" href="/20.07/Substitution/#11163" class="Bound">M′</a> <a id="11166" class="Symbol">:</a> <a id="11168" href="/20.07/Substitution/#11135" class="Bound">Γ</a> <a id="11170" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="11172" href="/20.07/Substitution/#11158" class="Bound">A</a><a id="11173" class="Symbol">}</a>
            <a id="11187" class="Symbol">→</a> <a id="11189" class="Symbol">(∀{</a><a id="11192" href="/20.07/Substitution/#11192" class="Bound">A</a><a id="11193" class="Symbol">}</a> <a id="11195" class="Symbol">→</a> <a id="11197" href="/20.07/Substitution/#11140" class="Bound">σ</a> <a id="11199" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="11201" href="/20.07/Substitution/#11142" class="Bound">σ′</a> <a id="11204" class="Symbol">{</a><a id="11205" href="/20.07/Substitution/#11192" class="Bound">A</a><a id="11206" class="Symbol">})</a>  <a id="11210" class="Symbol">→</a>  <a id="11213" href="/20.07/Substitution/#11161" class="Bound">M</a> <a id="11215" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="11217" href="/20.07/Substitution/#11163" class="Bound">M′</a>
              <a id="11234" class="Comment">------------------------------</a>
            <a id="11277" class="Symbol">→</a> <a id="11279" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="11285" href="/20.07/Substitution/#11140" class="Bound">σ</a> <a id="11287" href="/20.07/Substitution/#11161" class="Bound">M</a> <a id="11289" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="11291" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="11297" href="/20.07/Substitution/#11142" class="Bound">σ′</a> <a id="11300" href="/20.07/Substitution/#11163" class="Bound">M′</a>
<a id="11303" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="11312" class="Symbol">{</a><a id="11313" href="/20.07/Substitution/#11313" class="Bound">Γ</a><a id="11314" class="Symbol">}</a> <a id="11316" class="Symbol">{</a><a id="11317" href="/20.07/Substitution/#11317" class="Bound">Δ</a><a id="11318" class="Symbol">}</a> <a id="11320" class="Symbol">{</a><a id="11321" href="/20.07/Substitution/#11321" class="Bound">σ</a><a id="11322" class="Symbol">}</a> <a id="11324" class="Symbol">{</a><a id="11325" href="/20.07/Substitution/#11325" class="Bound">σ′</a><a id="11327" class="Symbol">}</a> <a id="11329" class="Symbol">{</a><a id="11330" href="/20.07/Substitution/#11330" class="Bound">A</a><a id="11331" class="Symbol">}</a> <a id="11333" class="Symbol">{</a><a id="11334" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="11336" href="/20.07/Substitution/#11336" class="Bound">x</a><a id="11337" class="Symbol">}</a> <a id="11339" href="/20.07/Substitution/#11339" class="Bound">ss</a> <a id="11342" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="11347" class="Symbol">=</a> <a id="11349" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a> <a id="11358" href="/20.07/Substitution/#11339" class="Bound">ss</a> <a id="11361" href="/20.07/Substitution/#11336" class="Bound">x</a>
<a id="11363" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="11372" class="Symbol">{</a><a id="11373" href="/20.07/Substitution/#11373" class="Bound">Γ</a><a id="11374" class="Symbol">}</a> <a id="11376" class="Symbol">{</a><a id="11377" href="/20.07/Substitution/#11377" class="Bound">Δ</a><a id="11378" class="Symbol">}</a> <a id="11380" class="Symbol">{</a><a id="11381" href="/20.07/Substitution/#11381" class="Bound">σ</a><a id="11382" class="Symbol">}</a> <a id="11384" class="Symbol">{</a><a id="11385" href="/20.07/Substitution/#11385" class="Bound">σ′</a><a id="11387" class="Symbol">}</a> <a id="11389" class="Symbol">{</a><a id="11390" href="/20.07/Substitution/#11390" class="Bound">A</a><a id="11391" class="Symbol">}</a> <a id="11393" class="Symbol">{</a><a id="11394" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="11396" href="/20.07/Substitution/#11396" class="Bound">M</a><a id="11397" class="Symbol">}</a> <a id="11399" href="/20.07/Substitution/#11399" class="Bound">ss</a> <a id="11402" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="11407" class="Symbol">=</a>
   <a id="11412" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="11417" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="11420" class="Symbol">(</a><a id="11421" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="11430" class="Symbol">{</a><a id="11431" class="Argument">σ</a> <a id="11433" class="Symbol">=</a> <a id="11435" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="11440" href="/20.07/Substitution/#11381" class="Bound">σ</a><a id="11441" class="Symbol">}{</a><a id="11443" class="Argument">σ′</a> <a id="11446" class="Symbol">=</a> <a id="11448" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="11453" href="/20.07/Substitution/#11385" class="Bound">σ′</a><a id="11455" class="Symbol">}</a> <a id="11457" class="Symbol">{</a><a id="11458" class="Argument">M</a> <a id="11460" class="Symbol">=</a> <a id="11462" href="/20.07/Substitution/#11396" class="Bound">M</a><a id="11463" class="Symbol">}</a> <a id="11465" class="Symbol">(</a><a id="11466" href="/20.07/Substitution/#10776" class="Function">cong-exts</a> <a id="11476" href="/20.07/Substitution/#11399" class="Bound">ss</a><a id="11478" class="Symbol">)</a> <a id="11480" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="11484" class="Symbol">)</a>
<a id="11486" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="11495" class="Symbol">{</a><a id="11496" href="/20.07/Substitution/#11496" class="Bound">Γ</a><a id="11497" class="Symbol">}</a> <a id="11499" class="Symbol">{</a><a id="11500" href="/20.07/Substitution/#11500" class="Bound">Δ</a><a id="11501" class="Symbol">}</a> <a id="11503" class="Symbol">{</a><a id="11504" href="/20.07/Substitution/#11504" class="Bound">σ</a><a id="11505" class="Symbol">}</a> <a id="11507" class="Symbol">{</a><a id="11508" href="/20.07/Substitution/#11508" class="Bound">σ′</a><a id="11510" class="Symbol">}</a> <a id="11512" class="Symbol">{</a><a id="11513" href="/20.07/Substitution/#11513" class="Bound">A</a><a id="11514" class="Symbol">}</a> <a id="11516" class="Symbol">{</a><a id="11517" href="/20.07/Substitution/#11517" class="Bound">L</a> <a id="11519" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="11521" href="/20.07/Substitution/#11521" class="Bound">M</a><a id="11522" class="Symbol">}</a> <a id="11524" href="/20.07/Substitution/#11524" class="Bound">ss</a> <a id="11527" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="11532" class="Symbol">=</a>
   <a id="11537" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong₂</a> <a id="11543" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_·_</a> <a id="11547" class="Symbol">(</a><a id="11548" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="11557" class="Symbol">{</a><a id="11558" class="Argument">M</a> <a id="11560" class="Symbol">=</a> <a id="11562" href="/20.07/Substitution/#11517" class="Bound">L</a><a id="11563" class="Symbol">}</a> <a id="11565" href="/20.07/Substitution/#11524" class="Bound">ss</a> <a id="11568" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="11572" class="Symbol">)</a> <a id="11574" class="Symbol">(</a><a id="11575" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="11584" class="Symbol">{</a><a id="11585" class="Argument">M</a> <a id="11587" class="Symbol">=</a> <a id="11589" href="/20.07/Substitution/#11521" class="Bound">M</a><a id="11590" class="Symbol">}</a> <a id="11592" href="/20.07/Substitution/#11524" class="Bound">ss</a> <a id="11595" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="11599" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="cong-sub-zero"></a><a id="11610" href="/20.07/Substitution/#11610" class="Function">cong-sub-zero</a> <a id="11624" class="Symbol">:</a> <a id="11626" class="Symbol">∀{</a><a id="11628" href="/20.07/Substitution/#11628" class="Bound">Γ</a><a id="11629" class="Symbol">}{</a><a id="11631" href="/20.07/Substitution/#11631" class="Bound">B</a> <a id="11633" class="Symbol">:</a> <a id="11635" href="/20.07/Untyped/#2869" class="Datatype">Type</a><a id="11639" class="Symbol">}{</a><a id="11641" href="/20.07/Substitution/#11641" class="Bound">M</a> <a id="11643" href="/20.07/Substitution/#11643" class="Bound">M′</a> <a id="11646" class="Symbol">:</a> <a id="11648" href="/20.07/Substitution/#11628" class="Bound">Γ</a> <a id="11650" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="11652" href="/20.07/Substitution/#11631" class="Bound">B</a><a id="11653" class="Symbol">}</a>
  <a id="11657" class="Symbol">→</a> <a id="11659" href="/20.07/Substitution/#11641" class="Bound">M</a> <a id="11661" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="11663" href="/20.07/Substitution/#11643" class="Bound">M′</a>
    <a id="11670" class="Comment">-----------------------------------------</a>
  <a id="11714" class="Symbol">→</a> <a id="11716" class="Symbol">∀{</a><a id="11718" href="/20.07/Substitution/#11718" class="Bound">A</a><a id="11719" class="Symbol">}</a> <a id="11721" class="Symbol">→</a> <a id="11723" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="11734" href="/20.07/Substitution/#11641" class="Bound">M</a> <a id="11736" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="11738" class="Symbol">(</a><a id="11739" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="11750" href="/20.07/Substitution/#11643" class="Bound">M′</a><a id="11752" class="Symbol">)</a> <a id="11754" class="Symbol">{</a><a id="11755" href="/20.07/Substitution/#11718" class="Bound">A</a><a id="11756" class="Symbol">}</a>
<a id="11758" href="/20.07/Substitution/#11610" class="Function">cong-sub-zero</a> <a id="11772" class="Symbol">{</a><a id="11773" href="/20.07/Substitution/#11773" class="Bound">Γ</a><a id="11774" class="Symbol">}{</a><a id="11776" href="/20.07/Substitution/#11776" class="Bound">B</a><a id="11777" class="Symbol">}{</a><a id="11779" href="/20.07/Substitution/#11779" class="Bound">M</a><a id="11780" class="Symbol">}{</a><a id="11782" href="/20.07/Substitution/#11782" class="Bound">M′</a><a id="11784" class="Symbol">}</a> <a id="11786" href="/20.07/Substitution/#11786" class="Bound">mm&#39;</a> <a id="11790" class="Symbol">{</a><a id="11791" href="/20.07/Substitution/#11791" class="Bound">A</a><a id="11792" class="Symbol">}</a> <a id="11794" class="Symbol">=</a>
   <a id="11799" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="11814" class="Symbol">λ</a> <a id="11816" href="/20.07/Substitution/#11816" class="Bound">x</a> <a id="11818" class="Symbol">→</a> <a id="11820" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="11825" class="Symbol">(λ</a> <a id="11828" href="/20.07/Substitution/#11828" class="Bound">z</a> <a id="11830" class="Symbol">→</a> <a id="11832" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="11843" href="/20.07/Substitution/#11828" class="Bound">z</a> <a id="11845" href="/20.07/Substitution/#11816" class="Bound">x</a><a id="11846" class="Symbol">)</a> <a id="11848" href="/20.07/Substitution/#11786" class="Bound">mm&#39;</a>
</pre>
<pre class="Agda"><a id="cong-cons"></a><a id="11861" href="/20.07/Substitution/#11861" class="Function">cong-cons</a> <a id="11871" class="Symbol">:</a> <a id="11873" class="Symbol">∀{</a><a id="11875" href="/20.07/Substitution/#11875" class="Bound">Γ</a> <a id="11877" href="/20.07/Substitution/#11877" class="Bound">Δ</a><a id="11878" class="Symbol">}{</a><a id="11880" href="/20.07/Substitution/#11880" class="Bound">A</a><a id="11881" class="Symbol">}{</a><a id="11883" href="/20.07/Substitution/#11883" class="Bound">M</a> <a id="11885" href="/20.07/Substitution/#11885" class="Bound">N</a> <a id="11887" class="Symbol">:</a> <a id="11889" href="/20.07/Substitution/#11877" class="Bound">Δ</a> <a id="11891" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="11893" href="/20.07/Substitution/#11880" class="Bound">A</a><a id="11894" class="Symbol">}{</a><a id="11896" href="/20.07/Substitution/#11896" class="Bound">σ</a> <a id="11898" href="/20.07/Substitution/#11898" class="Bound">τ</a> <a id="11900" class="Symbol">:</a> <a id="11902" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="11908" href="/20.07/Substitution/#11875" class="Bound">Γ</a> <a id="11910" href="/20.07/Substitution/#11877" class="Bound">Δ</a><a id="11911" class="Symbol">}</a>
  <a id="11915" class="Symbol">→</a> <a id="11917" href="/20.07/Substitution/#11883" class="Bound">M</a> <a id="11919" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="11921" href="/20.07/Substitution/#11885" class="Bound">N</a>  <a id="11924" class="Symbol">→</a>  <a id="11927" class="Symbol">(∀{</a><a id="11930" href="/20.07/Substitution/#11930" class="Bound">A</a><a id="11931" class="Symbol">}</a> <a id="11933" class="Symbol">→</a> <a id="11935" href="/20.07/Substitution/#11896" class="Bound">σ</a> <a id="11937" class="Symbol">{</a><a id="11938" href="/20.07/Substitution/#11930" class="Bound">A</a><a id="11939" class="Symbol">}</a> <a id="11941" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="11943" href="/20.07/Substitution/#11898" class="Bound">τ</a> <a id="11945" class="Symbol">{</a><a id="11946" href="/20.07/Substitution/#11930" class="Bound">A</a><a id="11947" class="Symbol">})</a>
    <a id="11954" class="Comment">--------------------------------</a>
  <a id="11989" class="Symbol">→</a> <a id="11991" class="Symbol">∀{</a><a id="11993" href="/20.07/Substitution/#11993" class="Bound">A</a><a id="11994" class="Symbol">}</a> <a id="11996" class="Symbol">→</a> <a id="11998" class="Symbol">(</a><a id="11999" href="/20.07/Substitution/#11883" class="Bound">M</a> <a id="12001" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="12003" href="/20.07/Substitution/#11896" class="Bound">σ</a><a id="12004" class="Symbol">)</a> <a id="12006" class="Symbol">{</a><a id="12007" href="/20.07/Substitution/#11993" class="Bound">A</a><a id="12008" class="Symbol">}</a> <a id="12010" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="12012" class="Symbol">(</a><a id="12013" href="/20.07/Substitution/#11885" class="Bound">N</a> <a id="12015" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="12017" href="/20.07/Substitution/#11898" class="Bound">τ</a><a id="12018" class="Symbol">)</a> <a id="12020" class="Symbol">{</a><a id="12021" href="/20.07/Substitution/#11993" class="Bound">A</a><a id="12022" class="Symbol">}</a>
<a id="12024" href="/20.07/Substitution/#11861" class="Function">cong-cons</a><a id="12033" class="Symbol">{</a><a id="12034" href="/20.07/Substitution/#12034" class="Bound">Γ</a><a id="12035" class="Symbol">}{</a><a id="12037" href="/20.07/Substitution/#12037" class="Bound">Δ</a><a id="12038" class="Symbol">}{</a><a id="12040" href="/20.07/Substitution/#12040" class="Bound">A</a><a id="12041" class="Symbol">}{</a><a id="12043" href="/20.07/Substitution/#12043" class="Bound">M</a><a id="12044" class="Symbol">}{</a><a id="12046" href="/20.07/Substitution/#12046" class="Bound">N</a><a id="12047" class="Symbol">}{</a><a id="12049" href="/20.07/Substitution/#12049" class="Bound">σ</a><a id="12050" class="Symbol">}{</a><a id="12052" href="/20.07/Substitution/#12052" class="Bound">τ</a><a id="12053" class="Symbol">}</a> <a id="12055" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="12060" href="/20.07/Substitution/#12060" class="Bound">st</a> <a id="12063" class="Symbol">{</a><a id="12064" href="/20.07/Substitution/#12064" class="Bound">A′</a><a id="12066" class="Symbol">}</a> <a id="12068" class="Symbol">=</a> <a id="12070" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="12085" href="/20.07/Substitution/#12101" class="Function">lemma</a>
  <a id="12093" class="Keyword">where</a>
  <a id="12101" href="/20.07/Substitution/#12101" class="Function">lemma</a> <a id="12107" class="Symbol">:</a> <a id="12109" class="Symbol">(</a><a id="12110" href="/20.07/Substitution/#12110" class="Bound">x</a> <a id="12112" class="Symbol">:</a> <a id="12114" href="/20.07/Substitution/#12034" class="Bound">Γ</a> <a id="12116" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="12118" href="/20.07/Substitution/#12040" class="Bound">A</a> <a id="12120" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="12122" href="/20.07/Substitution/#12064" class="Bound">A′</a><a id="12124" class="Symbol">)</a> <a id="12126" class="Symbol">→</a> <a id="12128" class="Symbol">(</a><a id="12129" href="/20.07/Substitution/#12043" class="Bound">M</a> <a id="12131" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="12133" href="/20.07/Substitution/#12049" class="Bound">σ</a><a id="12134" class="Symbol">)</a> <a id="12136" href="/20.07/Substitution/#12110" class="Bound">x</a> <a id="12138" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="12140" class="Symbol">(</a><a id="12141" href="/20.07/Substitution/#12043" class="Bound">M</a> <a id="12143" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="12145" href="/20.07/Substitution/#12052" class="Bound">τ</a><a id="12146" class="Symbol">)</a> <a id="12148" href="/20.07/Substitution/#12110" class="Bound">x</a>
  <a id="12152" href="/20.07/Substitution/#12101" class="Function">lemma</a> <a id="12158" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="12160" class="Symbol">=</a> <a id="12162" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="12169" href="/20.07/Substitution/#12101" class="Function">lemma</a> <a id="12175" class="Symbol">(</a><a id="12176" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="12178" href="/20.07/Substitution/#12178" class="Bound">x</a><a id="12179" class="Symbol">)</a> <a id="12181" class="Symbol">=</a> <a id="12183" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a> <a id="12192" href="/20.07/Substitution/#12060" class="Bound">st</a> <a id="12195" href="/20.07/Substitution/#12178" class="Bound">x</a>
</pre>
<pre class="Agda"><a id="cong-seq"></a><a id="12206" href="/20.07/Substitution/#12206" class="Function">cong-seq</a> <a id="12215" class="Symbol">:</a> <a id="12217" class="Symbol">∀{</a><a id="12219" href="/20.07/Substitution/#12219" class="Bound">Γ</a> <a id="12221" href="/20.07/Substitution/#12221" class="Bound">Δ</a> <a id="12223" href="/20.07/Substitution/#12223" class="Bound">Σ</a><a id="12224" class="Symbol">}{</a><a id="12226" href="/20.07/Substitution/#12226" class="Bound">σ</a> <a id="12228" href="/20.07/Substitution/#12228" class="Bound">σ′</a> <a id="12231" class="Symbol">:</a> <a id="12233" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="12239" href="/20.07/Substitution/#12219" class="Bound">Γ</a> <a id="12241" href="/20.07/Substitution/#12221" class="Bound">Δ</a><a id="12242" class="Symbol">}{</a><a id="12244" href="/20.07/Substitution/#12244" class="Bound">τ</a> <a id="12246" href="/20.07/Substitution/#12246" class="Bound">τ′</a> <a id="12249" class="Symbol">:</a> <a id="12251" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="12257" href="/20.07/Substitution/#12221" class="Bound">Δ</a> <a id="12259" href="/20.07/Substitution/#12223" class="Bound">Σ</a><a id="12260" class="Symbol">}</a>
  <a id="12264" class="Symbol">→</a> <a id="12266" class="Symbol">(∀{</a><a id="12269" href="/20.07/Substitution/#12269" class="Bound">A</a><a id="12270" class="Symbol">}</a> <a id="12272" class="Symbol">→</a> <a id="12274" href="/20.07/Substitution/#12226" class="Bound">σ</a> <a id="12276" class="Symbol">{</a><a id="12277" href="/20.07/Substitution/#12269" class="Bound">A</a><a id="12278" class="Symbol">}</a> <a id="12280" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="12282" href="/20.07/Substitution/#12228" class="Bound">σ′</a> <a id="12285" class="Symbol">{</a><a id="12286" href="/20.07/Substitution/#12269" class="Bound">A</a><a id="12287" class="Symbol">})</a> <a id="12290" class="Symbol">→</a> <a id="12292" class="Symbol">(∀{</a><a id="12295" href="/20.07/Substitution/#12295" class="Bound">A</a><a id="12296" class="Symbol">}</a> <a id="12298" class="Symbol">→</a> <a id="12300" href="/20.07/Substitution/#12244" class="Bound">τ</a> <a id="12302" class="Symbol">{</a><a id="12303" href="/20.07/Substitution/#12295" class="Bound">A</a><a id="12304" class="Symbol">}</a> <a id="12306" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="12308" href="/20.07/Substitution/#12246" class="Bound">τ′</a> <a id="12311" class="Symbol">{</a><a id="12312" href="/20.07/Substitution/#12295" class="Bound">A</a><a id="12313" class="Symbol">})</a>
  <a id="12318" class="Symbol">→</a> <a id="12320" class="Symbol">∀{</a><a id="12322" href="/20.07/Substitution/#12322" class="Bound">A</a><a id="12323" class="Symbol">}</a> <a id="12325" class="Symbol">→</a> <a id="12327" class="Symbol">(</a><a id="12328" href="/20.07/Substitution/#12226" class="Bound">σ</a> <a id="12330" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="12332" href="/20.07/Substitution/#12244" class="Bound">τ</a><a id="12333" class="Symbol">)</a> <a id="12335" class="Symbol">{</a><a id="12336" href="/20.07/Substitution/#12322" class="Bound">A</a><a id="12337" class="Symbol">}</a> <a id="12339" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="12341" class="Symbol">(</a><a id="12342" href="/20.07/Substitution/#12228" class="Bound">σ′</a> <a id="12345" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="12347" href="/20.07/Substitution/#12246" class="Bound">τ′</a><a id="12349" class="Symbol">)</a> <a id="12351" class="Symbol">{</a><a id="12352" href="/20.07/Substitution/#12322" class="Bound">A</a><a id="12353" class="Symbol">}</a>
<a id="12355" href="/20.07/Substitution/#12206" class="Function">cong-seq</a> <a id="12364" class="Symbol">{</a><a id="12365" href="/20.07/Substitution/#12365" class="Bound">Γ</a><a id="12366" class="Symbol">}{</a><a id="12368" href="/20.07/Substitution/#12368" class="Bound">Δ</a><a id="12369" class="Symbol">}{</a><a id="12371" href="/20.07/Substitution/#12371" class="Bound">Σ</a><a id="12372" class="Symbol">}{</a><a id="12374" href="/20.07/Substitution/#12374" class="Bound">σ</a><a id="12375" class="Symbol">}{</a><a id="12377" href="/20.07/Substitution/#12377" class="Bound">σ′</a><a id="12379" class="Symbol">}{</a><a id="12381" href="/20.07/Substitution/#12381" class="Bound">τ</a><a id="12382" class="Symbol">}{</a><a id="12384" href="/20.07/Substitution/#12384" class="Bound">τ′</a><a id="12386" class="Symbol">}</a> <a id="12388" href="/20.07/Substitution/#12388" class="Bound">ss&#39;</a> <a id="12392" href="/20.07/Substitution/#12392" class="Bound">tt&#39;</a> <a id="12396" class="Symbol">{</a><a id="12397" href="/20.07/Substitution/#12397" class="Bound">A</a><a id="12398" class="Symbol">}</a> <a id="12400" class="Symbol">=</a> <a id="12402" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="12417" href="/20.07/Substitution/#12433" class="Function">lemma</a>
  <a id="12425" class="Keyword">where</a>
  <a id="12433" href="/20.07/Substitution/#12433" class="Function">lemma</a> <a id="12439" class="Symbol">:</a> <a id="12441" class="Symbol">(</a><a id="12442" href="/20.07/Substitution/#12442" class="Bound">x</a> <a id="12444" class="Symbol">:</a> <a id="12446" href="/20.07/Substitution/#12365" class="Bound">Γ</a> <a id="12448" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="12450" href="/20.07/Substitution/#12397" class="Bound">A</a><a id="12451" class="Symbol">)</a> <a id="12453" class="Symbol">→</a> <a id="12455" class="Symbol">(</a><a id="12456" href="/20.07/Substitution/#12374" class="Bound">σ</a> <a id="12458" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="12460" href="/20.07/Substitution/#12381" class="Bound">τ</a><a id="12461" class="Symbol">)</a> <a id="12463" href="/20.07/Substitution/#12442" class="Bound">x</a> <a id="12465" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="12467" class="Symbol">(</a><a id="12468" href="/20.07/Substitution/#12377" class="Bound">σ′</a> <a id="12471" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="12473" href="/20.07/Substitution/#12384" class="Bound">τ′</a><a id="12475" class="Symbol">)</a> <a id="12477" href="/20.07/Substitution/#12442" class="Bound">x</a>
  <a id="12481" href="/20.07/Substitution/#12433" class="Function">lemma</a> <a id="12487" href="/20.07/Substitution/#12487" class="Bound">x</a> <a id="12489" class="Symbol">=</a>
     <a id="12496" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
       <a id="12509" class="Symbol">(</a><a id="12510" href="/20.07/Substitution/#12374" class="Bound">σ</a> <a id="12512" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="12514" href="/20.07/Substitution/#12381" class="Bound">τ</a><a id="12515" class="Symbol">)</a> <a id="12517" href="/20.07/Substitution/#12487" class="Bound">x</a>
     <a id="12524" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
       <a id="12535" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="12541" href="/20.07/Substitution/#12381" class="Bound">τ</a> <a id="12543" class="Symbol">(</a><a id="12544" href="/20.07/Substitution/#12374" class="Bound">σ</a> <a id="12546" href="/20.07/Substitution/#12487" class="Bound">x</a><a id="12547" class="Symbol">)</a>
     <a id="12554" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="12557" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="12562" class="Symbol">(</a><a id="12563" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="12569" href="/20.07/Substitution/#12381" class="Bound">τ</a><a id="12570" class="Symbol">)</a> <a id="12572" class="Symbol">(</a><a id="12573" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a> <a id="12582" href="/20.07/Substitution/#12388" class="Bound">ss&#39;</a> <a id="12586" href="/20.07/Substitution/#12487" class="Bound">x</a><a id="12587" class="Symbol">)</a> <a id="12589" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="12598" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="12604" href="/20.07/Substitution/#12381" class="Bound">τ</a> <a id="12606" class="Symbol">(</a><a id="12607" href="/20.07/Substitution/#12377" class="Bound">σ′</a> <a id="12610" href="/20.07/Substitution/#12487" class="Bound">x</a><a id="12611" class="Symbol">)</a>
     <a id="12618" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="12621" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="12629" class="Symbol">{</a><a id="12630" class="Argument">M</a> <a id="12632" class="Symbol">=</a> <a id="12634" href="/20.07/Substitution/#12377" class="Bound">σ′</a> <a id="12637" href="/20.07/Substitution/#12487" class="Bound">x</a><a id="12638" class="Symbol">}</a> <a id="12640" href="/20.07/Substitution/#12392" class="Bound">tt&#39;</a> <a id="12644" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="12649" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="12658" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="12664" href="/20.07/Substitution/#12384" class="Bound">τ′</a> <a id="12667" class="Symbol">(</a><a id="12668" href="/20.07/Substitution/#12377" class="Bound">σ′</a> <a id="12671" href="/20.07/Substitution/#12487" class="Bound">x</a><a id="12672" class="Symbol">)</a>
     <a id="12679" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
       <a id="12690" class="Symbol">(</a><a id="12691" href="/20.07/Substitution/#12377" class="Bound">σ′</a> <a id="12694" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="12696" href="/20.07/Substitution/#12384" class="Bound">τ′</a><a id="12698" class="Symbol">)</a> <a id="12700" href="/20.07/Substitution/#12487" class="Bound">x</a>
     <a id="12707" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>

<h2 id="relating-rename-exts-ext-and-subst-zero-to-the-σ-algebra">Relating <code class="language-plaintext highlighter-rouge">rename</code>, <code class="language-plaintext highlighter-rouge">exts</code>, <code class="language-plaintext highlighter-rouge">ext</code>, and <code class="language-plaintext highlighter-rouge">subst-zero</code> to the σ algebra</h2>

<p>In this section we establish equations that relate <code class="language-plaintext highlighter-rouge">subst</code> and its
helper functions (<code class="language-plaintext highlighter-rouge">rename</code>, <code class="language-plaintext highlighter-rouge">exts</code>, <code class="language-plaintext highlighter-rouge">ext</code>, and <code class="language-plaintext highlighter-rouge">subst-zero</code>) to terms
in the σ algebra.</p>

<p>The first equation we prove is</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⟪ ren ρ ⟫ M              (rename-subst-ren)
</code></pre></div></div>

<p>Because <code class="language-plaintext highlighter-rouge">subst</code> uses the <code class="language-plaintext highlighter-rouge">exts</code> function, we need the following lemma
which says that <code class="language-plaintext highlighter-rouge">exts</code> and <code class="language-plaintext highlighter-rouge">ext</code> do the same thing except that <code class="language-plaintext highlighter-rouge">ext</code>
works on renamings and <code class="language-plaintext highlighter-rouge">exts</code> works on substitutions.</p>

<pre class="Agda"><a id="ren-ext"></a><a id="13235" href="/20.07/Substitution/#13235" class="Function">ren-ext</a> <a id="13243" class="Symbol">:</a> <a id="13245" class="Symbol">∀</a> <a id="13247" class="Symbol">{</a><a id="13248" href="/20.07/Substitution/#13248" class="Bound">Γ</a> <a id="13250" href="/20.07/Substitution/#13250" class="Bound">Δ</a><a id="13251" class="Symbol">}{</a><a id="13253" href="/20.07/Substitution/#13253" class="Bound">B</a> <a id="13255" href="/20.07/Substitution/#13255" class="Bound">C</a> <a id="13257" class="Symbol">:</a> <a id="13259" href="/20.07/Untyped/#2869" class="Datatype">Type</a><a id="13263" class="Symbol">}</a> <a id="13265" class="Symbol">{</a><a id="13266" href="/20.07/Substitution/#13266" class="Bound">ρ</a> <a id="13268" class="Symbol">:</a> <a id="13270" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="13277" href="/20.07/Substitution/#13248" class="Bound">Γ</a> <a id="13279" href="/20.07/Substitution/#13250" class="Bound">Δ</a><a id="13280" class="Symbol">}</a>
        <a id="13290" class="Symbol">→</a> <a id="13292" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="13296" class="Symbol">(</a><a id="13297" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="13301" href="/20.07/Substitution/#13266" class="Bound">ρ</a> <a id="13303" class="Symbol">{</a><a id="13304" class="Argument">B</a> <a id="13306" class="Symbol">=</a> <a id="13308" href="/20.07/Substitution/#13253" class="Bound">B</a><a id="13309" class="Symbol">})</a> <a id="13312" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="13314" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="13319" class="Symbol">(</a><a id="13320" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="13324" href="/20.07/Substitution/#13266" class="Bound">ρ</a><a id="13325" class="Symbol">)</a> <a id="13327" class="Symbol">{</a><a id="13328" href="/20.07/Substitution/#13255" class="Bound">C</a><a id="13329" class="Symbol">}</a>
<a id="13331" href="/20.07/Substitution/#13235" class="Function">ren-ext</a> <a id="13339" class="Symbol">{</a><a id="13340" href="/20.07/Substitution/#13340" class="Bound">Γ</a><a id="13341" class="Symbol">}{</a><a id="13343" href="/20.07/Substitution/#13343" class="Bound">Δ</a><a id="13344" class="Symbol">}{</a><a id="13346" href="/20.07/Substitution/#13346" class="Bound">B</a><a id="13347" class="Symbol">}{</a><a id="13349" href="/20.07/Substitution/#13349" class="Bound">C</a><a id="13350" class="Symbol">}{</a><a id="13352" href="/20.07/Substitution/#13352" class="Bound">ρ</a><a id="13353" class="Symbol">}</a> <a id="13355" class="Symbol">=</a> <a id="13357" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="13372" class="Symbol">λ</a> <a id="13374" href="/20.07/Substitution/#13374" class="Bound">x</a> <a id="13376" class="Symbol">→</a> <a id="13378" href="/20.07/Substitution/#13402" class="Function">lemma</a> <a id="13384" class="Symbol">{</a><a id="13385" class="Argument">x</a> <a id="13387" class="Symbol">=</a> <a id="13389" href="/20.07/Substitution/#13374" class="Bound">x</a><a id="13390" class="Symbol">}</a>
  <a id="13394" class="Keyword">where</a>
  <a id="13402" href="/20.07/Substitution/#13402" class="Function">lemma</a> <a id="13408" class="Symbol">:</a> <a id="13410" class="Symbol">∀</a> <a id="13412" class="Symbol">{</a><a id="13413" href="/20.07/Substitution/#13413" class="Bound">x</a> <a id="13415" class="Symbol">:</a> <a id="13417" href="/20.07/Substitution/#13340" class="Bound">Γ</a> <a id="13419" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="13421" href="/20.07/Substitution/#13346" class="Bound">B</a> <a id="13423" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="13425" href="/20.07/Substitution/#13349" class="Bound">C</a><a id="13426" class="Symbol">}</a> <a id="13428" class="Symbol">→</a> <a id="13430" class="Symbol">(</a><a id="13431" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="13435" class="Symbol">(</a><a id="13436" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="13440" href="/20.07/Substitution/#13352" class="Bound">ρ</a><a id="13441" class="Symbol">))</a> <a id="13444" href="/20.07/Substitution/#13413" class="Bound">x</a> <a id="13446" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="13448" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="13453" class="Symbol">(</a><a id="13454" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="13458" href="/20.07/Substitution/#13352" class="Bound">ρ</a><a id="13459" class="Symbol">)</a> <a id="13461" href="/20.07/Substitution/#13413" class="Bound">x</a>
  <a id="13465" href="/20.07/Substitution/#13402" class="Function">lemma</a> <a id="13471" class="Symbol">{</a><a id="13472" class="Argument">x</a> <a id="13474" class="Symbol">=</a> <a id="13476" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="13477" class="Symbol">}</a> <a id="13479" class="Symbol">=</a> <a id="13481" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="13488" href="/20.07/Substitution/#13402" class="Function">lemma</a> <a id="13494" class="Symbol">{</a><a id="13495" class="Argument">x</a> <a id="13497" class="Symbol">=</a> <a id="13499" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="13501" href="/20.07/Substitution/#13501" class="Bound">x</a><a id="13502" class="Symbol">}</a> <a id="13504" class="Symbol">=</a> <a id="13506" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<p>With this lemma in hand, the proof is a straightforward induction on
the term <code class="language-plaintext highlighter-rouge">M</code>.</p>

<pre class="Agda"><a id="rename-subst-ren"></a><a id="13604" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a> <a id="13621" class="Symbol">:</a> <a id="13623" class="Symbol">∀</a> <a id="13625" class="Symbol">{</a><a id="13626" href="/20.07/Substitution/#13626" class="Bound">Γ</a> <a id="13628" href="/20.07/Substitution/#13628" class="Bound">Δ</a><a id="13629" class="Symbol">}{</a><a id="13631" href="/20.07/Substitution/#13631" class="Bound">A</a><a id="13632" class="Symbol">}</a> <a id="13634" class="Symbol">{</a><a id="13635" href="/20.07/Substitution/#13635" class="Bound">ρ</a> <a id="13637" class="Symbol">:</a> <a id="13639" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="13646" href="/20.07/Substitution/#13626" class="Bound">Γ</a> <a id="13648" href="/20.07/Substitution/#13628" class="Bound">Δ</a><a id="13649" class="Symbol">}{</a><a id="13651" href="/20.07/Substitution/#13651" class="Bound">M</a> <a id="13653" class="Symbol">:</a> <a id="13655" href="/20.07/Substitution/#13626" class="Bound">Γ</a> <a id="13657" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="13659" href="/20.07/Substitution/#13631" class="Bound">A</a><a id="13660" class="Symbol">}</a>
                 <a id="13679" class="Symbol">→</a> <a id="13681" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="13688" href="/20.07/Substitution/#13635" class="Bound">ρ</a> <a id="13690" href="/20.07/Substitution/#13651" class="Bound">M</a> <a id="13692" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="13694" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="13696" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="13700" href="/20.07/Substitution/#13635" class="Bound">ρ</a> <a id="13702" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="13704" href="/20.07/Substitution/#13651" class="Bound">M</a>
<a id="13706" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a> <a id="13723" class="Symbol">{</a><a id="13724" class="Argument">M</a> <a id="13726" class="Symbol">=</a> <a id="13728" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="13730" href="/20.07/Substitution/#13730" class="Bound">x</a><a id="13731" class="Symbol">}</a> <a id="13733" class="Symbol">=</a> <a id="13735" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="13740" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a> <a id="13757" class="Symbol">{</a><a id="13758" class="Argument">ρ</a> <a id="13760" class="Symbol">=</a> <a id="13762" href="/20.07/Substitution/#13762" class="Bound">ρ</a><a id="13763" class="Symbol">}{</a><a id="13765" class="Argument">M</a> <a id="13767" class="Symbol">=</a> <a id="13769" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="13771" href="/20.07/Substitution/#13771" class="Bound">N</a><a id="13772" class="Symbol">}</a> <a id="13774" class="Symbol">=</a>
  <a id="13778" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
      <a id="13790" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="13797" href="/20.07/Substitution/#13762" class="Bound">ρ</a> <a id="13799" class="Symbol">(</a><a id="13800" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="13802" href="/20.07/Substitution/#13771" class="Bound">N</a><a id="13803" class="Symbol">)</a>
    <a id="13809" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
      <a id="13819" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="13821" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="13828" class="Symbol">(</a><a id="13829" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="13833" href="/20.07/Substitution/#13762" class="Bound">ρ</a><a id="13834" class="Symbol">)</a> <a id="13836" href="/20.07/Substitution/#13771" class="Bound">N</a>
    <a id="13842" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="13845" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="13850" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="13853" class="Symbol">(</a><a id="13854" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a> <a id="13871" class="Symbol">{</a><a id="13872" class="Argument">ρ</a> <a id="13874" class="Symbol">=</a> <a id="13876" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="13880" href="/20.07/Substitution/#13762" class="Bound">ρ</a><a id="13881" class="Symbol">}{</a><a id="13883" class="Argument">M</a> <a id="13885" class="Symbol">=</a> <a id="13887" href="/20.07/Substitution/#13771" class="Bound">N</a><a id="13888" class="Symbol">})</a> <a id="13891" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
      <a id="13899" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="13901" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="13903" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="13907" class="Symbol">(</a><a id="13908" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="13912" href="/20.07/Substitution/#13762" class="Bound">ρ</a><a id="13913" class="Symbol">)</a> <a id="13915" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="13917" href="/20.07/Substitution/#13771" class="Bound">N</a>
    <a id="13923" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="13926" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="13931" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="13934" class="Symbol">(</a><a id="13935" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="13944" class="Symbol">{</a><a id="13945" class="Argument">M</a> <a id="13947" class="Symbol">=</a> <a id="13949" href="/20.07/Substitution/#13771" class="Bound">N</a><a id="13950" class="Symbol">}</a> <a id="13952" href="/20.07/Substitution/#13235" class="Function">ren-ext</a> <a id="13960" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="13964" class="Symbol">)</a> <a id="13966" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
      <a id="13974" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="13976" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="13978" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="13983" class="Symbol">(</a><a id="13984" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="13988" href="/20.07/Substitution/#13762" class="Bound">ρ</a><a id="13989" class="Symbol">)</a> <a id="13991" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a>  <a id="13994" href="/20.07/Substitution/#13771" class="Bound">N</a>
    <a id="14000" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
      <a id="14010" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="14012" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="14016" href="/20.07/Substitution/#13762" class="Bound">ρ</a> <a id="14018" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="14020" class="Symbol">(</a><a id="14021" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="14023" href="/20.07/Substitution/#13771" class="Bound">N</a><a id="14024" class="Symbol">)</a>
  <a id="14028" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
<a id="14030" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a> <a id="14047" class="Symbol">{</a><a id="14048" class="Argument">M</a> <a id="14050" class="Symbol">=</a> <a id="14052" href="/20.07/Substitution/#14052" class="Bound">L</a> <a id="14054" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="14056" href="/20.07/Substitution/#14056" class="Bound">M</a><a id="14057" class="Symbol">}</a> <a id="14059" class="Symbol">=</a> <a id="14061" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong₂</a> <a id="14067" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_·_</a> <a id="14071" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a> <a id="14088" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a>
</pre>
<p>The substitution <code class="language-plaintext highlighter-rouge">ren S_</code> is equivalent to <code class="language-plaintext highlighter-rouge">↑</code>.</p>

<pre class="Agda"><a id="ren-shift"></a><a id="14163" href="/20.07/Substitution/#14163" class="Function">ren-shift</a> <a id="14173" class="Symbol">:</a> <a id="14175" class="Symbol">∀{</a><a id="14177" href="/20.07/Substitution/#14177" class="Bound">Γ</a><a id="14178" class="Symbol">}{</a><a id="14180" href="/20.07/Substitution/#14180" class="Bound">A</a><a id="14181" class="Symbol">}{</a><a id="14183" href="/20.07/Substitution/#14183" class="Bound">B</a><a id="14184" class="Symbol">}</a>
          <a id="14196" class="Symbol">→</a> <a id="14198" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="14202" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="14205" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="14207" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="14209" class="Symbol">{</a><a id="14210" class="Argument">A</a> <a id="14212" class="Symbol">=</a> <a id="14214" href="/20.07/Substitution/#14183" class="Bound">B</a><a id="14215" class="Symbol">}</a> <a id="14217" class="Symbol">{</a><a id="14218" href="/20.07/Substitution/#14180" class="Bound">A</a><a id="14219" class="Symbol">}</a>
<a id="14221" href="/20.07/Substitution/#14163" class="Function">ren-shift</a> <a id="14231" class="Symbol">{</a><a id="14232" href="/20.07/Substitution/#14232" class="Bound">Γ</a><a id="14233" class="Symbol">}{</a><a id="14235" href="/20.07/Substitution/#14235" class="Bound">A</a><a id="14236" class="Symbol">}{</a><a id="14238" href="/20.07/Substitution/#14238" class="Bound">B</a><a id="14239" class="Symbol">}</a> <a id="14241" class="Symbol">=</a> <a id="14243" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="14258" class="Symbol">λ</a> <a id="14260" href="/20.07/Substitution/#14260" class="Bound">x</a> <a id="14262" class="Symbol">→</a> <a id="14264" href="/20.07/Substitution/#14288" class="Function">lemma</a> <a id="14270" class="Symbol">{</a><a id="14271" class="Argument">x</a> <a id="14273" class="Symbol">=</a> <a id="14275" href="/20.07/Substitution/#14260" class="Bound">x</a><a id="14276" class="Symbol">}</a>
  <a id="14280" class="Keyword">where</a>
  <a id="14288" href="/20.07/Substitution/#14288" class="Function">lemma</a> <a id="14294" class="Symbol">:</a> <a id="14296" class="Symbol">∀</a> <a id="14298" class="Symbol">{</a><a id="14299" href="/20.07/Substitution/#14299" class="Bound">x</a> <a id="14301" class="Symbol">:</a> <a id="14303" href="/20.07/Substitution/#14232" class="Bound">Γ</a> <a id="14305" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="14307" href="/20.07/Substitution/#14235" class="Bound">A</a><a id="14308" class="Symbol">}</a> <a id="14310" class="Symbol">→</a> <a id="14312" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="14316" class="Symbol">(</a><a id="14317" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a><a id="14319" class="Symbol">{</a><a id="14320" class="Argument">B</a> <a id="14322" class="Symbol">=</a> <a id="14324" href="/20.07/Substitution/#14238" class="Bound">B</a><a id="14325" class="Symbol">})</a> <a id="14328" href="/20.07/Substitution/#14299" class="Bound">x</a> <a id="14330" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="14332" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="14334" class="Symbol">{</a><a id="14335" class="Argument">A</a> <a id="14337" class="Symbol">=</a> <a id="14339" href="/20.07/Substitution/#14238" class="Bound">B</a><a id="14340" class="Symbol">}</a> <a id="14342" href="/20.07/Substitution/#14299" class="Bound">x</a>
  <a id="14346" href="/20.07/Substitution/#14288" class="Function">lemma</a> <a id="14352" class="Symbol">{</a><a id="14353" class="Argument">x</a> <a id="14355" class="Symbol">=</a> <a id="14357" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="14358" class="Symbol">}</a> <a id="14360" class="Symbol">=</a> <a id="14362" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="14369" href="/20.07/Substitution/#14288" class="Function">lemma</a> <a id="14375" class="Symbol">{</a><a id="14376" class="Argument">x</a> <a id="14378" class="Symbol">=</a> <a id="14380" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="14382" href="/20.07/Substitution/#14382" class="Bound">x</a><a id="14383" class="Symbol">}</a> <a id="14385" class="Symbol">=</a> <a id="14387" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<p>The substitution <code class="language-plaintext highlighter-rouge">rename S_ M</code> is equivalent to shifting: <code class="language-plaintext highlighter-rouge">⟪ ↑ ⟫ M</code>.</p>

<pre class="Agda"><a id="rename-shift"></a><a id="14471" href="/20.07/Substitution/#14471" class="Function">rename-shift</a> <a id="14484" class="Symbol">:</a> <a id="14486" class="Symbol">∀{</a><a id="14488" href="/20.07/Substitution/#14488" class="Bound">Γ</a><a id="14489" class="Symbol">}</a> <a id="14491" class="Symbol">{</a><a id="14492" href="/20.07/Substitution/#14492" class="Bound">A</a><a id="14493" class="Symbol">}</a> <a id="14495" class="Symbol">{</a><a id="14496" href="/20.07/Substitution/#14496" class="Bound">B</a><a id="14497" class="Symbol">}</a> <a id="14499" class="Symbol">{</a><a id="14500" href="/20.07/Substitution/#14500" class="Bound">M</a> <a id="14502" class="Symbol">:</a> <a id="14504" href="/20.07/Substitution/#14488" class="Bound">Γ</a> <a id="14506" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="14508" href="/20.07/Substitution/#14492" class="Bound">A</a><a id="14509" class="Symbol">}</a>
             <a id="14524" class="Symbol">→</a> <a id="14526" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="14533" class="Symbol">(</a><a id="14534" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a><a id="14536" class="Symbol">{</a><a id="14537" class="Argument">B</a> <a id="14539" class="Symbol">=</a> <a id="14541" href="/20.07/Substitution/#14496" class="Bound">B</a><a id="14542" class="Symbol">})</a> <a id="14545" href="/20.07/Substitution/#14500" class="Bound">M</a> <a id="14547" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="14549" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="14551" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="14553" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="14555" href="/20.07/Substitution/#14500" class="Bound">M</a>
<a id="14557" href="/20.07/Substitution/#14471" class="Function">rename-shift</a><a id="14569" class="Symbol">{</a><a id="14570" href="/20.07/Substitution/#14570" class="Bound">Γ</a><a id="14571" class="Symbol">}{</a><a id="14573" href="/20.07/Substitution/#14573" class="Bound">A</a><a id="14574" class="Symbol">}{</a><a id="14576" href="/20.07/Substitution/#14576" class="Bound">B</a><a id="14577" class="Symbol">}{</a><a id="14579" href="/20.07/Substitution/#14579" class="Bound">M</a><a id="14580" class="Symbol">}</a> <a id="14582" class="Symbol">=</a>
  <a id="14586" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
    <a id="14596" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="14603" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="14606" href="/20.07/Substitution/#14579" class="Bound">M</a>
  <a id="14610" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="14613" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a> <a id="14630" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
    <a id="14636" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="14638" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="14642" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="14645" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="14647" href="/20.07/Substitution/#14579" class="Bound">M</a>
  <a id="14651" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="14654" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="14662" class="Symbol">{</a><a id="14663" class="Argument">M</a> <a id="14665" class="Symbol">=</a> <a id="14667" href="/20.07/Substitution/#14579" class="Bound">M</a><a id="14668" class="Symbol">}</a> <a id="14670" href="/20.07/Substitution/#14163" class="Function">ren-shift</a> <a id="14680" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="14685" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
    <a id="14691" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="14693" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="14695" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="14697" href="/20.07/Substitution/#14579" class="Bound">M</a>
  <a id="14701" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>
<p>Next we prove the equation <code class="language-plaintext highlighter-rouge">exts-cons-shift</code>, which states that <code class="language-plaintext highlighter-rouge">exts</code>
is equivalent to cons’ing Z onto the sequence formed by applying <code class="language-plaintext highlighter-rouge">σ</code>
and then shifting. The proof is by case analysis on the variable <code class="language-plaintext highlighter-rouge">x</code>,
using <code class="language-plaintext highlighter-rouge">rename-subst-ren</code> for when <code class="language-plaintext highlighter-rouge">x = S y</code>.</p>

<pre class="Agda"><a id="exts-cons-shift"></a><a id="14968" href="/20.07/Substitution/#14968" class="Function">exts-cons-shift</a> <a id="14984" class="Symbol">:</a> <a id="14986" class="Symbol">∀{</a><a id="14988" href="/20.07/Substitution/#14988" class="Bound">Γ</a> <a id="14990" href="/20.07/Substitution/#14990" class="Bound">Δ</a><a id="14991" class="Symbol">}</a> <a id="14993" class="Symbol">{</a><a id="14994" href="/20.07/Substitution/#14994" class="Bound">A</a> <a id="14996" href="/20.07/Substitution/#14996" class="Bound">B</a><a id="14997" class="Symbol">}</a> <a id="14999" class="Symbol">{</a><a id="15000" href="/20.07/Substitution/#15000" class="Bound">σ</a> <a id="15002" class="Symbol">:</a> <a id="15004" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="15010" href="/20.07/Substitution/#14988" class="Bound">Γ</a> <a id="15012" href="/20.07/Substitution/#14990" class="Bound">Δ</a><a id="15013" class="Symbol">}</a>
                <a id="15031" class="Symbol">→</a> <a id="15033" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="15038" href="/20.07/Substitution/#15000" class="Bound">σ</a> <a id="15040" class="Symbol">{</a><a id="15041" href="/20.07/Substitution/#14994" class="Bound">A</a><a id="15042" class="Symbol">}</a> <a id="15044" class="Symbol">{</a><a id="15045" href="/20.07/Substitution/#14996" class="Bound">B</a><a id="15046" class="Symbol">}</a> <a id="15048" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="15050" class="Symbol">(</a><a id="15051" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="15053" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="15055" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="15057" class="Symbol">(</a><a id="15058" href="/20.07/Substitution/#15000" class="Bound">σ</a> <a id="15060" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="15062" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="15063" class="Symbol">))</a>
<a id="15066" href="/20.07/Substitution/#14968" class="Function">exts-cons-shift</a> <a id="15082" class="Symbol">=</a> <a id="15084" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="15099" class="Symbol">λ</a> <a id="15101" href="/20.07/Substitution/#15101" class="Bound">x</a> <a id="15103" class="Symbol">→</a> <a id="15105" href="/20.07/Substitution/#15128" class="Function">lemma</a><a id="15110" class="Symbol">{</a><a id="15111" class="Argument">x</a> <a id="15113" class="Symbol">=</a> <a id="15115" href="/20.07/Substitution/#15101" class="Bound">x</a><a id="15116" class="Symbol">}</a>
  <a id="15120" class="Keyword">where</a>
  <a id="15128" href="/20.07/Substitution/#15128" class="Function">lemma</a> <a id="15134" class="Symbol">:</a> <a id="15136" class="Symbol">∀{</a><a id="15138" href="/20.07/Substitution/#15138" class="Bound">Γ</a> <a id="15140" href="/20.07/Substitution/#15140" class="Bound">Δ</a><a id="15141" class="Symbol">}</a> <a id="15143" class="Symbol">{</a><a id="15144" href="/20.07/Substitution/#15144" class="Bound">A</a> <a id="15146" href="/20.07/Substitution/#15146" class="Bound">B</a><a id="15147" class="Symbol">}</a> <a id="15149" class="Symbol">{</a><a id="15150" href="/20.07/Substitution/#15150" class="Bound">σ</a> <a id="15152" class="Symbol">:</a> <a id="15154" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="15160" href="/20.07/Substitution/#15138" class="Bound">Γ</a> <a id="15162" href="/20.07/Substitution/#15140" class="Bound">Δ</a><a id="15163" class="Symbol">}</a> <a id="15165" class="Symbol">{</a><a id="15166" href="/20.07/Substitution/#15166" class="Bound">x</a> <a id="15168" class="Symbol">:</a> <a id="15170" href="/20.07/Substitution/#15138" class="Bound">Γ</a> <a id="15172" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="15174" href="/20.07/Substitution/#15146" class="Bound">B</a> <a id="15176" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="15178" href="/20.07/Substitution/#15144" class="Bound">A</a><a id="15179" class="Symbol">}</a>
                  <a id="15199" class="Symbol">→</a> <a id="15201" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="15206" href="/20.07/Substitution/#15150" class="Bound">σ</a> <a id="15208" href="/20.07/Substitution/#15166" class="Bound">x</a> <a id="15210" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="15212" class="Symbol">(</a><a id="15213" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="15215" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="15217" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="15219" class="Symbol">(</a><a id="15220" href="/20.07/Substitution/#15150" class="Bound">σ</a> <a id="15222" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="15224" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="15225" class="Symbol">))</a> <a id="15228" href="/20.07/Substitution/#15166" class="Bound">x</a>
  <a id="15232" href="/20.07/Substitution/#15128" class="Function">lemma</a> <a id="15238" class="Symbol">{</a><a id="15239" class="Argument">x</a> <a id="15241" class="Symbol">=</a> <a id="15243" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="15244" class="Symbol">}</a> <a id="15246" class="Symbol">=</a> <a id="15248" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="15255" href="/20.07/Substitution/#15128" class="Function">lemma</a> <a id="15261" class="Symbol">{</a><a id="15262" class="Argument">x</a> <a id="15264" class="Symbol">=</a> <a id="15266" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="15268" href="/20.07/Substitution/#15268" class="Bound">y</a><a id="15269" class="Symbol">}</a> <a id="15271" class="Symbol">=</a> <a id="15273" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a>
</pre>
<p>As a corollary, we have a similar correspondence for <code class="language-plaintext highlighter-rouge">ren (ext ρ)</code>.</p>

<pre class="Agda"><a id="ext-cons-Z-shift"></a><a id="15368" href="/20.07/Substitution/#15368" class="Function">ext-cons-Z-shift</a> <a id="15385" class="Symbol">:</a> <a id="15387" class="Symbol">∀{</a><a id="15389" href="/20.07/Substitution/#15389" class="Bound">Γ</a> <a id="15391" href="/20.07/Substitution/#15391" class="Bound">Δ</a><a id="15392" class="Symbol">}</a> <a id="15394" class="Symbol">{</a><a id="15395" href="/20.07/Substitution/#15395" class="Bound">ρ</a> <a id="15397" class="Symbol">:</a> <a id="15399" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="15406" href="/20.07/Substitution/#15389" class="Bound">Γ</a> <a id="15408" href="/20.07/Substitution/#15391" class="Bound">Δ</a><a id="15409" class="Symbol">}{</a><a id="15411" href="/20.07/Substitution/#15411" class="Bound">A</a><a id="15412" class="Symbol">}{</a><a id="15414" href="/20.07/Substitution/#15414" class="Bound">B</a><a id="15415" class="Symbol">}</a>
                 <a id="15434" class="Symbol">→</a> <a id="15436" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="15440" class="Symbol">(</a><a id="15441" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="15445" href="/20.07/Substitution/#15395" class="Bound">ρ</a> <a id="15447" class="Symbol">{</a><a id="15448" class="Argument">B</a> <a id="15450" class="Symbol">=</a> <a id="15452" href="/20.07/Substitution/#15414" class="Bound">B</a><a id="15453" class="Symbol">})</a> <a id="15456" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="15458" class="Symbol">(</a><a id="15459" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="15461" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="15463" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="15465" class="Symbol">(</a><a id="15466" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="15470" href="/20.07/Substitution/#15395" class="Bound">ρ</a> <a id="15472" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="15474" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="15475" class="Symbol">))</a> <a id="15478" class="Symbol">{</a><a id="15479" href="/20.07/Substitution/#15411" class="Bound">A</a><a id="15480" class="Symbol">}</a>
<a id="15482" href="/20.07/Substitution/#15368" class="Function">ext-cons-Z-shift</a> <a id="15499" class="Symbol">{</a><a id="15500" href="/20.07/Substitution/#15500" class="Bound">Γ</a><a id="15501" class="Symbol">}{</a><a id="15503" href="/20.07/Substitution/#15503" class="Bound">Δ</a><a id="15504" class="Symbol">}{</a><a id="15506" href="/20.07/Substitution/#15506" class="Bound">ρ</a><a id="15507" class="Symbol">}{</a><a id="15509" href="/20.07/Substitution/#15509" class="Bound">A</a><a id="15510" class="Symbol">}{</a><a id="15512" href="/20.07/Substitution/#15512" class="Bound">B</a><a id="15513" class="Symbol">}</a> <a id="15515" class="Symbol">=</a>
  <a id="15519" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
    <a id="15529" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="15533" class="Symbol">(</a><a id="15534" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="15538" href="/20.07/Substitution/#15506" class="Bound">ρ</a><a id="15539" class="Symbol">)</a>
  <a id="15543" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="15546" href="/20.07/Substitution/#13235" class="Function">ren-ext</a> <a id="15554" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
    <a id="15560" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="15565" class="Symbol">(</a><a id="15566" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="15570" href="/20.07/Substitution/#15506" class="Bound">ρ</a><a id="15571" class="Symbol">)</a>
  <a id="15575" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="15578" href="/20.07/Substitution/#14968" class="Function">exts-cons-shift</a><a id="15593" class="Symbol">{</a><a id="15594" class="Argument">σ</a> <a id="15596" class="Symbol">=</a> <a id="15598" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="15602" href="/20.07/Substitution/#15506" class="Bound">ρ</a><a id="15603" class="Symbol">}</a> <a id="15605" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
   <a id="15610" class="Symbol">((</a><a id="15612" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="15614" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="15615" class="Symbol">)</a> <a id="15617" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="15619" class="Symbol">(</a><a id="15620" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="15624" href="/20.07/Substitution/#15506" class="Bound">ρ</a> <a id="15626" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="15628" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="15629" class="Symbol">))</a>
  <a id="15634" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>
<p>Finally, the <code class="language-plaintext highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing <code class="language-plaintext highlighter-rouge">M</code>
onto the identity substitution.</p>

<pre class="Agda"><a id="subst-Z-cons-ids"></a><a id="15749" href="/20.07/Substitution/#15749" class="Function">subst-Z-cons-ids</a> <a id="15766" class="Symbol">:</a> <a id="15768" class="Symbol">∀{</a><a id="15770" href="/20.07/Substitution/#15770" class="Bound">Γ</a><a id="15771" class="Symbol">}{</a><a id="15773" href="/20.07/Substitution/#15773" class="Bound">A</a> <a id="15775" href="/20.07/Substitution/#15775" class="Bound">B</a> <a id="15777" class="Symbol">:</a> <a id="15779" href="/20.07/Untyped/#2869" class="Datatype">Type</a><a id="15783" class="Symbol">}{</a><a id="15785" href="/20.07/Substitution/#15785" class="Bound">M</a> <a id="15787" class="Symbol">:</a> <a id="15789" href="/20.07/Substitution/#15770" class="Bound">Γ</a> <a id="15791" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="15793" href="/20.07/Substitution/#15775" class="Bound">B</a><a id="15794" class="Symbol">}</a>
                 <a id="15813" class="Symbol">→</a> <a id="15815" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="15826" href="/20.07/Substitution/#15785" class="Bound">M</a> <a id="15828" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="15830" class="Symbol">(</a><a id="15831" href="/20.07/Substitution/#15785" class="Bound">M</a> <a id="15833" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="15835" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="15838" class="Symbol">)</a> <a id="15840" class="Symbol">{</a><a id="15841" href="/20.07/Substitution/#15773" class="Bound">A</a><a id="15842" class="Symbol">}</a>
<a id="15844" href="/20.07/Substitution/#15749" class="Function">subst-Z-cons-ids</a> <a id="15861" class="Symbol">=</a> <a id="15863" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="15878" class="Symbol">λ</a> <a id="15880" href="/20.07/Substitution/#15880" class="Bound">x</a> <a id="15882" class="Symbol">→</a> <a id="15884" href="/20.07/Substitution/#15908" class="Function">lemma</a> <a id="15890" class="Symbol">{</a><a id="15891" class="Argument">x</a> <a id="15893" class="Symbol">=</a> <a id="15895" href="/20.07/Substitution/#15880" class="Bound">x</a><a id="15896" class="Symbol">}</a>
  <a id="15900" class="Keyword">where</a>
  <a id="15908" href="/20.07/Substitution/#15908" class="Function">lemma</a> <a id="15914" class="Symbol">:</a> <a id="15916" class="Symbol">∀{</a><a id="15918" href="/20.07/Substitution/#15918" class="Bound">Γ</a><a id="15919" class="Symbol">}{</a><a id="15921" href="/20.07/Substitution/#15921" class="Bound">A</a> <a id="15923" href="/20.07/Substitution/#15923" class="Bound">B</a> <a id="15925" class="Symbol">:</a> <a id="15927" href="/20.07/Untyped/#2869" class="Datatype">Type</a><a id="15931" class="Symbol">}{</a><a id="15933" href="/20.07/Substitution/#15933" class="Bound">M</a> <a id="15935" class="Symbol">:</a> <a id="15937" href="/20.07/Substitution/#15918" class="Bound">Γ</a> <a id="15939" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="15941" href="/20.07/Substitution/#15923" class="Bound">B</a><a id="15942" class="Symbol">}{</a><a id="15944" href="/20.07/Substitution/#15944" class="Bound">x</a> <a id="15946" class="Symbol">:</a> <a id="15948" href="/20.07/Substitution/#15918" class="Bound">Γ</a> <a id="15950" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="15952" href="/20.07/Substitution/#15923" class="Bound">B</a> <a id="15954" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="15956" href="/20.07/Substitution/#15921" class="Bound">A</a><a id="15957" class="Symbol">}</a>
                      <a id="15981" class="Symbol">→</a> <a id="15983" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="15994" href="/20.07/Substitution/#15933" class="Bound">M</a> <a id="15996" href="/20.07/Substitution/#15944" class="Bound">x</a> <a id="15998" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="16000" class="Symbol">(</a><a id="16001" href="/20.07/Substitution/#15933" class="Bound">M</a> <a id="16003" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="16005" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="16008" class="Symbol">)</a> <a id="16010" href="/20.07/Substitution/#15944" class="Bound">x</a>
  <a id="16014" href="/20.07/Substitution/#15908" class="Function">lemma</a> <a id="16020" class="Symbol">{</a><a id="16021" class="Argument">x</a> <a id="16023" class="Symbol">=</a> <a id="16025" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="16026" class="Symbol">}</a> <a id="16028" class="Symbol">=</a> <a id="16030" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="16037" href="/20.07/Substitution/#15908" class="Function">lemma</a> <a id="16043" class="Symbol">{</a><a id="16044" class="Argument">x</a> <a id="16046" class="Symbol">=</a> <a id="16048" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="16050" href="/20.07/Substitution/#16050" class="Bound">x</a><a id="16051" class="Symbol">}</a> <a id="16053" class="Symbol">=</a> <a id="16055" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>

<h2 id="proofs-of-sub-abs-sub-id-and-rename-id">Proofs of sub-abs, sub-id, and rename-id</h2>

<p>The equation <code class="language-plaintext highlighter-rouge">sub-abs</code> follows immediately from the equation
<code class="language-plaintext highlighter-rouge">exts-cons-shift</code>.</p>

<pre class="Agda"><a id="sub-abs"></a><a id="16196" href="/20.07/Substitution/#16196" class="Function">sub-abs</a> <a id="16204" class="Symbol">:</a> <a id="16206" class="Symbol">∀{</a><a id="16208" href="/20.07/Substitution/#16208" class="Bound">Γ</a> <a id="16210" href="/20.07/Substitution/#16210" class="Bound">Δ</a><a id="16211" class="Symbol">}</a> <a id="16213" class="Symbol">{</a><a id="16214" href="/20.07/Substitution/#16214" class="Bound">σ</a> <a id="16216" class="Symbol">:</a> <a id="16218" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="16224" href="/20.07/Substitution/#16208" class="Bound">Γ</a> <a id="16226" href="/20.07/Substitution/#16210" class="Bound">Δ</a><a id="16227" class="Symbol">}</a> <a id="16229" class="Symbol">{</a><a id="16230" href="/20.07/Substitution/#16230" class="Bound">N</a> <a id="16232" class="Symbol">:</a> <a id="16234" href="/20.07/Substitution/#16208" class="Bound">Γ</a> <a id="16236" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="16238" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a> <a id="16240" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="16242" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="16243" class="Symbol">}</a>
        <a id="16253" class="Symbol">→</a> <a id="16255" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="16257" href="/20.07/Substitution/#16214" class="Bound">σ</a> <a id="16259" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="16261" class="Symbol">(</a><a id="16262" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="16264" href="/20.07/Substitution/#16230" class="Bound">N</a><a id="16265" class="Symbol">)</a> <a id="16267" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="16269" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="16271" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="16273" class="Symbol">(</a><a id="16274" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="16276" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="16277" class="Symbol">)</a> <a id="16279" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="16281" class="Symbol">(</a><a id="16282" href="/20.07/Substitution/#16214" class="Bound">σ</a> <a id="16284" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="16286" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="16287" class="Symbol">)</a> <a id="16289" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="16291" href="/20.07/Substitution/#16230" class="Bound">N</a>
<a id="16293" href="/20.07/Substitution/#16196" class="Function">sub-abs</a> <a id="16301" class="Symbol">{</a><a id="16302" class="Argument">σ</a> <a id="16304" class="Symbol">=</a> <a id="16306" href="/20.07/Substitution/#16306" class="Bound">σ</a><a id="16307" class="Symbol">}{</a><a id="16309" class="Argument">N</a> <a id="16311" class="Symbol">=</a> <a id="16313" href="/20.07/Substitution/#16313" class="Bound">N</a><a id="16314" class="Symbol">}</a> <a id="16316" class="Symbol">=</a>
   <a id="16321" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
     <a id="16332" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="16334" href="/20.07/Substitution/#16306" class="Bound">σ</a> <a id="16336" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="16338" class="Symbol">(</a><a id="16339" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="16341" href="/20.07/Substitution/#16313" class="Bound">N</a><a id="16342" class="Symbol">)</a>
   <a id="16347" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
     <a id="16356" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="16358" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="16360" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="16365" href="/20.07/Substitution/#16306" class="Bound">σ</a> <a id="16367" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="16369" href="/20.07/Substitution/#16313" class="Bound">N</a>
   <a id="16374" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="16377" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="16382" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="16385" class="Symbol">(</a><a id="16386" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="16394" class="Symbol">{</a><a id="16395" class="Argument">M</a> <a id="16397" class="Symbol">=</a> <a id="16399" href="/20.07/Substitution/#16313" class="Bound">N</a><a id="16400" class="Symbol">}</a> <a id="16402" href="/20.07/Substitution/#14968" class="Function">exts-cons-shift</a> <a id="16418" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="16422" class="Symbol">)</a> <a id="16424" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="16431" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="16433" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="16435" class="Symbol">(</a><a id="16436" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="16438" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="16439" class="Symbol">)</a> <a id="16441" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="16443" class="Symbol">(</a><a id="16444" href="/20.07/Substitution/#16306" class="Bound">σ</a> <a id="16446" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="16448" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="16449" class="Symbol">)</a> <a id="16451" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="16453" href="/20.07/Substitution/#16313" class="Bound">N</a>
   <a id="16458" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>
<p>The proof of <code class="language-plaintext highlighter-rouge">sub-id</code> requires the following lemma which says that
extending the identity substitution produces the identity
substitution.</p>

<pre class="Agda"><a id="exts-ids"></a><a id="16609" href="/20.07/Substitution/#16609" class="Function">exts-ids</a> <a id="16618" class="Symbol">:</a> <a id="16620" class="Symbol">∀{</a><a id="16622" href="/20.07/Substitution/#16622" class="Bound">Γ</a><a id="16623" class="Symbol">}{</a><a id="16625" href="/20.07/Substitution/#16625" class="Bound">A</a> <a id="16627" href="/20.07/Substitution/#16627" class="Bound">B</a><a id="16628" class="Symbol">}</a>
         <a id="16639" class="Symbol">→</a> <a id="16641" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="16646" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="16650" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="16652" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="16656" class="Symbol">{</a><a id="16657" href="/20.07/Substitution/#16622" class="Bound">Γ</a> <a id="16659" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="16661" href="/20.07/Substitution/#16627" class="Bound">B</a><a id="16662" class="Symbol">}</a> <a id="16664" class="Symbol">{</a><a id="16665" href="/20.07/Substitution/#16625" class="Bound">A</a><a id="16666" class="Symbol">}</a>
<a id="16668" href="/20.07/Substitution/#16609" class="Function">exts-ids</a> <a id="16677" class="Symbol">{</a><a id="16678" href="/20.07/Substitution/#16678" class="Bound">Γ</a><a id="16679" class="Symbol">}{</a><a id="16681" href="/20.07/Substitution/#16681" class="Bound">A</a><a id="16682" class="Symbol">}{</a><a id="16684" href="/20.07/Substitution/#16684" class="Bound">B</a><a id="16685" class="Symbol">}</a> <a id="16687" class="Symbol">=</a> <a id="16689" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="16704" href="/20.07/Substitution/#16718" class="Function">lemma</a>
  <a id="16712" class="Keyword">where</a> <a id="16718" href="/20.07/Substitution/#16718" class="Function">lemma</a> <a id="16724" class="Symbol">:</a> <a id="16726" class="Symbol">(</a><a id="16727" href="/20.07/Substitution/#16727" class="Bound">x</a> <a id="16729" class="Symbol">:</a> <a id="16731" href="/20.07/Substitution/#16678" class="Bound">Γ</a> <a id="16733" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="16735" href="/20.07/Substitution/#16684" class="Bound">B</a> <a id="16737" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="16739" href="/20.07/Substitution/#16681" class="Bound">A</a><a id="16740" class="Symbol">)</a> <a id="16742" class="Symbol">→</a> <a id="16744" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="16749" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="16753" href="/20.07/Substitution/#16727" class="Bound">x</a> <a id="16755" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="16757" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="16761" href="/20.07/Substitution/#16727" class="Bound">x</a>
        <a id="16771" href="/20.07/Substitution/#16718" class="Function">lemma</a> <a id="16777" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="16779" class="Symbol">=</a> <a id="16781" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
        <a id="16794" href="/20.07/Substitution/#16718" class="Function">lemma</a> <a id="16800" class="Symbol">(</a><a id="16801" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="16803" href="/20.07/Substitution/#16803" class="Bound">x</a><a id="16804" class="Symbol">)</a> <a id="16806" class="Symbol">=</a> <a id="16808" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<p>The proof of <code class="language-plaintext highlighter-rouge">⟪ ids ⟫ M ≡ M</code> now follows easily by induction on <code class="language-plaintext highlighter-rouge">M</code>,
using <code class="language-plaintext highlighter-rouge">exts-ids</code> in the case for <code class="language-plaintext highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="sub-id"></a><a id="16936" href="/20.07/Substitution/#16936" class="Function">sub-id</a> <a id="16943" class="Symbol">:</a> <a id="16945" class="Symbol">∀{</a><a id="16947" href="/20.07/Substitution/#16947" class="Bound">Γ</a><a id="16948" class="Symbol">}</a> <a id="16950" class="Symbol">{</a><a id="16951" href="/20.07/Substitution/#16951" class="Bound">A</a><a id="16952" class="Symbol">}</a> <a id="16954" class="Symbol">{</a><a id="16955" href="/20.07/Substitution/#16955" class="Bound">M</a> <a id="16957" class="Symbol">:</a> <a id="16959" href="/20.07/Substitution/#16947" class="Bound">Γ</a> <a id="16961" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="16963" href="/20.07/Substitution/#16951" class="Bound">A</a><a id="16964" class="Symbol">}</a>
         <a id="16975" class="Symbol">→</a> <a id="16977" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="16979" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="16983" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="16985" href="/20.07/Substitution/#16955" class="Bound">M</a> <a id="16987" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="16989" href="/20.07/Substitution/#16955" class="Bound">M</a>
<a id="16991" href="/20.07/Substitution/#16936" class="Function">sub-id</a> <a id="16998" class="Symbol">{</a><a id="16999" class="Argument">M</a> <a id="17001" class="Symbol">=</a> <a id="17003" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="17005" href="/20.07/Substitution/#17005" class="Bound">x</a><a id="17006" class="Symbol">}</a> <a id="17008" class="Symbol">=</a> <a id="17010" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="17015" href="/20.07/Substitution/#16936" class="Function">sub-id</a> <a id="17022" class="Symbol">{</a><a id="17023" class="Argument">M</a> <a id="17025" class="Symbol">=</a> <a id="17027" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="17029" href="/20.07/Substitution/#17029" class="Bound">N</a><a id="17030" class="Symbol">}</a> <a id="17032" class="Symbol">=</a>
   <a id="17037" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
     <a id="17048" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="17050" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="17054" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="17056" class="Symbol">(</a><a id="17057" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="17059" href="/20.07/Substitution/#17029" class="Bound">N</a><a id="17060" class="Symbol">)</a>
   <a id="17065" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
     <a id="17074" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="17076" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="17078" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="17083" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="17087" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="17089" href="/20.07/Substitution/#17029" class="Bound">N</a>
   <a id="17094" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="17097" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="17102" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="17105" class="Symbol">(</a><a id="17106" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="17114" class="Symbol">{</a><a id="17115" class="Argument">M</a> <a id="17117" class="Symbol">=</a> <a id="17119" href="/20.07/Substitution/#17029" class="Bound">N</a><a id="17120" class="Symbol">}</a> <a id="17122" href="/20.07/Substitution/#16609" class="Function">exts-ids</a> <a id="17131" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="17135" class="Symbol">)</a>  <a id="17138" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="17145" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="17147" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="17149" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="17153" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="17155" href="/20.07/Substitution/#17029" class="Bound">N</a>
   <a id="17160" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="17163" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="17168" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="17171" href="/20.07/Substitution/#16936" class="Function">sub-id</a> <a id="17178" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="17185" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="17187" href="/20.07/Substitution/#17029" class="Bound">N</a>
   <a id="17192" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
<a id="17194" href="/20.07/Substitution/#16936" class="Function">sub-id</a> <a id="17201" class="Symbol">{</a><a id="17202" class="Argument">M</a> <a id="17204" class="Symbol">=</a> <a id="17206" href="/20.07/Substitution/#17206" class="Bound">L</a> <a id="17208" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="17210" href="/20.07/Substitution/#17210" class="Bound">M</a><a id="17211" class="Symbol">}</a> <a id="17213" class="Symbol">=</a> <a id="17215" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong₂</a> <a id="17221" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_·_</a> <a id="17225" href="/20.07/Substitution/#16936" class="Function">sub-id</a> <a id="17232" href="/20.07/Substitution/#16936" class="Function">sub-id</a>
</pre>
<p>The <code class="language-plaintext highlighter-rouge">rename-id</code> equation is a corollary is <code class="language-plaintext highlighter-rouge">sub-id</code>.</p>

<pre class="Agda"><a id="rename-id"></a><a id="17302" href="/20.07/Substitution/#17302" class="Function">rename-id</a> <a id="17312" class="Symbol">:</a> <a id="17314" class="Symbol">∀</a> <a id="17316" class="Symbol">{</a><a id="17317" href="/20.07/Substitution/#17317" class="Bound">Γ</a><a id="17318" class="Symbol">}{</a><a id="17320" href="/20.07/Substitution/#17320" class="Bound">A</a><a id="17321" class="Symbol">}</a> <a id="17323" class="Symbol">{</a><a id="17324" href="/20.07/Substitution/#17324" class="Bound">M</a> <a id="17326" class="Symbol">:</a> <a id="17328" href="/20.07/Substitution/#17317" class="Bound">Γ</a> <a id="17330" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="17332" href="/20.07/Substitution/#17320" class="Bound">A</a><a id="17333" class="Symbol">}</a>
  <a id="17337" class="Symbol">→</a> <a id="17339" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="17346" class="Symbol">(λ</a> <a id="17349" class="Symbol">{</a><a id="17350" href="/20.07/Substitution/#17350" class="Bound">A</a><a id="17351" class="Symbol">}</a> <a id="17353" href="/20.07/Substitution/#17353" class="Bound">x</a> <a id="17355" class="Symbol">→</a> <a id="17357" href="/20.07/Substitution/#17353" class="Bound">x</a><a id="17358" class="Symbol">)</a> <a id="17360" href="/20.07/Substitution/#17324" class="Bound">M</a> <a id="17362" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="17364" href="/20.07/Substitution/#17324" class="Bound">M</a>
<a id="17366" href="/20.07/Substitution/#17302" class="Function">rename-id</a> <a id="17376" class="Symbol">{</a><a id="17377" class="Argument">M</a> <a id="17379" class="Symbol">=</a> <a id="17381" href="/20.07/Substitution/#17381" class="Bound">M</a><a id="17382" class="Symbol">}</a> <a id="17384" class="Symbol">=</a>
   <a id="17389" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
     <a id="17400" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="17407" class="Symbol">(λ</a> <a id="17410" class="Symbol">{</a><a id="17411" href="/20.07/Substitution/#17411" class="Bound">A</a><a id="17412" class="Symbol">}</a> <a id="17414" href="/20.07/Substitution/#17414" class="Bound">x</a> <a id="17416" class="Symbol">→</a> <a id="17418" href="/20.07/Substitution/#17414" class="Bound">x</a><a id="17419" class="Symbol">)</a> <a id="17421" href="/20.07/Substitution/#17381" class="Bound">M</a>
   <a id="17426" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="17429" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a>  <a id="17447" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="17454" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="17456" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="17460" class="Symbol">(λ</a> <a id="17463" class="Symbol">{</a><a id="17464" href="/20.07/Substitution/#17464" class="Bound">A</a><a id="17465" class="Symbol">}</a> <a id="17467" href="/20.07/Substitution/#17467" class="Bound">x</a> <a id="17469" class="Symbol">→</a> <a id="17471" href="/20.07/Substitution/#17467" class="Bound">x</a><a id="17472" class="Symbol">)</a> <a id="17474" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="17476" href="/20.07/Substitution/#17381" class="Bound">M</a>
   <a id="17481" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
     <a id="17490" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="17492" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="17496" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="17498" href="/20.07/Substitution/#17381" class="Bound">M</a>
   <a id="17503" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="17506" href="/20.07/Substitution/#16936" class="Function">sub-id</a>  <a id="17514" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="17521" href="/20.07/Substitution/#17381" class="Bound">M</a>
   <a id="17526" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>
<h2 id="proof-of-sub-idr">Proof of sub-idR</h2>

<p>The proof of <code class="language-plaintext highlighter-rouge">sub-idR</code> follows directly from <code class="language-plaintext highlighter-rouge">sub-id</code>.</p>

<pre class="Agda"><a id="sub-idR"></a><a id="17614" href="/20.07/Substitution/#17614" class="Function">sub-idR</a> <a id="17622" class="Symbol">:</a> <a id="17624" class="Symbol">∀{</a><a id="17626" href="/20.07/Substitution/#17626" class="Bound">Γ</a> <a id="17628" href="/20.07/Substitution/#17628" class="Bound">Δ</a><a id="17629" class="Symbol">}</a> <a id="17631" class="Symbol">{</a><a id="17632" href="/20.07/Substitution/#17632" class="Bound">σ</a> <a id="17634" class="Symbol">:</a> <a id="17636" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="17642" href="/20.07/Substitution/#17626" class="Bound">Γ</a> <a id="17644" href="/20.07/Substitution/#17628" class="Bound">Δ</a><a id="17645" class="Symbol">}</a> <a id="17647" class="Symbol">{</a><a id="17648" href="/20.07/Substitution/#17648" class="Bound">A</a><a id="17649" class="Symbol">}</a>
       <a id="17658" class="Symbol">→</a> <a id="17660" class="Symbol">(</a><a id="17661" href="/20.07/Substitution/#17632" class="Bound">σ</a> <a id="17663" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="17665" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="17668" class="Symbol">)</a> <a id="17670" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="17672" href="/20.07/Substitution/#17632" class="Bound">σ</a> <a id="17674" class="Symbol">{</a><a id="17675" href="/20.07/Substitution/#17648" class="Bound">A</a><a id="17676" class="Symbol">}</a>
<a id="17678" href="/20.07/Substitution/#17614" class="Function">sub-idR</a> <a id="17686" class="Symbol">{</a><a id="17687" href="/20.07/Substitution/#17687" class="Bound">Γ</a><a id="17688" class="Symbol">}{</a><a id="17690" class="Argument">σ</a> <a id="17692" class="Symbol">=</a> <a id="17694" href="/20.07/Substitution/#17694" class="Bound">σ</a><a id="17695" class="Symbol">}{</a><a id="17697" href="/20.07/Substitution/#17697" class="Bound">A</a><a id="17698" class="Symbol">}</a> <a id="17700" class="Symbol">=</a>
          <a id="17712" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
            <a id="17730" href="/20.07/Substitution/#17694" class="Bound">σ</a> <a id="17732" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="17734" href="/20.07/Substitution/#3046" class="Function">ids</a>
          <a id="17748" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
            <a id="17764" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="17766" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="17770" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="17772" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="17774" href="/20.07/Substitution/#17694" class="Bound">σ</a>
          <a id="17786" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="17789" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="17804" class="Symbol">(λ</a> <a id="17807" href="/20.07/Substitution/#17807" class="Bound">x</a> <a id="17809" class="Symbol">→</a> <a id="17811" href="/20.07/Substitution/#16936" class="Function">sub-id</a><a id="17817" class="Symbol">)</a> <a id="17819" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
            <a id="17833" href="/20.07/Substitution/#17694" class="Bound">σ</a>
          <a id="17845" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>

<h2 id="proof-of-sub-sub">Proof of sub-sub</h2>

<p>The <code class="language-plaintext highlighter-rouge">sub-sub</code> equation states that sequenced substitutions <code class="language-plaintext highlighter-rouge">σ ⨟ τ</code>
are equivalent to first applying <code class="language-plaintext highlighter-rouge">σ</code> then applying <code class="language-plaintext highlighter-rouge">τ</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ τ ⟫ ⟪ σ ⟫ M  ≡ ⟪ σ ⨟ τ ⟫ M
</code></pre></div></div>

<p>The proof requires several lemmas. First, we need to prove the
specialization for renaming.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (rename ρ′ M) ≡ rename (ρ ∘ ρ′) M
</code></pre></div></div>

<p>This in turn requires the following lemma about <code class="language-plaintext highlighter-rouge">ext</code>.</p>

<pre class="Agda"><a id="compose-ext"></a><a id="18233" href="/20.07/Substitution/#18233" class="Function">compose-ext</a> <a id="18245" class="Symbol">:</a> <a id="18247" class="Symbol">∀{</a><a id="18249" href="/20.07/Substitution/#18249" class="Bound">Γ</a> <a id="18251" href="/20.07/Substitution/#18251" class="Bound">Δ</a> <a id="18253" href="/20.07/Substitution/#18253" class="Bound">Σ</a><a id="18254" class="Symbol">}{</a><a id="18256" href="/20.07/Substitution/#18256" class="Bound">ρ</a> <a id="18258" class="Symbol">:</a> <a id="18260" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="18267" href="/20.07/Substitution/#18251" class="Bound">Δ</a> <a id="18269" href="/20.07/Substitution/#18253" class="Bound">Σ</a><a id="18270" class="Symbol">}</a> <a id="18272" class="Symbol">{</a><a id="18273" href="/20.07/Substitution/#18273" class="Bound">ρ′</a> <a id="18276" class="Symbol">:</a> <a id="18278" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="18285" href="/20.07/Substitution/#18249" class="Bound">Γ</a> <a id="18287" href="/20.07/Substitution/#18251" class="Bound">Δ</a><a id="18288" class="Symbol">}</a> <a id="18290" class="Symbol">{</a><a id="18291" href="/20.07/Substitution/#18291" class="Bound">A</a> <a id="18293" href="/20.07/Substitution/#18293" class="Bound">B</a><a id="18294" class="Symbol">}</a>
            <a id="18308" class="Symbol">→</a> <a id="18310" class="Symbol">((</a><a id="18312" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="18316" href="/20.07/Substitution/#18256" class="Bound">ρ</a><a id="18317" class="Symbol">)</a> <a id="18319" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="18321" class="Symbol">(</a><a id="18322" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="18326" href="/20.07/Substitution/#18273" class="Bound">ρ′</a><a id="18328" class="Symbol">))</a> <a id="18331" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="18333" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="18337" class="Symbol">(</a><a id="18338" href="/20.07/Substitution/#18256" class="Bound">ρ</a> <a id="18340" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="18342" href="/20.07/Substitution/#18273" class="Bound">ρ′</a><a id="18344" class="Symbol">)</a> <a id="18346" class="Symbol">{</a><a id="18347" href="/20.07/Substitution/#18293" class="Bound">B</a><a id="18348" class="Symbol">}</a> <a id="18350" class="Symbol">{</a><a id="18351" href="/20.07/Substitution/#18291" class="Bound">A</a><a id="18352" class="Symbol">}</a>
<a id="18354" href="/20.07/Substitution/#18233" class="Function">compose-ext</a> <a id="18366" class="Symbol">=</a> <a id="18368" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="18383" class="Symbol">λ</a> <a id="18385" href="/20.07/Substitution/#18385" class="Bound">x</a> <a id="18387" class="Symbol">→</a> <a id="18389" href="/20.07/Substitution/#18413" class="Function">lemma</a> <a id="18395" class="Symbol">{</a><a id="18396" class="Argument">x</a> <a id="18398" class="Symbol">=</a> <a id="18400" href="/20.07/Substitution/#18385" class="Bound">x</a><a id="18401" class="Symbol">}</a>
  <a id="18405" class="Keyword">where</a>
  <a id="18413" href="/20.07/Substitution/#18413" class="Function">lemma</a> <a id="18419" class="Symbol">:</a> <a id="18421" class="Symbol">∀{</a><a id="18423" href="/20.07/Substitution/#18423" class="Bound">Γ</a> <a id="18425" href="/20.07/Substitution/#18425" class="Bound">Δ</a> <a id="18427" href="/20.07/Substitution/#18427" class="Bound">Σ</a><a id="18428" class="Symbol">}{</a><a id="18430" href="/20.07/Substitution/#18430" class="Bound">ρ</a> <a id="18432" class="Symbol">:</a> <a id="18434" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="18441" href="/20.07/Substitution/#18425" class="Bound">Δ</a> <a id="18443" href="/20.07/Substitution/#18427" class="Bound">Σ</a><a id="18444" class="Symbol">}</a> <a id="18446" class="Symbol">{</a><a id="18447" href="/20.07/Substitution/#18447" class="Bound">ρ′</a> <a id="18450" class="Symbol">:</a> <a id="18452" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="18459" href="/20.07/Substitution/#18423" class="Bound">Γ</a> <a id="18461" href="/20.07/Substitution/#18425" class="Bound">Δ</a><a id="18462" class="Symbol">}</a> <a id="18464" class="Symbol">{</a><a id="18465" href="/20.07/Substitution/#18465" class="Bound">A</a> <a id="18467" href="/20.07/Substitution/#18467" class="Bound">B</a><a id="18468" class="Symbol">}</a> <a id="18470" class="Symbol">{</a><a id="18471" href="/20.07/Substitution/#18471" class="Bound">x</a> <a id="18473" class="Symbol">:</a> <a id="18475" href="/20.07/Substitution/#18423" class="Bound">Γ</a> <a id="18477" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="18479" href="/20.07/Substitution/#18467" class="Bound">B</a> <a id="18481" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="18483" href="/20.07/Substitution/#18465" class="Bound">A</a><a id="18484" class="Symbol">}</a>
              <a id="18500" class="Symbol">→</a> <a id="18502" class="Symbol">((</a><a id="18504" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="18508" href="/20.07/Substitution/#18430" class="Bound">ρ</a><a id="18509" class="Symbol">)</a> <a id="18511" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="18513" class="Symbol">(</a><a id="18514" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="18518" href="/20.07/Substitution/#18447" class="Bound">ρ′</a><a id="18520" class="Symbol">))</a> <a id="18523" href="/20.07/Substitution/#18471" class="Bound">x</a> <a id="18525" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="18527" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="18531" class="Symbol">(</a><a id="18532" href="/20.07/Substitution/#18430" class="Bound">ρ</a> <a id="18534" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="18536" href="/20.07/Substitution/#18447" class="Bound">ρ′</a><a id="18538" class="Symbol">)</a> <a id="18540" href="/20.07/Substitution/#18471" class="Bound">x</a>
  <a id="18544" href="/20.07/Substitution/#18413" class="Function">lemma</a> <a id="18550" class="Symbol">{</a><a id="18551" class="Argument">x</a> <a id="18553" class="Symbol">=</a> <a id="18555" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="18556" class="Symbol">}</a> <a id="18558" class="Symbol">=</a> <a id="18560" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="18567" href="/20.07/Substitution/#18413" class="Function">lemma</a> <a id="18573" class="Symbol">{</a><a id="18574" class="Argument">x</a> <a id="18576" class="Symbol">=</a> <a id="18578" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="18580" href="/20.07/Substitution/#18580" class="Bound">x</a><a id="18581" class="Symbol">}</a> <a id="18583" class="Symbol">=</a> <a id="18585" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>
<p>To prove that composing renamings is equivalent to applying one after
the other using <code class="language-plaintext highlighter-rouge">rename</code>, we proceed by induction on the term <code class="language-plaintext highlighter-rouge">M</code>,
using the <code class="language-plaintext highlighter-rouge">compose-ext</code> lemma in the case for <code class="language-plaintext highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="compose-rename"></a><a id="18794" href="/20.07/Substitution/#18794" class="Function">compose-rename</a> <a id="18809" class="Symbol">:</a> <a id="18811" class="Symbol">∀{</a><a id="18813" href="/20.07/Substitution/#18813" class="Bound">Γ</a> <a id="18815" href="/20.07/Substitution/#18815" class="Bound">Δ</a> <a id="18817" href="/20.07/Substitution/#18817" class="Bound">Σ</a><a id="18818" class="Symbol">}{</a><a id="18820" href="/20.07/Substitution/#18820" class="Bound">A</a><a id="18821" class="Symbol">}{</a><a id="18823" href="/20.07/Substitution/#18823" class="Bound">M</a> <a id="18825" class="Symbol">:</a> <a id="18827" href="/20.07/Substitution/#18813" class="Bound">Γ</a> <a id="18829" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="18831" href="/20.07/Substitution/#18820" class="Bound">A</a><a id="18832" class="Symbol">}{</a><a id="18834" href="/20.07/Substitution/#18834" class="Bound">ρ</a> <a id="18836" class="Symbol">:</a> <a id="18838" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="18845" href="/20.07/Substitution/#18815" class="Bound">Δ</a> <a id="18847" href="/20.07/Substitution/#18817" class="Bound">Σ</a><a id="18848" class="Symbol">}{</a><a id="18850" href="/20.07/Substitution/#18850" class="Bound">ρ′</a> <a id="18853" class="Symbol">:</a> <a id="18855" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="18862" href="/20.07/Substitution/#18813" class="Bound">Γ</a> <a id="18864" href="/20.07/Substitution/#18815" class="Bound">Δ</a><a id="18865" class="Symbol">}</a>
  <a id="18869" class="Symbol">→</a> <a id="18871" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="18878" href="/20.07/Substitution/#18834" class="Bound">ρ</a> <a id="18880" class="Symbol">(</a><a id="18881" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="18888" href="/20.07/Substitution/#18850" class="Bound">ρ′</a> <a id="18891" href="/20.07/Substitution/#18823" class="Bound">M</a><a id="18892" class="Symbol">)</a> <a id="18894" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="18896" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="18903" class="Symbol">(</a><a id="18904" href="/20.07/Substitution/#18834" class="Bound">ρ</a> <a id="18906" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="18908" href="/20.07/Substitution/#18850" class="Bound">ρ′</a><a id="18910" class="Symbol">)</a> <a id="18912" href="/20.07/Substitution/#18823" class="Bound">M</a>
<a id="18914" href="/20.07/Substitution/#18794" class="Function">compose-rename</a> <a id="18929" class="Symbol">{</a><a id="18930" class="Argument">M</a> <a id="18932" class="Symbol">=</a> <a id="18934" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="18936" href="/20.07/Substitution/#18936" class="Bound">x</a><a id="18937" class="Symbol">}</a> <a id="18939" class="Symbol">=</a> <a id="18941" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="18946" href="/20.07/Substitution/#18794" class="Function">compose-rename</a> <a id="18961" class="Symbol">{</a><a id="18962" href="/20.07/Substitution/#18962" class="Bound">Γ</a><a id="18963" class="Symbol">}{</a><a id="18965" href="/20.07/Substitution/#18965" class="Bound">Δ</a><a id="18966" class="Symbol">}{</a><a id="18968" href="/20.07/Substitution/#18968" class="Bound">Σ</a><a id="18969" class="Symbol">}{</a><a id="18971" href="/20.07/Substitution/#18971" class="Bound">A</a><a id="18972" class="Symbol">}{</a><a id="18974" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="18976" href="/20.07/Substitution/#18976" class="Bound">N</a><a id="18977" class="Symbol">}{</a><a id="18979" href="/20.07/Substitution/#18979" class="Bound">ρ</a><a id="18980" class="Symbol">}{</a><a id="18982" href="/20.07/Substitution/#18982" class="Bound">ρ′</a><a id="18984" class="Symbol">}</a> <a id="18986" class="Symbol">=</a> <a id="18988" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="18993" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="18996" href="/20.07/Substitution/#19008" class="Function">G</a>
  <a id="19000" class="Keyword">where</a>
  <a id="19008" href="/20.07/Substitution/#19008" class="Function">G</a> <a id="19010" class="Symbol">:</a> <a id="19012" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19019" class="Symbol">(</a><a id="19020" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19024" href="/20.07/Substitution/#18979" class="Bound">ρ</a><a id="19025" class="Symbol">)</a> <a id="19027" class="Symbol">(</a><a id="19028" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19035" class="Symbol">(</a><a id="19036" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19040" href="/20.07/Substitution/#18982" class="Bound">ρ′</a><a id="19042" class="Symbol">)</a> <a id="19044" href="/20.07/Substitution/#18976" class="Bound">N</a><a id="19045" class="Symbol">)</a> <a id="19047" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="19049" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19056" class="Symbol">(</a><a id="19057" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19061" class="Symbol">(</a><a id="19062" href="/20.07/Substitution/#18979" class="Bound">ρ</a> <a id="19064" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="19066" href="/20.07/Substitution/#18982" class="Bound">ρ′</a><a id="19068" class="Symbol">))</a> <a id="19071" href="/20.07/Substitution/#18976" class="Bound">N</a>
  <a id="19075" href="/20.07/Substitution/#19008" class="Function">G</a> <a id="19077" class="Symbol">=</a>
      <a id="19085" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
        <a id="19099" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19106" class="Symbol">(</a><a id="19107" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19111" href="/20.07/Substitution/#18979" class="Bound">ρ</a><a id="19112" class="Symbol">)</a> <a id="19114" class="Symbol">(</a><a id="19115" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19122" class="Symbol">(</a><a id="19123" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19127" href="/20.07/Substitution/#18982" class="Bound">ρ′</a><a id="19129" class="Symbol">)</a> <a id="19131" href="/20.07/Substitution/#18976" class="Bound">N</a><a id="19132" class="Symbol">)</a>
      <a id="19140" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="19143" href="/20.07/Substitution/#18794" class="Function">compose-rename</a><a id="19157" class="Symbol">{</a><a id="19158" class="Argument">ρ</a> <a id="19160" class="Symbol">=</a> <a id="19162" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19166" href="/20.07/Substitution/#18979" class="Bound">ρ</a><a id="19167" class="Symbol">}{</a><a id="19169" class="Argument">ρ′</a> <a id="19172" class="Symbol">=</a> <a id="19174" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19178" href="/20.07/Substitution/#18982" class="Bound">ρ′</a><a id="19180" class="Symbol">}</a> <a id="19182" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
        <a id="19192" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19199" class="Symbol">((</a><a id="19201" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19205" href="/20.07/Substitution/#18979" class="Bound">ρ</a><a id="19206" class="Symbol">)</a> <a id="19208" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="19210" class="Symbol">(</a><a id="19211" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19215" href="/20.07/Substitution/#18982" class="Bound">ρ′</a><a id="19217" class="Symbol">))</a> <a id="19220" href="/20.07/Substitution/#18976" class="Bound">N</a>
      <a id="19228" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="19231" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="19243" href="/20.07/Substitution/#18233" class="Function">compose-ext</a> <a id="19255" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
        <a id="19265" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19272" class="Symbol">(</a><a id="19273" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="19277" class="Symbol">(</a><a id="19278" href="/20.07/Substitution/#18979" class="Bound">ρ</a> <a id="19280" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="19282" href="/20.07/Substitution/#18982" class="Bound">ρ′</a><a id="19284" class="Symbol">))</a> <a id="19287" href="/20.07/Substitution/#18976" class="Bound">N</a>
      <a id="19295" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
<a id="19297" href="/20.07/Substitution/#18794" class="Function">compose-rename</a> <a id="19312" class="Symbol">{</a><a id="19313" class="Argument">M</a> <a id="19315" class="Symbol">=</a> <a id="19317" href="/20.07/Substitution/#19317" class="Bound">L</a> <a id="19319" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="19321" href="/20.07/Substitution/#19321" class="Bound">M</a><a id="19322" class="Symbol">}</a> <a id="19324" class="Symbol">=</a> <a id="19326" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong₂</a> <a id="19332" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_·_</a> <a id="19336" href="/20.07/Substitution/#18794" class="Function">compose-rename</a> <a id="19351" href="/20.07/Substitution/#18794" class="Function">compose-rename</a>
</pre>
<p>The next lemma states that if a renaming and substitution commute on
variables, then they also commute on terms. We explain the proof in
detail below.</p>

<pre class="Agda"><a id="commute-subst-rename"></a><a id="19527" href="/20.07/Substitution/#19527" class="Function">commute-subst-rename</a> <a id="19548" class="Symbol">:</a> <a id="19550" class="Symbol">∀{</a><a id="19552" href="/20.07/Substitution/#19552" class="Bound">Γ</a> <a id="19554" href="/20.07/Substitution/#19554" class="Bound">Δ</a><a id="19555" class="Symbol">}{</a><a id="19557" href="/20.07/Substitution/#19557" class="Bound">M</a> <a id="19559" class="Symbol">:</a> <a id="19561" href="/20.07/Substitution/#19552" class="Bound">Γ</a> <a id="19563" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="19565" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="19566" class="Symbol">}{</a><a id="19568" href="/20.07/Substitution/#19568" class="Bound">σ</a> <a id="19570" class="Symbol">:</a> <a id="19572" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="19578" href="/20.07/Substitution/#19552" class="Bound">Γ</a> <a id="19580" href="/20.07/Substitution/#19554" class="Bound">Δ</a><a id="19581" class="Symbol">}</a>
                        <a id="19607" class="Symbol">{</a><a id="19608" href="/20.07/Substitution/#19608" class="Bound">ρ</a> <a id="19610" class="Symbol">:</a> <a id="19612" class="Symbol">∀{</a><a id="19614" href="/20.07/Substitution/#19614" class="Bound">Γ</a><a id="19615" class="Symbol">}</a> <a id="19617" class="Symbol">→</a> <a id="19619" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="19626" href="/20.07/Substitution/#19614" class="Bound">Γ</a> <a id="19628" class="Symbol">(</a><a id="19629" href="/20.07/Substitution/#19614" class="Bound">Γ</a> <a id="19631" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="19633" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="19634" class="Symbol">)}</a>
     <a id="19642" class="Symbol">→</a> <a id="19644" class="Symbol">(∀{</a><a id="19647" href="/20.07/Substitution/#19647" class="Bound">x</a> <a id="19649" class="Symbol">:</a> <a id="19651" href="/20.07/Substitution/#19552" class="Bound">Γ</a> <a id="19653" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="19655" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="19656" class="Symbol">}</a> <a id="19658" class="Symbol">→</a> <a id="19660" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="19665" href="/20.07/Substitution/#19568" class="Bound">σ</a> <a id="19667" class="Symbol">{</a><a id="19668" class="Argument">B</a> <a id="19670" class="Symbol">=</a> <a id="19672" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="19673" class="Symbol">}</a> <a id="19675" class="Symbol">(</a><a id="19676" href="/20.07/Substitution/#19608" class="Bound">ρ</a> <a id="19678" href="/20.07/Substitution/#19647" class="Bound">x</a><a id="19679" class="Symbol">)</a> <a id="19681" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="19683" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19690" href="/20.07/Substitution/#19608" class="Bound">ρ</a> <a id="19692" class="Symbol">(</a><a id="19693" href="/20.07/Substitution/#19568" class="Bound">σ</a> <a id="19695" href="/20.07/Substitution/#19647" class="Bound">x</a><a id="19696" class="Symbol">))</a>
     <a id="19704" class="Symbol">→</a> <a id="19706" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="19712" class="Symbol">(</a><a id="19713" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="19718" href="/20.07/Substitution/#19568" class="Bound">σ</a> <a id="19720" class="Symbol">{</a><a id="19721" class="Argument">B</a> <a id="19723" class="Symbol">=</a> <a id="19725" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="19726" class="Symbol">})</a> <a id="19729" class="Symbol">(</a><a id="19730" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19737" href="/20.07/Substitution/#19608" class="Bound">ρ</a> <a id="19739" href="/20.07/Substitution/#19557" class="Bound">M</a><a id="19740" class="Symbol">)</a> <a id="19742" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="19744" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="19751" href="/20.07/Substitution/#19608" class="Bound">ρ</a> <a id="19753" class="Symbol">(</a><a id="19754" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="19760" href="/20.07/Substitution/#19568" class="Bound">σ</a> <a id="19762" href="/20.07/Substitution/#19557" class="Bound">M</a><a id="19763" class="Symbol">)</a>
<a id="19765" href="/20.07/Substitution/#19527" class="Function">commute-subst-rename</a> <a id="19786" class="Symbol">{</a><a id="19787" class="Argument">M</a> <a id="19789" class="Symbol">=</a> <a id="19791" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="19793" href="/20.07/Substitution/#19793" class="Bound">x</a><a id="19794" class="Symbol">}</a> <a id="19796" href="/20.07/Substitution/#19796" class="Bound">r</a> <a id="19798" class="Symbol">=</a> <a id="19800" href="/20.07/Substitution/#19796" class="Bound">r</a>
<a id="19802" href="/20.07/Substitution/#19527" class="Function">commute-subst-rename</a><a id="19822" class="Symbol">{</a><a id="19823" href="/20.07/Substitution/#19823" class="Bound">Γ</a><a id="19824" class="Symbol">}{</a><a id="19826" href="/20.07/Substitution/#19826" class="Bound">Δ</a><a id="19827" class="Symbol">}{</a><a id="19829" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="19831" href="/20.07/Substitution/#19831" class="Bound">N</a><a id="19832" class="Symbol">}{</a><a id="19834" href="/20.07/Substitution/#19834" class="Bound">σ</a><a id="19835" class="Symbol">}{</a><a id="19837" href="/20.07/Substitution/#19837" class="Bound">ρ</a><a id="19838" class="Symbol">}</a> <a id="19840" href="/20.07/Substitution/#19840" class="Bound">r</a> <a id="19842" class="Symbol">=</a>
   <a id="19847" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="19852" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="19855" class="Symbol">(</a><a id="19856" href="/20.07/Substitution/#19527" class="Function">commute-subst-rename</a><a id="19876" class="Symbol">{</a><a id="19877" href="/20.07/Substitution/#19823" class="Bound">Γ</a> <a id="19879" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="19881" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="19882" class="Symbol">}{</a><a id="19884" href="/20.07/Substitution/#19826" class="Bound">Δ</a> <a id="19886" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="19888" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="19889" class="Symbol">}{</a><a id="19891" href="/20.07/Substitution/#19831" class="Bound">N</a><a id="19892" class="Symbol">}</a>
               <a id="19909" class="Symbol">{</a><a id="19910" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="19915" href="/20.07/Substitution/#19834" class="Bound">σ</a><a id="19916" class="Symbol">}{</a><a id="19918" class="Argument">ρ</a> <a id="19920" class="Symbol">=</a> <a id="19922" href="/20.07/Substitution/#19955" class="Function">ρ′</a><a id="19924" class="Symbol">}</a> <a id="19926" class="Symbol">(λ</a> <a id="19929" class="Symbol">{</a><a id="19930" href="/20.07/Substitution/#19930" class="Bound">x</a><a id="19931" class="Symbol">}</a> <a id="19933" class="Symbol">→</a> <a id="19935" href="/20.07/Substitution/#20028" class="Function">H</a> <a id="19937" class="Symbol">{</a><a id="19938" href="/20.07/Substitution/#19930" class="Bound">x</a><a id="19939" class="Symbol">}))</a>
   <a id="19946" class="Keyword">where</a>
   <a id="19955" href="/20.07/Substitution/#19955" class="Function">ρ′</a> <a id="19958" class="Symbol">:</a> <a id="19960" class="Symbol">∀</a> <a id="19962" class="Symbol">{</a><a id="19963" href="/20.07/Substitution/#19963" class="Bound">Γ</a><a id="19964" class="Symbol">}</a> <a id="19966" class="Symbol">→</a> <a id="19968" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="19975" href="/20.07/Substitution/#19963" class="Bound">Γ</a> <a id="19977" class="Symbol">(</a><a id="19978" href="/20.07/Substitution/#19963" class="Bound">Γ</a> <a id="19980" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="19982" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="19983" class="Symbol">)</a>
   <a id="19988" href="/20.07/Substitution/#19955" class="Function">ρ′</a> <a id="19991" class="Symbol">{</a><a id="19992" href="/20.07/Untyped/#3175" class="InductiveConstructor">∅</a><a id="19993" class="Symbol">}</a> <a id="19995" class="Symbol">=</a> <a id="19997" class="Symbol">λ</a> <a id="19999" class="Symbol">()</a>
   <a id="20005" href="/20.07/Substitution/#19955" class="Function">ρ′</a> <a id="20008" class="Symbol">{</a><a id="20009" href="/20.07/Substitution/#20009" class="Bound">Γ</a> <a id="20011" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="20013" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="20014" class="Symbol">}</a> <a id="20016" class="Symbol">=</a> <a id="20018" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="20022" href="/20.07/Substitution/#19837" class="Bound">ρ</a>

   <a id="20028" href="/20.07/Substitution/#20028" class="Function">H</a> <a id="20030" class="Symbol">:</a> <a id="20032" class="Symbol">{</a><a id="20033" href="/20.07/Substitution/#20033" class="Bound">x</a> <a id="20035" class="Symbol">:</a> <a id="20037" href="/20.07/Substitution/#19823" class="Bound">Γ</a> <a id="20039" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="20041" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a> <a id="20043" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="20045" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="20046" class="Symbol">}</a> <a id="20048" class="Symbol">→</a> <a id="20050" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="20055" class="Symbol">(</a><a id="20056" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="20061" href="/20.07/Substitution/#19834" class="Bound">σ</a><a id="20062" class="Symbol">)</a> <a id="20064" class="Symbol">(</a><a id="20065" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="20069" href="/20.07/Substitution/#19837" class="Bound">ρ</a> <a id="20071" href="/20.07/Substitution/#20033" class="Bound">x</a><a id="20072" class="Symbol">)</a> <a id="20074" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="20076" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20083" class="Symbol">(</a><a id="20084" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="20088" href="/20.07/Substitution/#19837" class="Bound">ρ</a><a id="20089" class="Symbol">)</a> <a id="20091" class="Symbol">(</a><a id="20092" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="20097" href="/20.07/Substitution/#19834" class="Bound">σ</a> <a id="20099" href="/20.07/Substitution/#20033" class="Bound">x</a><a id="20100" class="Symbol">)</a>
   <a id="20105" href="/20.07/Substitution/#20028" class="Function">H</a> <a id="20107" class="Symbol">{</a><a id="20108" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="20109" class="Symbol">}</a> <a id="20111" class="Symbol">=</a> <a id="20113" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
   <a id="20121" href="/20.07/Substitution/#20028" class="Function">H</a> <a id="20123" class="Symbol">{</a><a id="20124" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="20126" href="/20.07/Substitution/#20126" class="Bound">y</a><a id="20127" class="Symbol">}</a> <a id="20129" class="Symbol">=</a>
     <a id="20136" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
       <a id="20149" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="20154" class="Symbol">(</a><a id="20155" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="20160" href="/20.07/Substitution/#19834" class="Bound">σ</a><a id="20161" class="Symbol">)</a> <a id="20163" class="Symbol">(</a><a id="20164" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="20168" href="/20.07/Substitution/#19837" class="Bound">ρ</a> <a id="20170" class="Symbol">(</a><a id="20171" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="20173" href="/20.07/Substitution/#20126" class="Bound">y</a><a id="20174" class="Symbol">))</a>
     <a id="20182" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
       <a id="20193" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20200" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="20203" class="Symbol">(</a><a id="20204" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="20209" href="/20.07/Substitution/#19834" class="Bound">σ</a> <a id="20211" class="Symbol">(</a><a id="20212" href="/20.07/Substitution/#19837" class="Bound">ρ</a> <a id="20214" href="/20.07/Substitution/#20126" class="Bound">y</a><a id="20215" class="Symbol">))</a>
     <a id="20223" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="20226" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="20231" class="Symbol">(</a><a id="20232" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20239" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a><a id="20241" class="Symbol">)</a> <a id="20243" href="/20.07/Substitution/#19840" class="Bound">r</a> <a id="20245" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="20254" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20261" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="20264" class="Symbol">(</a><a id="20265" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20272" href="/20.07/Substitution/#19837" class="Bound">ρ</a> <a id="20274" class="Symbol">(</a><a id="20275" href="/20.07/Substitution/#19834" class="Bound">σ</a> <a id="20277" href="/20.07/Substitution/#20126" class="Bound">y</a><a id="20278" class="Symbol">))</a>
     <a id="20286" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="20289" href="/20.07/Substitution/#18794" class="Function">compose-rename</a> <a id="20304" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="20313" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20320" class="Symbol">(</a><a id="20321" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="20324" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="20326" href="/20.07/Substitution/#19837" class="Bound">ρ</a><a id="20327" class="Symbol">)</a> <a id="20329" class="Symbol">(</a><a id="20330" href="/20.07/Substitution/#19834" class="Bound">σ</a> <a id="20332" href="/20.07/Substitution/#20126" class="Bound">y</a><a id="20333" class="Symbol">)</a>
     <a id="20340" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="20343" href="/20.07/Substitution/#10370" class="Function">cong-rename</a> <a id="20355" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="20360" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="20369" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20376" class="Symbol">((</a><a id="20378" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="20382" href="/20.07/Substitution/#19837" class="Bound">ρ</a><a id="20383" class="Symbol">)</a> <a id="20385" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="20387" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a><a id="20389" class="Symbol">)</a> <a id="20391" class="Symbol">(</a><a id="20392" href="/20.07/Substitution/#19834" class="Bound">σ</a> <a id="20394" href="/20.07/Substitution/#20126" class="Bound">y</a><a id="20395" class="Symbol">)</a>
     <a id="20402" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="20405" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="20409" href="/20.07/Substitution/#18794" class="Function">compose-rename</a> <a id="20424" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="20433" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20440" class="Symbol">(</a><a id="20441" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="20445" href="/20.07/Substitution/#19837" class="Bound">ρ</a><a id="20446" class="Symbol">)</a> <a id="20448" class="Symbol">(</a><a id="20449" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20456" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="20459" class="Symbol">(</a><a id="20460" href="/20.07/Substitution/#19834" class="Bound">σ</a> <a id="20462" href="/20.07/Substitution/#20126" class="Bound">y</a><a id="20463" class="Symbol">))</a>
     <a id="20471" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
       <a id="20482" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="20489" class="Symbol">(</a><a id="20490" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="20494" href="/20.07/Substitution/#19837" class="Bound">ρ</a><a id="20495" class="Symbol">)</a> <a id="20497" class="Symbol">(</a><a id="20498" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="20503" href="/20.07/Substitution/#19834" class="Bound">σ</a> <a id="20505" class="Symbol">(</a><a id="20506" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="20508" href="/20.07/Substitution/#20126" class="Bound">y</a><a id="20509" class="Symbol">))</a>
     <a id="20517" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
<a id="20519" href="/20.07/Substitution/#19527" class="Function">commute-subst-rename</a> <a id="20540" class="Symbol">{</a><a id="20541" class="Argument">M</a> <a id="20543" class="Symbol">=</a> <a id="20545" href="/20.07/Substitution/#20545" class="Bound">L</a> <a id="20547" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="20549" href="/20.07/Substitution/#20549" class="Bound">M</a><a id="20550" class="Symbol">}{</a><a id="20552" class="Argument">ρ</a> <a id="20554" class="Symbol">=</a> <a id="20556" href="/20.07/Substitution/#20556" class="Bound">ρ</a><a id="20557" class="Symbol">}</a> <a id="20559" href="/20.07/Substitution/#20559" class="Bound">r</a> <a id="20561" class="Symbol">=</a>
   <a id="20566" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong₂</a> <a id="20572" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_·_</a> <a id="20576" class="Symbol">(</a><a id="20577" href="/20.07/Substitution/#19527" class="Function">commute-subst-rename</a><a id="20597" class="Symbol">{</a><a id="20598" class="Argument">M</a> <a id="20600" class="Symbol">=</a> <a id="20602" href="/20.07/Substitution/#20545" class="Bound">L</a><a id="20603" class="Symbol">}{</a><a id="20605" class="Argument">ρ</a> <a id="20607" class="Symbol">=</a> <a id="20609" href="/20.07/Substitution/#20556" class="Bound">ρ</a><a id="20610" class="Symbol">}</a> <a id="20612" href="/20.07/Substitution/#20559" class="Bound">r</a><a id="20613" class="Symbol">)</a>
             <a id="20628" class="Symbol">(</a><a id="20629" href="/20.07/Substitution/#19527" class="Function">commute-subst-rename</a><a id="20649" class="Symbol">{</a><a id="20650" class="Argument">M</a> <a id="20652" class="Symbol">=</a> <a id="20654" href="/20.07/Substitution/#20549" class="Bound">M</a><a id="20655" class="Symbol">}{</a><a id="20657" class="Argument">ρ</a> <a id="20659" class="Symbol">=</a> <a id="20661" href="/20.07/Substitution/#20556" class="Bound">ρ</a><a id="20662" class="Symbol">}</a> <a id="20664" href="/20.07/Substitution/#20559" class="Bound">r</a><a id="20665" class="Symbol">)</a>
</pre>
<p>The proof is by induction on the term <code class="language-plaintext highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="language-plaintext highlighter-rouge">M</code> is a variable, then we use the premise to conclude.</p>
  </li>
  <li>
    <p>If <code class="language-plaintext highlighter-rouge">M ≡ ƛ N</code>, we conclude using the induction hypothesis for
<code class="language-plaintext highlighter-rouge">N</code>. However, to use the induction hypothesis, we must show
that</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  exts (exts σ) (ext ρ x) ≡ rename (ext ρ) (exts σ x)
</code></pre></div>    </div>

    <p>We prove this equation by cases on x.</p>

    <ul>
      <li>
        <p>If <code class="language-plaintext highlighter-rouge">x = Z</code>, the two sides are equal by definition.</p>
      </li>
      <li>
        <p>If <code class="language-plaintext highlighter-rouge">x = S y</code>, we obtain the goal by the following equational reasoning.</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts (exts σ) (ext ρ (S y))   ≡ rename S_ (exts σ (ρ y))   ≡ rename S_ (rename S_ (σ (ρ y)      (by the premise)   ≡ rename (ext ρ) (exts σ (S y))      (by compose-rename)   ≡ rename ((ext ρ) ∘ S_) (σ y)   ≡ rename (ext ρ) (rename S_ (σ y))   (by compose-rename)   ≡ rename (ext ρ) (exts σ (S y))
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>If <code class="language-plaintext highlighter-rouge">M</code> is an application, we obtain the goal using the induction
hypothesis for each subterm.</p>
  </li>
</ul>

<p>The last lemma needed to prove <code class="language-plaintext highlighter-rouge">sub-sub</code> states that the <code class="language-plaintext highlighter-rouge">exts</code>
function distributes with sequencing. It is a corollary of
<code class="language-plaintext highlighter-rouge">commute-subst-rename</code> as described below.  (It would have been nicer
to prove this directly by equational reasoning in the σ algebra, but
that would require the <code class="language-plaintext highlighter-rouge">sub-assoc</code> equation, whose proof depends on
<code class="language-plaintext highlighter-rouge">sub-sub</code>, which in turn depends on this lemma.)</p>

<pre class="Agda"><a id="exts-seq"></a><a id="21978" href="/20.07/Substitution/#21978" class="Function">exts-seq</a> <a id="21987" class="Symbol">:</a> <a id="21989" class="Symbol">∀{</a><a id="21991" href="/20.07/Substitution/#21991" class="Bound">Γ</a> <a id="21993" href="/20.07/Substitution/#21993" class="Bound">Δ</a> <a id="21995" href="/20.07/Substitution/#21995" class="Bound">Δ′</a><a id="21997" class="Symbol">}</a> <a id="21999" class="Symbol">{</a><a id="22000" href="/20.07/Substitution/#22000" class="Bound">σ₁</a> <a id="22003" class="Symbol">:</a> <a id="22005" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="22011" href="/20.07/Substitution/#21991" class="Bound">Γ</a> <a id="22013" href="/20.07/Substitution/#21993" class="Bound">Δ</a><a id="22014" class="Symbol">}</a> <a id="22016" class="Symbol">{</a><a id="22017" href="/20.07/Substitution/#22017" class="Bound">σ₂</a> <a id="22020" class="Symbol">:</a> <a id="22022" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="22028" href="/20.07/Substitution/#21993" class="Bound">Δ</a> <a id="22030" href="/20.07/Substitution/#21995" class="Bound">Δ′</a><a id="22032" class="Symbol">}</a>
         <a id="22043" class="Symbol">→</a> <a id="22045" class="Symbol">∀</a> <a id="22047" class="Symbol">{</a><a id="22048" href="/20.07/Substitution/#22048" class="Bound">A</a><a id="22049" class="Symbol">}</a> <a id="22051" class="Symbol">→</a> <a id="22053" class="Symbol">(</a><a id="22054" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22059" href="/20.07/Substitution/#22000" class="Bound">σ₁</a> <a id="22062" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="22064" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22069" href="/20.07/Substitution/#22017" class="Bound">σ₂</a><a id="22071" class="Symbol">)</a> <a id="22073" class="Symbol">{</a><a id="22074" href="/20.07/Substitution/#22048" class="Bound">A</a><a id="22075" class="Symbol">}</a> <a id="22077" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="22079" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22084" class="Symbol">(</a><a id="22085" href="/20.07/Substitution/#22000" class="Bound">σ₁</a> <a id="22088" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="22090" href="/20.07/Substitution/#22017" class="Bound">σ₂</a><a id="22092" class="Symbol">)</a>
<a id="22094" href="/20.07/Substitution/#21978" class="Function">exts-seq</a> <a id="22103" class="Symbol">=</a> <a id="22105" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="22120" class="Symbol">λ</a> <a id="22122" href="/20.07/Substitution/#22122" class="Bound">x</a> <a id="22124" class="Symbol">→</a> <a id="22126" href="/20.07/Substitution/#22150" class="Function">lemma</a> <a id="22132" class="Symbol">{</a><a id="22133" class="Argument">x</a> <a id="22135" class="Symbol">=</a> <a id="22137" href="/20.07/Substitution/#22122" class="Bound">x</a><a id="22138" class="Symbol">}</a>
  <a id="22142" class="Keyword">where</a>
  <a id="22150" href="/20.07/Substitution/#22150" class="Function">lemma</a> <a id="22156" class="Symbol">:</a> <a id="22158" class="Symbol">∀{</a><a id="22160" href="/20.07/Substitution/#22160" class="Bound">Γ</a> <a id="22162" href="/20.07/Substitution/#22162" class="Bound">Δ</a> <a id="22164" href="/20.07/Substitution/#22164" class="Bound">Δ′</a><a id="22166" class="Symbol">}{</a><a id="22168" href="/20.07/Substitution/#22168" class="Bound">A</a><a id="22169" class="Symbol">}{</a><a id="22171" href="/20.07/Substitution/#22171" class="Bound">x</a> <a id="22173" class="Symbol">:</a> <a id="22175" href="/20.07/Substitution/#22160" class="Bound">Γ</a> <a id="22177" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="22179" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a> <a id="22181" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="22183" href="/20.07/Substitution/#22168" class="Bound">A</a><a id="22184" class="Symbol">}</a> <a id="22186" class="Symbol">{</a><a id="22187" href="/20.07/Substitution/#22187" class="Bound">σ₁</a> <a id="22190" class="Symbol">:</a> <a id="22192" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="22198" href="/20.07/Substitution/#22160" class="Bound">Γ</a> <a id="22200" href="/20.07/Substitution/#22162" class="Bound">Δ</a><a id="22201" class="Symbol">}{</a><a id="22203" href="/20.07/Substitution/#22203" class="Bound">σ₂</a> <a id="22206" class="Symbol">:</a> <a id="22208" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="22214" href="/20.07/Substitution/#22162" class="Bound">Δ</a> <a id="22216" href="/20.07/Substitution/#22164" class="Bound">Δ′</a><a id="22218" class="Symbol">}</a>
     <a id="22225" class="Symbol">→</a> <a id="22227" class="Symbol">(</a><a id="22228" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22233" href="/20.07/Substitution/#22187" class="Bound">σ₁</a> <a id="22236" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="22238" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22243" href="/20.07/Substitution/#22203" class="Bound">σ₂</a><a id="22245" class="Symbol">)</a> <a id="22247" href="/20.07/Substitution/#22171" class="Bound">x</a> <a id="22249" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="22251" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22256" class="Symbol">(</a><a id="22257" href="/20.07/Substitution/#22187" class="Bound">σ₁</a> <a id="22260" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="22262" href="/20.07/Substitution/#22203" class="Bound">σ₂</a><a id="22264" class="Symbol">)</a> <a id="22266" href="/20.07/Substitution/#22171" class="Bound">x</a>
  <a id="22270" href="/20.07/Substitution/#22150" class="Function">lemma</a> <a id="22276" class="Symbol">{</a><a id="22277" class="Argument">x</a> <a id="22279" class="Symbol">=</a> <a id="22281" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="22282" class="Symbol">}</a> <a id="22284" class="Symbol">=</a> <a id="22286" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="22293" href="/20.07/Substitution/#22150" class="Function">lemma</a> <a id="22299" class="Symbol">{</a><a id="22300" class="Argument">A</a> <a id="22302" class="Symbol">=</a> <a id="22304" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="22305" class="Symbol">}{</a><a id="22307" class="Argument">x</a> <a id="22309" class="Symbol">=</a> <a id="22311" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="22313" href="/20.07/Substitution/#22313" class="Bound">x</a><a id="22314" class="Symbol">}{</a><a id="22316" href="/20.07/Substitution/#22316" class="Bound">σ₁</a><a id="22318" class="Symbol">}{</a><a id="22320" href="/20.07/Substitution/#22320" class="Bound">σ₂</a><a id="22322" class="Symbol">}</a> <a id="22324" class="Symbol">=</a>
     <a id="22331" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
       <a id="22344" class="Symbol">(</a><a id="22345" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22350" href="/20.07/Substitution/#22316" class="Bound">σ₁</a> <a id="22353" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="22355" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22360" href="/20.07/Substitution/#22320" class="Bound">σ₂</a><a id="22362" class="Symbol">)</a> <a id="22364" class="Symbol">(</a><a id="22365" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S</a> <a id="22367" href="/20.07/Substitution/#22313" class="Bound">x</a><a id="22368" class="Symbol">)</a>
     <a id="22375" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
       <a id="22386" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="22388" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="22393" href="/20.07/Substitution/#22320" class="Bound">σ₂</a> <a id="22396" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="22398" class="Symbol">(</a><a id="22399" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="22406" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="22409" class="Symbol">(</a><a id="22410" href="/20.07/Substitution/#22316" class="Bound">σ₁</a> <a id="22413" href="/20.07/Substitution/#22313" class="Bound">x</a><a id="22414" class="Symbol">))</a>
     <a id="22422" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="22425" href="/20.07/Substitution/#19527" class="Function">commute-subst-rename</a><a id="22445" class="Symbol">{</a><a id="22446" class="Argument">M</a> <a id="22448" class="Symbol">=</a> <a id="22450" href="/20.07/Substitution/#22316" class="Bound">σ₁</a> <a id="22453" href="/20.07/Substitution/#22313" class="Bound">x</a><a id="22454" class="Symbol">}{</a><a id="22456" class="Argument">σ</a> <a id="22458" class="Symbol">=</a> <a id="22460" href="/20.07/Substitution/#22320" class="Bound">σ₂</a><a id="22462" class="Symbol">}{</a><a id="22464" class="Argument">ρ</a> <a id="22466" class="Symbol">=</a> <a id="22468" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a><a id="22470" class="Symbol">}</a> <a id="22472" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="22477" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="22486" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="22493" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="22496" class="Symbol">(</a><a id="22497" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="22499" href="/20.07/Substitution/#22320" class="Bound">σ₂</a> <a id="22502" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="22504" class="Symbol">(</a><a id="22505" href="/20.07/Substitution/#22316" class="Bound">σ₁</a> <a id="22508" href="/20.07/Substitution/#22313" class="Bound">x</a><a id="22509" class="Symbol">))</a>
     <a id="22517" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
       <a id="22528" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="22535" href="/20.07/Untyped/#3602" class="InductiveConstructor Operator">S_</a> <a id="22538" class="Symbol">((</a><a id="22540" href="/20.07/Substitution/#22316" class="Bound">σ₁</a> <a id="22543" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="22545" href="/20.07/Substitution/#22320" class="Bound">σ₂</a><a id="22547" class="Symbol">)</a> <a id="22549" href="/20.07/Substitution/#22313" class="Bound">x</a><a id="22550" class="Symbol">)</a>
     <a id="22557" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>
<p>The proof proceed by cases on <code class="language-plaintext highlighter-rouge">x</code>.</p>

<ul>
  <li>
    <p>If <code class="language-plaintext highlighter-rouge">x = Z</code>, the two sides are equal by the definition of <code class="language-plaintext highlighter-rouge">exts</code>
and sequencing.</p>
  </li>
  <li>
    <p>If <code class="language-plaintext highlighter-rouge">x = S x</code>, we unfold the first use of <code class="language-plaintext highlighter-rouge">exts</code> and sequencing, then
apply the lemma <code class="language-plaintext highlighter-rouge">commute-subst-rename</code>. We conclude by the
definition of sequencing.</p>
  </li>
</ul>

<p>Now we come to the proof of <code class="language-plaintext highlighter-rouge">sub-sub</code>, which we explain below.</p>

<pre class="Agda"><a id="sub-sub"></a><a id="22915" href="/20.07/Substitution/#22915" class="Function">sub-sub</a> <a id="22923" class="Symbol">:</a> <a id="22925" class="Symbol">∀{</a><a id="22927" href="/20.07/Substitution/#22927" class="Bound">Γ</a> <a id="22929" href="/20.07/Substitution/#22929" class="Bound">Δ</a> <a id="22931" href="/20.07/Substitution/#22931" class="Bound">Σ</a><a id="22932" class="Symbol">}{</a><a id="22934" href="/20.07/Substitution/#22934" class="Bound">A</a><a id="22935" class="Symbol">}{</a><a id="22937" href="/20.07/Substitution/#22937" class="Bound">M</a> <a id="22939" class="Symbol">:</a> <a id="22941" href="/20.07/Substitution/#22927" class="Bound">Γ</a> <a id="22943" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="22945" href="/20.07/Substitution/#22934" class="Bound">A</a><a id="22946" class="Symbol">}</a> <a id="22948" class="Symbol">{</a><a id="22949" href="/20.07/Substitution/#22949" class="Bound">σ₁</a> <a id="22952" class="Symbol">:</a> <a id="22954" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="22960" href="/20.07/Substitution/#22927" class="Bound">Γ</a> <a id="22962" href="/20.07/Substitution/#22929" class="Bound">Δ</a><a id="22963" class="Symbol">}{</a><a id="22965" href="/20.07/Substitution/#22965" class="Bound">σ₂</a> <a id="22968" class="Symbol">:</a> <a id="22970" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="22976" href="/20.07/Substitution/#22929" class="Bound">Δ</a> <a id="22978" href="/20.07/Substitution/#22931" class="Bound">Σ</a><a id="22979" class="Symbol">}</a>
            <a id="22993" class="Symbol">→</a> <a id="22995" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="22997" href="/20.07/Substitution/#22965" class="Bound">σ₂</a> <a id="23000" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23002" class="Symbol">(</a><a id="23003" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="23005" href="/20.07/Substitution/#22949" class="Bound">σ₁</a> <a id="23008" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23010" href="/20.07/Substitution/#22937" class="Bound">M</a><a id="23011" class="Symbol">)</a> <a id="23013" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="23015" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="23017" href="/20.07/Substitution/#22949" class="Bound">σ₁</a> <a id="23020" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="23022" href="/20.07/Substitution/#22965" class="Bound">σ₂</a> <a id="23025" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23027" href="/20.07/Substitution/#22937" class="Bound">M</a>
<a id="23029" href="/20.07/Substitution/#22915" class="Function">sub-sub</a> <a id="23037" class="Symbol">{</a><a id="23038" class="Argument">M</a> <a id="23040" class="Symbol">=</a> <a id="23042" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="23044" href="/20.07/Substitution/#23044" class="Bound">x</a><a id="23045" class="Symbol">}</a> <a id="23047" class="Symbol">=</a> <a id="23049" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="23054" href="/20.07/Substitution/#22915" class="Function">sub-sub</a> <a id="23062" class="Symbol">{</a><a id="23063" href="/20.07/Substitution/#23063" class="Bound">Γ</a><a id="23064" class="Symbol">}{</a><a id="23066" href="/20.07/Substitution/#23066" class="Bound">Δ</a><a id="23067" class="Symbol">}{</a><a id="23069" href="/20.07/Substitution/#23069" class="Bound">Σ</a><a id="23070" class="Symbol">}{</a><a id="23072" href="/20.07/Substitution/#23072" class="Bound">A</a><a id="23073" class="Symbol">}{</a><a id="23075" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="23077" href="/20.07/Substitution/#23077" class="Bound">N</a><a id="23078" class="Symbol">}{</a><a id="23080" href="/20.07/Substitution/#23080" class="Bound">σ₁</a><a id="23082" class="Symbol">}{</a><a id="23084" href="/20.07/Substitution/#23084" class="Bound">σ₂</a><a id="23086" class="Symbol">}</a> <a id="23088" class="Symbol">=</a>
   <a id="23093" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
     <a id="23104" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="23106" href="/20.07/Substitution/#23084" class="Bound">σ₂</a> <a id="23109" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23111" class="Symbol">(</a><a id="23112" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="23114" href="/20.07/Substitution/#23080" class="Bound">σ₁</a> <a id="23117" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23119" class="Symbol">(</a><a id="23120" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="23122" href="/20.07/Substitution/#23077" class="Bound">N</a><a id="23123" class="Symbol">))</a>
   <a id="23129" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
     <a id="23138" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="23140" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="23142" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="23147" href="/20.07/Substitution/#23084" class="Bound">σ₂</a> <a id="23150" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23152" class="Symbol">(</a><a id="23153" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="23155" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="23160" href="/20.07/Substitution/#23080" class="Bound">σ₁</a> <a id="23163" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23165" href="/20.07/Substitution/#23077" class="Bound">N</a><a id="23166" class="Symbol">)</a>
   <a id="23171" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="23174" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="23179" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="23182" class="Symbol">(</a><a id="23183" href="/20.07/Substitution/#22915" class="Function">sub-sub</a><a id="23190" class="Symbol">{</a><a id="23191" class="Argument">M</a> <a id="23193" class="Symbol">=</a> <a id="23195" href="/20.07/Substitution/#23077" class="Bound">N</a><a id="23196" class="Symbol">}{</a><a id="23198" class="Argument">σ₁</a> <a id="23201" class="Symbol">=</a> <a id="23203" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="23208" href="/20.07/Substitution/#23080" class="Bound">σ₁</a><a id="23210" class="Symbol">}{</a><a id="23212" class="Argument">σ₂</a> <a id="23215" class="Symbol">=</a> <a id="23217" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="23222" href="/20.07/Substitution/#23084" class="Bound">σ₂</a><a id="23224" class="Symbol">})</a> <a id="23227" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="23234" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="23236" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="23238" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="23243" href="/20.07/Substitution/#23080" class="Bound">σ₁</a> <a id="23246" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="23248" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="23253" href="/20.07/Substitution/#23084" class="Bound">σ₂</a> <a id="23256" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23258" href="/20.07/Substitution/#23077" class="Bound">N</a>
   <a id="23263" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="23266" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="23271" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ_</a> <a id="23274" class="Symbol">(</a><a id="23275" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="23283" class="Symbol">{</a><a id="23284" class="Argument">M</a> <a id="23286" class="Symbol">=</a> <a id="23288" href="/20.07/Substitution/#23077" class="Bound">N</a><a id="23289" class="Symbol">}</a> <a id="23291" class="Symbol">(λ</a> <a id="23294" class="Symbol">{</a><a id="23295" href="/20.07/Substitution/#23295" class="Bound">A</a><a id="23296" class="Symbol">}</a> <a id="23298" class="Symbol">→</a> <a id="23300" href="/20.07/Substitution/#21978" class="Function">exts-seq</a><a id="23308" class="Symbol">)</a> <a id="23310" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="23314" class="Symbol">)</a> <a id="23316" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="23323" href="/20.07/Untyped/#4382" class="InductiveConstructor Operator">ƛ</a> <a id="23325" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="23327" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="23332" class="Symbol">(</a> <a id="23334" href="/20.07/Substitution/#23080" class="Bound">σ₁</a> <a id="23337" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="23339" href="/20.07/Substitution/#23084" class="Bound">σ₂</a><a id="23341" class="Symbol">)</a> <a id="23343" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="23345" href="/20.07/Substitution/#23077" class="Bound">N</a>
   <a id="23350" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
<a id="23352" href="/20.07/Substitution/#22915" class="Function">sub-sub</a> <a id="23360" class="Symbol">{</a><a id="23361" class="Argument">M</a> <a id="23363" class="Symbol">=</a> <a id="23365" href="/20.07/Substitution/#23365" class="Bound">L</a> <a id="23367" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">·</a> <a id="23369" href="/20.07/Substitution/#23369" class="Bound">M</a><a id="23370" class="Symbol">}</a> <a id="23372" class="Symbol">=</a> <a id="23374" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong₂</a> <a id="23380" href="/20.07/Untyped/#4442" class="InductiveConstructor Operator">_·_</a> <a id="23384" class="Symbol">(</a><a id="23385" href="/20.07/Substitution/#22915" class="Function">sub-sub</a><a id="23392" class="Symbol">{</a><a id="23393" class="Argument">M</a> <a id="23395" class="Symbol">=</a> <a id="23397" href="/20.07/Substitution/#23365" class="Bound">L</a><a id="23398" class="Symbol">})</a> <a id="23401" class="Symbol">(</a><a id="23402" href="/20.07/Substitution/#22915" class="Function">sub-sub</a><a id="23409" class="Symbol">{</a><a id="23410" class="Argument">M</a> <a id="23412" class="Symbol">=</a> <a id="23414" href="/20.07/Substitution/#23369" class="Bound">M</a><a id="23415" class="Symbol">})</a>
</pre>
<p>We proceed by induction on the term <code class="language-plaintext highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="language-plaintext highlighter-rouge">M = x</code>, then both sides are equal to <code class="language-plaintext highlighter-rouge">σ₂ (σ₁ x)</code>.</p>
  </li>
  <li>
    <p>If <code class="language-plaintext highlighter-rouge">M = ƛ N</code>, we first use the induction hypothesis to show that</p>

    <p>ƛ ⟪ exts σ₂ ⟫ (⟪ exts σ₁ ⟫ N) ≡ ƛ ⟪ exts σ₁ ⨟ exts σ₂ ⟫ N</p>

    <p>and then use the lemma <code class="language-plaintext highlighter-rouge">exts-seq</code> to show</p>

    <p>ƛ ⟪ exts σ₁ ⨟ exts σ₂ ⟫ N ≡ ƛ ⟪ exts ( σ₁ ⨟ σ₂) ⟫ N</p>
  </li>
  <li>
    <p>If <code class="language-plaintext highlighter-rouge">M</code> is an application, we use the induction hypothesis
for both subterms.</p>
  </li>
</ul>

<p>The following corollary of <code class="language-plaintext highlighter-rouge">sub-sub</code> specializes the first
substitution to a renaming.</p>

<pre class="Agda"><a id="rename-subst"></a><a id="23931" href="/20.07/Substitution/#23931" class="Function">rename-subst</a> <a id="23944" class="Symbol">:</a> <a id="23946" class="Symbol">∀{</a><a id="23948" href="/20.07/Substitution/#23948" class="Bound">Γ</a> <a id="23950" href="/20.07/Substitution/#23950" class="Bound">Δ</a> <a id="23952" href="/20.07/Substitution/#23952" class="Bound">Δ′</a><a id="23954" class="Symbol">}{</a><a id="23956" href="/20.07/Substitution/#23956" class="Bound">M</a> <a id="23958" class="Symbol">:</a> <a id="23960" href="/20.07/Substitution/#23948" class="Bound">Γ</a> <a id="23962" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="23964" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="23965" class="Symbol">}{</a><a id="23967" href="/20.07/Substitution/#23967" class="Bound">ρ</a> <a id="23969" class="Symbol">:</a> <a id="23971" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="23978" href="/20.07/Substitution/#23948" class="Bound">Γ</a> <a id="23980" href="/20.07/Substitution/#23950" class="Bound">Δ</a><a id="23981" class="Symbol">}{</a><a id="23983" href="/20.07/Substitution/#23983" class="Bound">σ</a> <a id="23985" class="Symbol">:</a> <a id="23987" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="23993" href="/20.07/Substitution/#23950" class="Bound">Δ</a> <a id="23995" href="/20.07/Substitution/#23952" class="Bound">Δ′</a><a id="23997" class="Symbol">}</a>
             <a id="24012" class="Symbol">→</a> <a id="24014" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24016" href="/20.07/Substitution/#23983" class="Bound">σ</a> <a id="24018" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24020" class="Symbol">(</a><a id="24021" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="24028" href="/20.07/Substitution/#23967" class="Bound">ρ</a> <a id="24030" href="/20.07/Substitution/#23956" class="Bound">M</a><a id="24031" class="Symbol">)</a> <a id="24033" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="24035" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24037" href="/20.07/Substitution/#23983" class="Bound">σ</a> <a id="24039" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="24041" href="/20.07/Substitution/#23967" class="Bound">ρ</a> <a id="24043" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24045" href="/20.07/Substitution/#23956" class="Bound">M</a>
<a id="24047" href="/20.07/Substitution/#23931" class="Function">rename-subst</a> <a id="24060" class="Symbol">{</a><a id="24061" href="/20.07/Substitution/#24061" class="Bound">Γ</a><a id="24062" class="Symbol">}{</a><a id="24064" href="/20.07/Substitution/#24064" class="Bound">Δ</a><a id="24065" class="Symbol">}{</a><a id="24067" href="/20.07/Substitution/#24067" class="Bound">Δ′</a><a id="24069" class="Symbol">}{</a><a id="24071" href="/20.07/Substitution/#24071" class="Bound">M</a><a id="24072" class="Symbol">}{</a><a id="24074" href="/20.07/Substitution/#24074" class="Bound">ρ</a><a id="24075" class="Symbol">}{</a><a id="24077" href="/20.07/Substitution/#24077" class="Bound">σ</a><a id="24078" class="Symbol">}</a> <a id="24080" class="Symbol">=</a>
   <a id="24085" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
     <a id="24096" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24098" href="/20.07/Substitution/#24077" class="Bound">σ</a> <a id="24100" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24102" class="Symbol">(</a><a id="24103" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="24110" href="/20.07/Substitution/#24074" class="Bound">ρ</a> <a id="24112" href="/20.07/Substitution/#24071" class="Bound">M</a><a id="24113" class="Symbol">)</a>
   <a id="24118" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="24121" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="24126" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24128" href="/20.07/Substitution/#24077" class="Bound">σ</a> <a id="24130" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24132" class="Symbol">(</a><a id="24133" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a><a id="24149" class="Symbol">{</a><a id="24150" class="Argument">M</a> <a id="24152" class="Symbol">=</a> <a id="24154" href="/20.07/Substitution/#24071" class="Bound">M</a><a id="24155" class="Symbol">})</a> <a id="24158" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="24165" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24167" href="/20.07/Substitution/#24077" class="Bound">σ</a> <a id="24169" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24171" class="Symbol">(</a><a id="24172" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24174" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="24178" href="/20.07/Substitution/#24074" class="Bound">ρ</a> <a id="24180" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24182" href="/20.07/Substitution/#24071" class="Bound">M</a><a id="24183" class="Symbol">)</a>
   <a id="24188" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="24191" href="/20.07/Substitution/#22915" class="Function">sub-sub</a><a id="24198" class="Symbol">{</a><a id="24199" class="Argument">M</a> <a id="24201" class="Symbol">=</a> <a id="24203" href="/20.07/Substitution/#24071" class="Bound">M</a><a id="24204" class="Symbol">}</a> <a id="24206" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
     <a id="24213" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24215" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="24219" href="/20.07/Substitution/#24074" class="Bound">ρ</a> <a id="24221" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24223" href="/20.07/Substitution/#24077" class="Bound">σ</a> <a id="24225" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24227" href="/20.07/Substitution/#24071" class="Bound">M</a>
   <a id="24232" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
     <a id="24241" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24243" href="/20.07/Substitution/#24077" class="Bound">σ</a> <a id="24245" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">∘</a> <a id="24247" href="/20.07/Substitution/#24074" class="Bound">ρ</a> <a id="24249" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24251" href="/20.07/Substitution/#24071" class="Bound">M</a>
   <a id="24256" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>

<h2 id="proof-of-sub-assoc">Proof of sub-assoc</h2>

<p>The proof of <code class="language-plaintext highlighter-rouge">sub-assoc</code> follows directly from <code class="language-plaintext highlighter-rouge">sub-sub</code> and the
definition of sequencing.</p>

<pre class="Agda"><a id="sub-assoc"></a><a id="24383" href="/20.07/Substitution/#24383" class="Function">sub-assoc</a> <a id="24393" class="Symbol">:</a> <a id="24395" class="Symbol">∀{</a><a id="24397" href="/20.07/Substitution/#24397" class="Bound">Γ</a> <a id="24399" href="/20.07/Substitution/#24399" class="Bound">Δ</a> <a id="24401" href="/20.07/Substitution/#24401" class="Bound">Σ</a> <a id="24403" href="/20.07/Substitution/#24403" class="Bound">Ψ</a> <a id="24405" class="Symbol">:</a> <a id="24407" href="/20.07/Untyped/#3153" class="Datatype">Context</a><a id="24414" class="Symbol">}</a> <a id="24416" class="Symbol">{</a><a id="24417" href="/20.07/Substitution/#24417" class="Bound">σ</a> <a id="24419" class="Symbol">:</a> <a id="24421" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="24427" href="/20.07/Substitution/#24397" class="Bound">Γ</a> <a id="24429" href="/20.07/Substitution/#24399" class="Bound">Δ</a><a id="24430" class="Symbol">}</a> <a id="24432" class="Symbol">{</a><a id="24433" href="/20.07/Substitution/#24433" class="Bound">τ</a> <a id="24435" class="Symbol">:</a> <a id="24437" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="24443" href="/20.07/Substitution/#24399" class="Bound">Δ</a> <a id="24445" href="/20.07/Substitution/#24401" class="Bound">Σ</a><a id="24446" class="Symbol">}</a>
             <a id="24461" class="Symbol">{</a><a id="24462" href="/20.07/Substitution/#24462" class="Bound">θ</a> <a id="24464" class="Symbol">:</a> <a id="24466" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="24472" href="/20.07/Substitution/#24401" class="Bound">Σ</a> <a id="24474" href="/20.07/Substitution/#24403" class="Bound">Ψ</a><a id="24475" class="Symbol">}</a>
          <a id="24487" class="Symbol">→</a> <a id="24489" class="Symbol">∀{</a><a id="24491" href="/20.07/Substitution/#24491" class="Bound">A</a><a id="24492" class="Symbol">}</a> <a id="24494" class="Symbol">→</a> <a id="24496" class="Symbol">(</a><a id="24497" href="/20.07/Substitution/#24417" class="Bound">σ</a> <a id="24499" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24501" href="/20.07/Substitution/#24433" class="Bound">τ</a><a id="24502" class="Symbol">)</a> <a id="24504" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24506" href="/20.07/Substitution/#24462" class="Bound">θ</a> <a id="24508" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="24510" class="Symbol">(</a><a id="24511" href="/20.07/Substitution/#24417" class="Bound">σ</a> <a id="24513" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24515" href="/20.07/Substitution/#24433" class="Bound">τ</a> <a id="24517" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24519" href="/20.07/Substitution/#24462" class="Bound">θ</a><a id="24520" class="Symbol">)</a> <a id="24522" class="Symbol">{</a><a id="24523" href="/20.07/Substitution/#24491" class="Bound">A</a><a id="24524" class="Symbol">}</a>
<a id="24526" href="/20.07/Substitution/#24383" class="Function">sub-assoc</a> <a id="24536" class="Symbol">{</a><a id="24537" href="/20.07/Substitution/#24537" class="Bound">Γ</a><a id="24538" class="Symbol">}{</a><a id="24540" href="/20.07/Substitution/#24540" class="Bound">Δ</a><a id="24541" class="Symbol">}{</a><a id="24543" href="/20.07/Substitution/#24543" class="Bound">Σ</a><a id="24544" class="Symbol">}{</a><a id="24546" href="/20.07/Substitution/#24546" class="Bound">Ψ</a><a id="24547" class="Symbol">}{</a><a id="24549" href="/20.07/Substitution/#24549" class="Bound">σ</a><a id="24550" class="Symbol">}{</a><a id="24552" href="/20.07/Substitution/#24552" class="Bound">τ</a><a id="24553" class="Symbol">}{</a><a id="24555" href="/20.07/Substitution/#24555" class="Bound">θ</a><a id="24556" class="Symbol">}{</a><a id="24558" href="/20.07/Substitution/#24558" class="Bound">A</a><a id="24559" class="Symbol">}</a> <a id="24561" class="Symbol">=</a> <a id="24563" href="/20.07/Substitution/#1927" class="Postulate">extensionality</a> <a id="24578" class="Symbol">λ</a> <a id="24580" href="/20.07/Substitution/#24580" class="Bound">x</a> <a id="24582" class="Symbol">→</a> <a id="24584" href="/20.07/Substitution/#24607" class="Function">lemma</a><a id="24589" class="Symbol">{</a><a id="24590" class="Argument">x</a> <a id="24592" class="Symbol">=</a> <a id="24594" href="/20.07/Substitution/#24580" class="Bound">x</a><a id="24595" class="Symbol">}</a>
  <a id="24599" class="Keyword">where</a>
  <a id="24607" href="/20.07/Substitution/#24607" class="Function">lemma</a> <a id="24613" class="Symbol">:</a> <a id="24615" class="Symbol">∀</a> <a id="24617" class="Symbol">{</a><a id="24618" href="/20.07/Substitution/#24618" class="Bound">x</a> <a id="24620" class="Symbol">:</a> <a id="24622" href="/20.07/Substitution/#24537" class="Bound">Γ</a> <a id="24624" href="/20.07/Untyped/#3521" class="Datatype Operator">∋</a> <a id="24626" href="/20.07/Substitution/#24558" class="Bound">A</a><a id="24627" class="Symbol">}</a> <a id="24629" class="Symbol">→</a> <a id="24631" class="Symbol">((</a><a id="24633" href="/20.07/Substitution/#24549" class="Bound">σ</a> <a id="24635" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24637" href="/20.07/Substitution/#24552" class="Bound">τ</a><a id="24638" class="Symbol">)</a> <a id="24640" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24642" href="/20.07/Substitution/#24555" class="Bound">θ</a><a id="24643" class="Symbol">)</a> <a id="24645" href="/20.07/Substitution/#24618" class="Bound">x</a> <a id="24647" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="24649" class="Symbol">(</a><a id="24650" href="/20.07/Substitution/#24549" class="Bound">σ</a> <a id="24652" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24654" href="/20.07/Substitution/#24552" class="Bound">τ</a> <a id="24656" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24658" href="/20.07/Substitution/#24555" class="Bound">θ</a><a id="24659" class="Symbol">)</a> <a id="24661" href="/20.07/Substitution/#24618" class="Bound">x</a>
  <a id="24665" href="/20.07/Substitution/#24607" class="Function">lemma</a> <a id="24671" class="Symbol">{</a><a id="24672" href="/20.07/Substitution/#24672" class="Bound">x</a><a id="24673" class="Symbol">}</a> <a id="24675" class="Symbol">=</a>
      <a id="24683" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
        <a id="24697" class="Symbol">((</a><a id="24699" href="/20.07/Substitution/#24549" class="Bound">σ</a> <a id="24701" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24703" href="/20.07/Substitution/#24552" class="Bound">τ</a><a id="24704" class="Symbol">)</a> <a id="24706" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24708" href="/20.07/Substitution/#24555" class="Bound">θ</a><a id="24709" class="Symbol">)</a> <a id="24711" href="/20.07/Substitution/#24672" class="Bound">x</a>
      <a id="24719" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
        <a id="24731" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24733" href="/20.07/Substitution/#24555" class="Bound">θ</a> <a id="24735" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24737" class="Symbol">(</a><a id="24738" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24740" href="/20.07/Substitution/#24552" class="Bound">τ</a> <a id="24742" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24744" class="Symbol">(</a><a id="24745" href="/20.07/Substitution/#24549" class="Bound">σ</a> <a id="24747" href="/20.07/Substitution/#24672" class="Bound">x</a><a id="24748" class="Symbol">))</a>
      <a id="24757" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="24760" href="/20.07/Substitution/#22915" class="Function">sub-sub</a><a id="24767" class="Symbol">{</a><a id="24768" class="Argument">M</a> <a id="24770" class="Symbol">=</a> <a id="24772" href="/20.07/Substitution/#24549" class="Bound">σ</a> <a id="24774" href="/20.07/Substitution/#24672" class="Bound">x</a><a id="24775" class="Symbol">}</a> <a id="24777" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
        <a id="24787" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="24789" href="/20.07/Substitution/#24552" class="Bound">τ</a> <a id="24791" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24793" href="/20.07/Substitution/#24555" class="Bound">θ</a> <a id="24795" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="24797" class="Symbol">(</a><a id="24798" href="/20.07/Substitution/#24549" class="Bound">σ</a> <a id="24800" href="/20.07/Substitution/#24672" class="Bound">x</a><a id="24801" class="Symbol">)</a>
      <a id="24809" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
        <a id="24821" class="Symbol">(</a><a id="24822" href="/20.07/Substitution/#24549" class="Bound">σ</a> <a id="24824" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24826" href="/20.07/Substitution/#24552" class="Bound">τ</a> <a id="24828" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="24830" href="/20.07/Substitution/#24555" class="Bound">θ</a><a id="24831" class="Symbol">)</a> <a id="24833" href="/20.07/Substitution/#24672" class="Bound">x</a>
      <a id="24841" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>
<h2 id="proof-of-subst-zero-exts-cons">Proof of subst-zero-exts-cons</h2>

<p>The last equation we needed to prove <code class="language-plaintext highlighter-rouge">subst-zero-exts-cons</code> was
<code class="language-plaintext highlighter-rouge">sub-assoc</code>, so we can now go ahead with its proof.  We simply apply
the equations for <code class="language-plaintext highlighter-rouge">exts</code> and <code class="language-plaintext highlighter-rouge">subst-zero</code> and then apply the σ algebra
equation to arrive at the normal form <code class="language-plaintext highlighter-rouge">M • σ</code>.</p>

<pre class="Agda"><a id="subst-zero-exts-cons"></a><a id="25138" href="/20.07/Substitution/#25138" class="Function">subst-zero-exts-cons</a> <a id="25159" class="Symbol">:</a> <a id="25161" class="Symbol">∀{</a><a id="25163" href="/20.07/Substitution/#25163" class="Bound">Γ</a> <a id="25165" href="/20.07/Substitution/#25165" class="Bound">Δ</a><a id="25166" class="Symbol">}{</a><a id="25168" href="/20.07/Substitution/#25168" class="Bound">σ</a> <a id="25170" class="Symbol">:</a> <a id="25172" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="25178" href="/20.07/Substitution/#25163" class="Bound">Γ</a> <a id="25180" href="/20.07/Substitution/#25165" class="Bound">Δ</a><a id="25181" class="Symbol">}{</a><a id="25183" href="/20.07/Substitution/#25183" class="Bound">B</a><a id="25184" class="Symbol">}{</a><a id="25186" href="/20.07/Substitution/#25186" class="Bound">M</a> <a id="25188" class="Symbol">:</a> <a id="25190" href="/20.07/Substitution/#25165" class="Bound">Δ</a> <a id="25192" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="25194" href="/20.07/Substitution/#25183" class="Bound">B</a><a id="25195" class="Symbol">}{</a><a id="25197" href="/20.07/Substitution/#25197" class="Bound">A</a><a id="25198" class="Symbol">}</a>
                     <a id="25221" class="Symbol">→</a> <a id="25223" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="25228" href="/20.07/Substitution/#25168" class="Bound">σ</a> <a id="25230" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25232" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="25243" href="/20.07/Substitution/#25186" class="Bound">M</a> <a id="25245" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="25247" class="Symbol">(</a><a id="25248" href="/20.07/Substitution/#25186" class="Bound">M</a> <a id="25250" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25252" href="/20.07/Substitution/#25168" class="Bound">σ</a><a id="25253" class="Symbol">)</a> <a id="25255" class="Symbol">{</a><a id="25256" href="/20.07/Substitution/#25197" class="Bound">A</a><a id="25257" class="Symbol">}</a>
<a id="25259" href="/20.07/Substitution/#25138" class="Function">subst-zero-exts-cons</a> <a id="25280" class="Symbol">{</a><a id="25281" href="/20.07/Substitution/#25281" class="Bound">Γ</a><a id="25282" class="Symbol">}{</a><a id="25284" href="/20.07/Substitution/#25284" class="Bound">Δ</a><a id="25285" class="Symbol">}{</a><a id="25287" href="/20.07/Substitution/#25287" class="Bound">σ</a><a id="25288" class="Symbol">}{</a><a id="25290" href="/20.07/Substitution/#25290" class="Bound">B</a><a id="25291" class="Symbol">}{</a><a id="25293" href="/20.07/Substitution/#25293" class="Bound">M</a><a id="25294" class="Symbol">}{</a><a id="25296" href="/20.07/Substitution/#25296" class="Bound">A</a><a id="25297" class="Symbol">}</a> <a id="25299" class="Symbol">=</a>
    <a id="25305" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
      <a id="25317" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="25322" href="/20.07/Substitution/#25287" class="Bound">σ</a> <a id="25324" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25326" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="25337" href="/20.07/Substitution/#25293" class="Bound">M</a>
    <a id="25343" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="25346" href="/20.07/Substitution/#12206" class="Function">cong-seq</a> <a id="25355" href="/20.07/Substitution/#14968" class="Function">exts-cons-shift</a> <a id="25371" href="/20.07/Substitution/#15749" class="Function">subst-Z-cons-ids</a> <a id="25388" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
      <a id="25396" class="Symbol">(</a><a id="25397" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="25399" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="25401" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25403" class="Symbol">(</a><a id="25404" href="/20.07/Substitution/#25287" class="Bound">σ</a> <a id="25406" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25408" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="25409" class="Symbol">))</a> <a id="25412" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25414" class="Symbol">(</a><a id="25415" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25417" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25419" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="25422" class="Symbol">)</a>
    <a id="25428" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="25431" href="/20.07/Substitution/#9074" class="Function">sub-dist</a> <a id="25440" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
      <a id="25448" class="Symbol">(</a><a id="25449" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="25451" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25453" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25455" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="25459" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="25461" class="Symbol">(</a><a id="25462" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="25464" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="25465" class="Symbol">))</a> <a id="25468" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25470" class="Symbol">((</a><a id="25472" href="/20.07/Substitution/#25287" class="Bound">σ</a> <a id="25474" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25476" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="25477" class="Symbol">)</a> <a id="25479" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25481" class="Symbol">(</a><a id="25482" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25484" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25486" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="25489" class="Symbol">))</a>
    <a id="25496" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="25499" href="/20.07/Substitution/#11861" class="Function">cong-cons</a> <a id="25509" class="Symbol">(</a><a id="25510" href="/20.07/Substitution/#8259" class="Function">sub-head</a><a id="25518" class="Symbol">{</a><a id="25519" class="Argument">σ</a> <a id="25521" class="Symbol">=</a> <a id="25523" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="25526" class="Symbol">})</a> <a id="25529" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="25534" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
      <a id="25542" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25544" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25546" class="Symbol">((</a><a id="25548" href="/20.07/Substitution/#25287" class="Bound">σ</a> <a id="25550" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25552" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="25553" class="Symbol">)</a> <a id="25555" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25557" class="Symbol">(</a><a id="25558" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25560" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25562" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="25565" class="Symbol">))</a>
    <a id="25572" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="25575" href="/20.07/Substitution/#11861" class="Function">cong-cons</a> <a id="25585" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="25590" class="Symbol">(</a><a id="25591" href="/20.07/Substitution/#24383" class="Function">sub-assoc</a><a id="25600" class="Symbol">{</a><a id="25601" class="Argument">σ</a> <a id="25603" class="Symbol">=</a> <a id="25605" href="/20.07/Substitution/#25287" class="Bound">σ</a><a id="25606" class="Symbol">})</a> <a id="25609" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
      <a id="25617" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25619" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25621" class="Symbol">(</a><a id="25622" href="/20.07/Substitution/#25287" class="Bound">σ</a> <a id="25624" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25626" class="Symbol">(</a><a id="25627" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="25629" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25631" class="Symbol">(</a><a id="25632" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25634" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25636" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="25639" class="Symbol">)))</a>
    <a id="25647" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="25650" href="/20.07/Substitution/#11861" class="Function">cong-cons</a> <a id="25660" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="25665" class="Symbol">(</a><a id="25666" href="/20.07/Substitution/#12206" class="Function">cong-seq</a><a id="25674" class="Symbol">{</a><a id="25675" class="Argument">σ</a> <a id="25677" class="Symbol">=</a> <a id="25679" href="/20.07/Substitution/#25287" class="Bound">σ</a><a id="25680" class="Symbol">}</a> <a id="25682" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="25687" class="Symbol">(</a><a id="25688" href="/20.07/Substitution/#8365" class="Function">sub-tail</a><a id="25696" class="Symbol">{</a><a id="25697" class="Argument">M</a> <a id="25699" class="Symbol">=</a> <a id="25701" href="/20.07/Substitution/#25293" class="Bound">M</a><a id="25702" class="Symbol">}{</a><a id="25704" class="Argument">σ</a> <a id="25706" class="Symbol">=</a> <a id="25708" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="25711" class="Symbol">}))</a> <a id="25715" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
      <a id="25723" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25725" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25727" class="Symbol">(</a><a id="25728" href="/20.07/Substitution/#25287" class="Bound">σ</a> <a id="25730" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="25732" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="25735" class="Symbol">)</a>
    <a id="25741" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="25744" href="/20.07/Substitution/#11861" class="Function">cong-cons</a> <a id="25754" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="25759" class="Symbol">(</a><a id="25760" href="/20.07/Substitution/#17614" class="Function">sub-idR</a><a id="25767" class="Symbol">{</a><a id="25768" class="Argument">σ</a> <a id="25770" class="Symbol">=</a> <a id="25772" href="/20.07/Substitution/#25287" class="Bound">σ</a><a id="25773" class="Symbol">})</a> <a id="25776" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
      <a id="25784" href="/20.07/Substitution/#25293" class="Bound">M</a> <a id="25786" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="25788" href="/20.07/Substitution/#25287" class="Bound">σ</a>
    <a id="25794" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>

<h2 id="proof-of-the-substitution-lemma">Proof of the substitution lemma</h2>

<p>We first prove the generalized form of the substitution lemma, showing
that a substitution <code class="language-plaintext highlighter-rouge">σ</code> commutes with the substitution of <code class="language-plaintext highlighter-rouge">M</code> into
<code class="language-plaintext highlighter-rouge">N</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ exts σ ⟫ N [ ⟪ σ ⟫ M ] ≡ ⟪ σ ⟫ (N [ M ])
</code></pre></div></div>

<p>This proof is where the σ algebra pays off.  The proof is by direct
equational reasoning. Starting with the left-hand side, we apply σ
algebra equations, oriented left-to-right, until we arrive at the
normal form</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ ⟪ σ ⟫ M • σ ⟫ N
</code></pre></div></div>

<p>We then do the same with the right-hand side, arriving at the same
normal form.</p>

<pre class="Agda"><a id="subst-commute"></a><a id="26352" href="/20.07/Substitution/#26352" class="Function">subst-commute</a> <a id="26366" class="Symbol">:</a> <a id="26368" class="Symbol">∀{</a><a id="26370" href="/20.07/Substitution/#26370" class="Bound">Γ</a> <a id="26372" href="/20.07/Substitution/#26372" class="Bound">Δ</a><a id="26373" class="Symbol">}{</a><a id="26375" href="/20.07/Substitution/#26375" class="Bound">N</a> <a id="26377" class="Symbol">:</a> <a id="26379" href="/20.07/Substitution/#26370" class="Bound">Γ</a> <a id="26381" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="26383" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a> <a id="26385" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="26387" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="26388" class="Symbol">}{</a><a id="26390" href="/20.07/Substitution/#26390" class="Bound">M</a> <a id="26392" class="Symbol">:</a> <a id="26394" href="/20.07/Substitution/#26370" class="Bound">Γ</a> <a id="26396" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="26398" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="26399" class="Symbol">}{</a><a id="26401" href="/20.07/Substitution/#26401" class="Bound">σ</a> <a id="26403" class="Symbol">:</a> <a id="26405" href="/20.07/Substitution/#2405" class="Function">Subst</a> <a id="26411" href="/20.07/Substitution/#26370" class="Bound">Γ</a> <a id="26413" href="/20.07/Substitution/#26372" class="Bound">Δ</a> <a id="26415" class="Symbol">}</a>
    <a id="26421" class="Symbol">→</a> <a id="26423" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26425" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="26430" href="/20.07/Substitution/#26401" class="Bound">σ</a> <a id="26432" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26434" href="/20.07/Substitution/#26375" class="Bound">N</a> <a id="26436" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="26438" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26440" href="/20.07/Substitution/#26401" class="Bound">σ</a> <a id="26442" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26444" href="/20.07/Substitution/#26390" class="Bound">M</a> <a id="26446" href="/20.07/Untyped/#7491" class="Function Operator">]</a> <a id="26448" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="26450" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26452" href="/20.07/Substitution/#26401" class="Bound">σ</a> <a id="26454" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26456" class="Symbol">(</a><a id="26457" href="/20.07/Substitution/#26375" class="Bound">N</a> <a id="26459" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="26461" href="/20.07/Substitution/#26390" class="Bound">M</a> <a id="26463" href="/20.07/Untyped/#7491" class="Function Operator">]</a><a id="26464" class="Symbol">)</a>
<a id="26466" href="/20.07/Substitution/#26352" class="Function">subst-commute</a> <a id="26480" class="Symbol">{</a><a id="26481" href="/20.07/Substitution/#26481" class="Bound">Γ</a><a id="26482" class="Symbol">}{</a><a id="26484" href="/20.07/Substitution/#26484" class="Bound">Δ</a><a id="26485" class="Symbol">}{</a><a id="26487" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="26488" class="Symbol">}{</a><a id="26490" href="/20.07/Substitution/#26490" class="Bound">M</a><a id="26491" class="Symbol">}{</a><a id="26493" href="/20.07/Substitution/#26493" class="Bound">σ</a><a id="26494" class="Symbol">}</a> <a id="26496" class="Symbol">=</a>
     <a id="26503" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
       <a id="26516" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26518" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="26523" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26525" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26527" href="/20.07/Substitution/#26487" class="Bound">N</a> <a id="26529" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="26531" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26533" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26535" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26537" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="26539" href="/20.07/Untyped/#7491" class="Function Operator">]</a>
     <a id="26546" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
       <a id="26557" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26559" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="26570" class="Symbol">(</a><a id="26571" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26573" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26575" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26577" href="/20.07/Substitution/#26490" class="Bound">M</a><a id="26578" class="Symbol">)</a> <a id="26580" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26582" class="Symbol">(</a><a id="26583" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26585" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="26590" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26592" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26594" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="26595" class="Symbol">)</a>
     <a id="26602" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="26605" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="26614" class="Symbol">{</a><a id="26615" class="Argument">M</a> <a id="26617" class="Symbol">=</a> <a id="26619" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26621" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="26626" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26628" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26630" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="26631" class="Symbol">}</a> <a id="26633" href="/20.07/Substitution/#15749" class="Function">subst-Z-cons-ids</a> <a id="26650" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="26655" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="26664" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26666" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26668" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26670" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26672" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="26674" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="26676" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="26680" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26682" class="Symbol">(</a><a id="26683" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26685" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="26690" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26692" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26694" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="26695" class="Symbol">)</a>
     <a id="26702" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="26705" href="/20.07/Substitution/#22915" class="Function">sub-sub</a> <a id="26713" class="Symbol">{</a><a id="26714" class="Argument">M</a> <a id="26716" class="Symbol">=</a> <a id="26718" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="26719" class="Symbol">}</a> <a id="26721" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="26730" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26732" class="Symbol">(</a><a id="26733" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="26738" href="/20.07/Substitution/#26493" class="Bound">σ</a><a id="26739" class="Symbol">)</a> <a id="26741" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="26743" class="Symbol">((</a><a id="26745" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26747" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26749" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26751" href="/20.07/Substitution/#26490" class="Bound">M</a><a id="26752" class="Symbol">)</a> <a id="26754" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="26756" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="26759" class="Symbol">)</a> <a id="26761" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26763" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="26770" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="26773" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="26782" class="Symbol">{</a><a id="26783" class="Argument">M</a> <a id="26785" class="Symbol">=</a> <a id="26787" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="26788" class="Symbol">}</a> <a id="26790" class="Symbol">(</a><a id="26791" href="/20.07/Substitution/#12206" class="Function">cong-seq</a> <a id="26800" href="/20.07/Substitution/#14968" class="Function">exts-cons-shift</a> <a id="26816" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="26820" class="Symbol">)</a> <a id="26822" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="26827" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="26836" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26838" class="Symbol">(</a><a id="26839" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="26841" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a> <a id="26843" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="26845" class="Symbol">(</a><a id="26846" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26848" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="26850" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="26851" class="Symbol">))</a> <a id="26854" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="26856" class="Symbol">(</a><a id="26857" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26859" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26861" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26863" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="26865" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="26867" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="26870" class="Symbol">)</a> <a id="26872" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26874" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="26881" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="26884" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="26893" class="Symbol">{</a><a id="26894" class="Argument">M</a> <a id="26896" class="Symbol">=</a> <a id="26898" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="26899" class="Symbol">}</a> <a id="26901" class="Symbol">(</a><a id="26902" href="/20.07/Substitution/#9074" class="Function">sub-dist</a> <a id="26911" class="Symbol">{</a><a id="26912" class="Argument">M</a> <a id="26914" class="Symbol">=</a> <a id="26916" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="26918" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="26919" class="Symbol">})</a> <a id="26922" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="26927" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="26936" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26938" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26940" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26942" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26944" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26946" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="26948" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="26950" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="26954" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26956" class="Symbol">(</a><a id="26957" href="/20.07/Untyped/#4330" class="InductiveConstructor Operator">`</a> <a id="26959" href="/20.07/Untyped/#3557" class="InductiveConstructor">Z</a><a id="26960" class="Symbol">)</a> <a id="26962" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="26964" class="Symbol">((</a><a id="26966" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26968" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="26970" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="26971" class="Symbol">)</a> <a id="26973" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="26975" class="Symbol">(</a><a id="26976" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="26978" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="26980" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26982" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="26984" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="26986" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="26989" class="Symbol">))</a> <a id="26992" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="26994" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="27001" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2655" class="Function Operator">≡⟨⟩</a>
       <a id="27012" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27014" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27016" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27018" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27020" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27022" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27024" class="Symbol">((</a><a id="27026" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27028" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="27030" href="/20.07/Substitution/#3185" class="Function">↑</a><a id="27031" class="Symbol">)</a> <a id="27033" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="27035" class="Symbol">(</a><a id="27036" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27038" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27040" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27042" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27044" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27046" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="27049" class="Symbol">))</a> <a id="27052" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27054" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="27061" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="27064" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="27072" class="Symbol">{</a><a id="27073" class="Argument">M</a> <a id="27075" class="Symbol">=</a> <a id="27077" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="27078" class="Symbol">}</a> <a id="27080" class="Symbol">(</a><a id="27081" href="/20.07/Substitution/#11861" class="Function">cong-cons</a> <a id="27091" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27096" class="Symbol">(</a><a id="27097" href="/20.07/Substitution/#24383" class="Function">sub-assoc</a><a id="27106" class="Symbol">{</a><a id="27107" class="Argument">σ</a> <a id="27109" class="Symbol">=</a> <a id="27111" href="/20.07/Substitution/#26493" class="Bound">σ</a><a id="27112" class="Symbol">}))</a> <a id="27116" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27121" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="27130" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27132" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27134" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27136" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27138" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27140" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27142" class="Symbol">(</a><a id="27143" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27145" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="27147" href="/20.07/Substitution/#3185" class="Function">↑</a> <a id="27149" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="27151" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27153" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27155" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27157" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27159" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27161" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="27164" class="Symbol">)</a> <a id="27166" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27168" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="27175" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="27178" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="27186" class="Symbol">{</a><a id="27187" class="Argument">M</a> <a id="27189" class="Symbol">=</a> <a id="27191" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="27192" class="Symbol">}</a> <a id="27194" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27199" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27204" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="27213" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27215" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27217" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27219" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27221" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27223" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27225" class="Symbol">(</a><a id="27226" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27228" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="27230" href="/20.07/Substitution/#3046" class="Function">ids</a><a id="27233" class="Symbol">)</a> <a id="27235" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27237" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="27244" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="27247" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="27255" class="Symbol">{</a><a id="27256" class="Argument">M</a> <a id="27258" class="Symbol">=</a> <a id="27260" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="27261" class="Symbol">}</a> <a id="27263" class="Symbol">(</a><a id="27264" href="/20.07/Substitution/#11861" class="Function">cong-cons</a> <a id="27274" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27279" class="Symbol">(</a><a id="27280" href="/20.07/Substitution/#17614" class="Function">sub-idR</a><a id="27287" class="Symbol">{</a><a id="27288" class="Argument">σ</a> <a id="27290" class="Symbol">=</a> <a id="27292" href="/20.07/Substitution/#26493" class="Bound">σ</a><a id="27293" class="Symbol">}))</a> <a id="27297" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27302" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="27311" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27313" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27315" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27317" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27319" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27321" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27323" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27325" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27327" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="27334" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="27337" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="27345" class="Symbol">{</a><a id="27346" class="Argument">M</a> <a id="27348" class="Symbol">=</a> <a id="27350" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="27351" class="Symbol">}</a> <a id="27353" class="Symbol">(</a><a id="27354" href="/20.07/Substitution/#11861" class="Function">cong-cons</a> <a id="27364" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27369" class="Symbol">(</a><a id="27370" href="/20.07/Substitution/#8967" class="Function">sub-idL</a><a id="27377" class="Symbol">{</a><a id="27378" class="Argument">σ</a> <a id="27380" class="Symbol">=</a> <a id="27382" href="/20.07/Substitution/#26493" class="Bound">σ</a><a id="27383" class="Symbol">}))</a> <a id="27387" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27392" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="27401" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27403" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27405" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27407" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27409" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27411" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27413" class="Symbol">(</a><a id="27414" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="27418" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="27420" href="/20.07/Substitution/#26493" class="Bound">σ</a><a id="27421" class="Symbol">)</a> <a id="27423" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27425" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="27432" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="27435" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="27443" class="Symbol">{</a><a id="27444" class="Argument">M</a> <a id="27446" class="Symbol">=</a> <a id="27448" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="27449" class="Symbol">}</a> <a id="27451" class="Symbol">(</a><a id="27452" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="27456" href="/20.07/Substitution/#9074" class="Function">sub-dist</a><a id="27464" class="Symbol">)</a> <a id="27466" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="27471" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="27480" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27482" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27484" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27486" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="27490" href="/20.07/Substitution/#3760" class="Function Operator">⨟</a> <a id="27492" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27494" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27496" href="/20.07/Substitution/#26487" class="Bound">N</a>
     <a id="27503" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="27506" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="27510" class="Symbol">(</a><a id="27511" href="/20.07/Substitution/#22915" class="Function">sub-sub</a><a id="27518" class="Symbol">{</a><a id="27519" class="Argument">M</a> <a id="27521" class="Symbol">=</a> <a id="27523" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="27524" class="Symbol">})</a> <a id="27527" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="27536" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27538" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27540" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27542" class="Symbol">(</a><a id="27543" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27545" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27547" href="/20.07/Substitution/#3427" class="Function Operator">•</a> <a id="27549" href="/20.07/Substitution/#3046" class="Function">ids</a> <a id="27553" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27555" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="27556" class="Symbol">)</a>
     <a id="27563" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="27566" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a> <a id="27571" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27573" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27575" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27577" class="Symbol">(</a><a id="27578" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="27582" class="Symbol">(</a><a id="27583" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="27591" class="Symbol">{</a><a id="27592" class="Argument">M</a> <a id="27594" class="Symbol">=</a> <a id="27596" href="/20.07/Substitution/#26487" class="Bound">N</a><a id="27597" class="Symbol">}</a> <a id="27599" href="/20.07/Substitution/#15749" class="Function">subst-Z-cons-ids</a> <a id="27616" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="27620" class="Symbol">))</a> <a id="27623" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="27632" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="27634" href="/20.07/Substitution/#26493" class="Bound">σ</a> <a id="27636" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="27638" class="Symbol">(</a><a id="27639" href="/20.07/Substitution/#26487" class="Bound">N</a> <a id="27641" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="27643" href="/20.07/Substitution/#26490" class="Bound">M</a> <a id="27645" href="/20.07/Untyped/#7491" class="Function Operator">]</a><a id="27646" class="Symbol">)</a>
     <a id="27653" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>
<p>A corollary of <code class="language-plaintext highlighter-rouge">subst-commute</code> is that <code class="language-plaintext highlighter-rouge">rename</code> also commutes with
substitution. In the proof below, we first exchange <code class="language-plaintext highlighter-rouge">rename ρ</code> for
the substitution <code class="language-plaintext highlighter-rouge">⟪ ren ρ ⟫</code>, and apply <code class="language-plaintext highlighter-rouge">subst-commute</code>, and
then convert back to <code class="language-plaintext highlighter-rouge">rename ρ</code>.</p>

<pre class="Agda"><a id="rename-subst-commute"></a><a id="27893" href="/20.07/Substitution/#27893" class="Function">rename-subst-commute</a> <a id="27914" class="Symbol">:</a> <a id="27916" class="Symbol">∀{</a><a id="27918" href="/20.07/Substitution/#27918" class="Bound">Γ</a> <a id="27920" href="/20.07/Substitution/#27920" class="Bound">Δ</a><a id="27921" class="Symbol">}{</a><a id="27923" href="/20.07/Substitution/#27923" class="Bound">N</a> <a id="27925" class="Symbol">:</a> <a id="27927" href="/20.07/Substitution/#27918" class="Bound">Γ</a> <a id="27929" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="27931" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a> <a id="27933" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="27935" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="27936" class="Symbol">}{</a><a id="27938" href="/20.07/Substitution/#27938" class="Bound">M</a> <a id="27940" class="Symbol">:</a> <a id="27942" href="/20.07/Substitution/#27918" class="Bound">Γ</a> <a id="27944" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="27946" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="27947" class="Symbol">}{</a><a id="27949" href="/20.07/Substitution/#27949" class="Bound">ρ</a> <a id="27951" class="Symbol">:</a> <a id="27953" href="/20.07/Substitution/#2192" class="Function">Rename</a> <a id="27960" href="/20.07/Substitution/#27918" class="Bound">Γ</a> <a id="27962" href="/20.07/Substitution/#27920" class="Bound">Δ</a> <a id="27964" class="Symbol">}</a>
    <a id="27970" class="Symbol">→</a> <a id="27972" class="Symbol">(</a><a id="27973" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="27980" class="Symbol">(</a><a id="27981" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="27985" href="/20.07/Substitution/#27949" class="Bound">ρ</a><a id="27986" class="Symbol">)</a> <a id="27988" href="/20.07/Substitution/#27923" class="Bound">N</a><a id="27989" class="Symbol">)</a> <a id="27991" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="27993" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="28000" href="/20.07/Substitution/#27949" class="Bound">ρ</a> <a id="28002" href="/20.07/Substitution/#27938" class="Bound">M</a> <a id="28004" href="/20.07/Untyped/#7491" class="Function Operator">]</a> <a id="28006" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="28008" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="28015" href="/20.07/Substitution/#27949" class="Bound">ρ</a> <a id="28017" class="Symbol">(</a><a id="28018" href="/20.07/Substitution/#27923" class="Bound">N</a> <a id="28020" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="28022" href="/20.07/Substitution/#27938" class="Bound">M</a> <a id="28024" href="/20.07/Untyped/#7491" class="Function Operator">]</a><a id="28025" class="Symbol">)</a>
<a id="28027" href="/20.07/Substitution/#27893" class="Function">rename-subst-commute</a> <a id="28048" class="Symbol">{</a><a id="28049" href="/20.07/Substitution/#28049" class="Bound">Γ</a><a id="28050" class="Symbol">}{</a><a id="28052" href="/20.07/Substitution/#28052" class="Bound">Δ</a><a id="28053" class="Symbol">}{</a><a id="28055" href="/20.07/Substitution/#28055" class="Bound">N</a><a id="28056" class="Symbol">}{</a><a id="28058" href="/20.07/Substitution/#28058" class="Bound">M</a><a id="28059" class="Symbol">}{</a><a id="28061" href="/20.07/Substitution/#28061" class="Bound">ρ</a><a id="28062" class="Symbol">}</a> <a id="28064" class="Symbol">=</a>
     <a id="28071" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2597" class="Function Operator">begin</a>
       <a id="28084" class="Symbol">(</a><a id="28085" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="28092" class="Symbol">(</a><a id="28093" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="28097" href="/20.07/Substitution/#28061" class="Bound">ρ</a><a id="28098" class="Symbol">)</a> <a id="28100" href="/20.07/Substitution/#28055" class="Bound">N</a><a id="28101" class="Symbol">)</a> <a id="28103" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="28105" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="28112" href="/20.07/Substitution/#28061" class="Bound">ρ</a> <a id="28114" href="/20.07/Substitution/#28058" class="Bound">M</a> <a id="28116" href="/20.07/Untyped/#7491" class="Function Operator">]</a>
     <a id="28123" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="28126" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="28135" class="Symbol">(</a><a id="28136" href="/20.07/Substitution/#11610" class="Function">cong-sub-zero</a> <a id="28150" class="Symbol">(</a><a id="28151" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a><a id="28167" class="Symbol">{</a><a id="28168" class="Argument">M</a> <a id="28170" class="Symbol">=</a> <a id="28172" href="/20.07/Substitution/#28058" class="Bound">M</a><a id="28173" class="Symbol">}))</a>
                 <a id="28194" class="Symbol">(</a><a id="28195" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a><a id="28211" class="Symbol">{</a><a id="28212" class="Argument">M</a> <a id="28214" class="Symbol">=</a> <a id="28216" href="/20.07/Substitution/#28055" class="Bound">N</a><a id="28217" class="Symbol">})</a> <a id="28220" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="28229" class="Symbol">(</a><a id="28230" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="28232" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="28236" class="Symbol">(</a><a id="28237" href="/20.07/Untyped/#5925" class="Function">ext</a> <a id="28241" href="/20.07/Substitution/#28061" class="Bound">ρ</a><a id="28242" class="Symbol">)</a> <a id="28244" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="28246" href="/20.07/Substitution/#28055" class="Bound">N</a><a id="28247" class="Symbol">)</a> <a id="28249" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="28251" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="28253" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="28257" href="/20.07/Substitution/#28061" class="Bound">ρ</a> <a id="28259" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="28261" href="/20.07/Substitution/#28058" class="Bound">M</a> <a id="28263" href="/20.07/Untyped/#7491" class="Function Operator">]</a>
     <a id="28270" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="28273" href="/20.07/Substitution/#11122" class="Function">cong-sub</a> <a id="28282" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="28287" class="Symbol">(</a><a id="28288" href="/20.07/Substitution/#11122" class="Function">cong-sub</a><a id="28296" class="Symbol">{</a><a id="28297" class="Argument">M</a> <a id="28299" class="Symbol">=</a> <a id="28301" href="/20.07/Substitution/#28055" class="Bound">N</a><a id="28302" class="Symbol">}</a> <a id="28304" href="/20.07/Substitution/#13235" class="Function">ren-ext</a> <a id="28312" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="28316" class="Symbol">)</a> <a id="28318" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="28327" class="Symbol">(</a><a id="28328" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="28330" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="28335" class="Symbol">(</a><a id="28336" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="28340" href="/20.07/Substitution/#28061" class="Bound">ρ</a><a id="28341" class="Symbol">)</a> <a id="28343" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="28345" href="/20.07/Substitution/#28055" class="Bound">N</a><a id="28346" class="Symbol">)</a> <a id="28348" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="28350" href="/20.07/Substitution/#2546" class="Function Operator">⟪</a> <a id="28352" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="28356" href="/20.07/Substitution/#28061" class="Bound">ρ</a> <a id="28358" href="/20.07/Substitution/#2546" class="Function Operator">⟫</a> <a id="28360" href="/20.07/Substitution/#28058" class="Bound">M</a> <a id="28362" href="/20.07/Untyped/#7491" class="Function Operator">]</a>
     <a id="28369" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="28372" href="/20.07/Substitution/#26352" class="Function">subst-commute</a><a id="28385" class="Symbol">{</a><a id="28386" class="Argument">N</a> <a id="28388" class="Symbol">=</a> <a id="28390" href="/20.07/Substitution/#28055" class="Bound">N</a><a id="28391" class="Symbol">}</a> <a id="28393" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="28402" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="28408" class="Symbol">(</a><a id="28409" href="/20.07/Substitution/#6498" class="Function">ren</a> <a id="28413" href="/20.07/Substitution/#28061" class="Bound">ρ</a><a id="28414" class="Symbol">)</a> <a id="28416" class="Symbol">(</a><a id="28417" href="/20.07/Substitution/#28055" class="Bound">N</a> <a id="28419" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="28421" href="/20.07/Substitution/#28058" class="Bound">M</a> <a id="28423" href="/20.07/Untyped/#7491" class="Function Operator">]</a><a id="28424" class="Symbol">)</a>
     <a id="28431" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">≡⟨</a> <a id="28434" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="28438" class="Symbol">(</a><a id="28439" href="/20.07/Substitution/#13604" class="Function">rename-subst-ren</a><a id="28455" class="Symbol">)</a> <a id="28457" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2714" class="Function Operator">⟩</a>
       <a id="28466" href="/20.07/Untyped/#6235" class="Function">rename</a> <a id="28473" href="/20.07/Substitution/#28061" class="Bound">ρ</a> <a id="28475" class="Symbol">(</a><a id="28476" href="/20.07/Substitution/#28055" class="Bound">N</a> <a id="28478" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="28480" href="/20.07/Substitution/#28058" class="Bound">M</a> <a id="28482" href="/20.07/Untyped/#7491" class="Function Operator">]</a><a id="28483" class="Symbol">)</a>
     <a id="28490" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#2892" class="Function Operator">∎</a>
</pre>
<p>To present the substitution lemma, we introduce the following notation
for substituting a term <code class="language-plaintext highlighter-rouge">M</code> for index 1 within term <code class="language-plaintext highlighter-rouge">N</code>.</p>

<pre class="Agda"><a id="_〔_〕"></a><a id="28630" href="/20.07/Substitution/#28630" class="Function Operator">_〔_〕</a> <a id="28635" class="Symbol">:</a> <a id="28637" class="Symbol">∀</a> <a id="28639" class="Symbol">{</a><a id="28640" href="/20.07/Substitution/#28640" class="Bound">Γ</a> <a id="28642" href="/20.07/Substitution/#28642" class="Bound">A</a> <a id="28644" href="/20.07/Substitution/#28644" class="Bound">B</a> <a id="28646" href="/20.07/Substitution/#28646" class="Bound">C</a><a id="28647" class="Symbol">}</a>
        <a id="28657" class="Symbol">→</a> <a id="28659" href="/20.07/Substitution/#28640" class="Bound">Γ</a> <a id="28661" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28663" href="/20.07/Substitution/#28644" class="Bound">B</a> <a id="28665" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28667" href="/20.07/Substitution/#28646" class="Bound">C</a> <a id="28669" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="28671" href="/20.07/Substitution/#28642" class="Bound">A</a>
        <a id="28681" class="Symbol">→</a> <a id="28683" href="/20.07/Substitution/#28640" class="Bound">Γ</a> <a id="28685" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="28687" href="/20.07/Substitution/#28644" class="Bound">B</a>
          <a id="28699" class="Comment">---------</a>
        <a id="28717" class="Symbol">→</a> <a id="28719" href="/20.07/Substitution/#28640" class="Bound">Γ</a> <a id="28721" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28723" href="/20.07/Substitution/#28646" class="Bound">C</a> <a id="28725" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="28727" href="/20.07/Substitution/#28642" class="Bound">A</a>
<a id="28729" href="/20.07/Substitution/#28630" class="Function Operator">_〔_〕</a> <a id="28734" class="Symbol">{</a><a id="28735" href="/20.07/Substitution/#28735" class="Bound">Γ</a><a id="28736" class="Symbol">}</a> <a id="28738" class="Symbol">{</a><a id="28739" href="/20.07/Substitution/#28739" class="Bound">A</a><a id="28740" class="Symbol">}</a> <a id="28742" class="Symbol">{</a><a id="28743" href="/20.07/Substitution/#28743" class="Bound">B</a><a id="28744" class="Symbol">}</a> <a id="28746" class="Symbol">{</a><a id="28747" href="/20.07/Substitution/#28747" class="Bound">C</a><a id="28748" class="Symbol">}</a> <a id="28750" href="/20.07/Substitution/#28750" class="Bound">N</a> <a id="28752" href="/20.07/Substitution/#28752" class="Bound">M</a> <a id="28754" class="Symbol">=</a>
   <a id="28759" href="/20.07/Untyped/#6963" class="Function">subst</a> <a id="28765" class="Symbol">{</a><a id="28766" href="/20.07/Substitution/#28735" class="Bound">Γ</a> <a id="28768" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28770" href="/20.07/Substitution/#28743" class="Bound">B</a> <a id="28772" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28774" href="/20.07/Substitution/#28747" class="Bound">C</a><a id="28775" class="Symbol">}</a> <a id="28777" class="Symbol">{</a><a id="28778" href="/20.07/Substitution/#28735" class="Bound">Γ</a> <a id="28780" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28782" href="/20.07/Substitution/#28747" class="Bound">C</a><a id="28783" class="Symbol">}</a> <a id="28785" class="Symbol">(</a><a id="28786" href="/20.07/Untyped/#6671" class="Function">exts</a> <a id="28791" class="Symbol">(</a><a id="28792" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="28803" href="/20.07/Substitution/#28752" class="Bound">M</a><a id="28804" class="Symbol">))</a> <a id="28807" class="Symbol">{</a><a id="28808" href="/20.07/Substitution/#28739" class="Bound">A</a><a id="28809" class="Symbol">}</a> <a id="28811" href="/20.07/Substitution/#28750" class="Bound">N</a>
</pre>
<p>The substitution lemma is stated as follows and proved as a corollary
of the <code class="language-plaintext highlighter-rouge">subst-commute</code> lemma.</p>

<pre class="Agda"><a id="substitution"></a><a id="28923" href="/20.07/Substitution/#28923" class="Function">substitution</a> <a id="28936" class="Symbol">:</a> <a id="28938" class="Symbol">∀{</a><a id="28940" href="/20.07/Substitution/#28940" class="Bound">Γ</a><a id="28941" class="Symbol">}{</a><a id="28943" href="/20.07/Substitution/#28943" class="Bound">M</a> <a id="28945" class="Symbol">:</a> <a id="28947" href="/20.07/Substitution/#28940" class="Bound">Γ</a> <a id="28949" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28951" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a> <a id="28953" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28955" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a> <a id="28957" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="28959" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="28960" class="Symbol">}{</a><a id="28962" href="/20.07/Substitution/#28962" class="Bound">N</a> <a id="28964" class="Symbol">:</a> <a id="28966" href="/20.07/Substitution/#28940" class="Bound">Γ</a> <a id="28968" href="/20.07/Untyped/#3191" class="InductiveConstructor Operator">,</a> <a id="28970" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a> <a id="28972" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="28974" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="28975" class="Symbol">}{</a><a id="28977" href="/20.07/Substitution/#28977" class="Bound">L</a> <a id="28979" class="Symbol">:</a> <a id="28981" href="/20.07/Substitution/#28940" class="Bound">Γ</a> <a id="28983" href="/20.07/Untyped/#4294" class="Datatype Operator">⊢</a> <a id="28985" href="/20.07/Untyped/#2888" class="InductiveConstructor">★</a><a id="28986" class="Symbol">}</a>
    <a id="28992" class="Symbol">→</a> <a id="28994" class="Symbol">(</a><a id="28995" href="/20.07/Substitution/#28943" class="Bound">M</a> <a id="28997" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="28999" href="/20.07/Substitution/#28962" class="Bound">N</a> <a id="29001" href="/20.07/Untyped/#7491" class="Function Operator">]</a><a id="29002" class="Symbol">)</a> <a id="29004" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="29006" href="/20.07/Substitution/#28977" class="Bound">L</a> <a id="29008" href="/20.07/Untyped/#7491" class="Function Operator">]</a> <a id="29010" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="29012" class="Symbol">(</a><a id="29013" href="/20.07/Substitution/#28943" class="Bound">M</a> <a id="29015" href="/20.07/Substitution/#28630" class="Function Operator">〔</a> <a id="29017" href="/20.07/Substitution/#28977" class="Bound">L</a> <a id="29019" href="/20.07/Substitution/#28630" class="Function Operator">〕</a><a id="29020" class="Symbol">)</a> <a id="29022" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="29024" class="Symbol">(</a><a id="29025" href="/20.07/Substitution/#28962" class="Bound">N</a> <a id="29027" href="/20.07/Untyped/#7491" class="Function Operator">[</a> <a id="29029" href="/20.07/Substitution/#28977" class="Bound">L</a> <a id="29031" href="/20.07/Untyped/#7491" class="Function Operator">]</a><a id="29032" class="Symbol">)</a> <a id="29034" href="/20.07/Untyped/#7491" class="Function Operator">]</a>
<a id="29036" href="/20.07/Substitution/#28923" class="Function">substitution</a><a id="29048" class="Symbol">{</a><a id="29049" class="Argument">M</a> <a id="29051" class="Symbol">=</a> <a id="29053" href="/20.07/Substitution/#29053" class="Bound">M</a><a id="29054" class="Symbol">}{</a><a id="29056" class="Argument">N</a> <a id="29058" class="Symbol">=</a> <a id="29060" href="/20.07/Substitution/#29060" class="Bound">N</a><a id="29061" class="Symbol">}{</a><a id="29063" class="Argument">L</a> <a id="29065" class="Symbol">=</a> <a id="29067" href="/20.07/Substitution/#29067" class="Bound">L</a><a id="29068" class="Symbol">}</a> <a id="29070" class="Symbol">=</a>
   <a id="29075" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="29079" class="Symbol">(</a><a id="29080" href="/20.07/Substitution/#26352" class="Function">subst-commute</a><a id="29093" class="Symbol">{</a><a id="29094" class="Argument">N</a> <a id="29096" class="Symbol">=</a> <a id="29098" href="/20.07/Substitution/#29053" class="Bound">M</a><a id="29099" class="Symbol">}{</a><a id="29101" class="Argument">M</a> <a id="29103" class="Symbol">=</a> <a id="29105" href="/20.07/Substitution/#29060" class="Bound">N</a><a id="29106" class="Symbol">}{</a><a id="29108" class="Argument">σ</a> <a id="29110" class="Symbol">=</a> <a id="29112" href="/20.07/Untyped/#7375" class="Function">subst-zero</a> <a id="29123" href="/20.07/Substitution/#29067" class="Bound">L</a><a id="29124" class="Symbol">})</a>
</pre>

<h2 id="notes">Notes</h2>

<p>Most of the properties and proofs in this file are based on the paper
<em>Autosubst: Reasoning with de Bruijn Terms and Parallel Substitution</em>
by Schafer, Tebbi, and Smolka (ITP 2015). That paper, in turn, is
based on the paper of Abadi, Cardelli, Curien, and Levy (1991) that
defines the σ algebra.</p>

<h2 id="unicode">Unicode</h2>

<p>This chapter uses the following unicode:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪  U+27EA  MATHEMATICAL LEFT DOUBLE ANGLE BRACKET (\&lt;&lt;)
⟫  U+27EA  MATHEMATICAL RIGHT DOUBLE ANGLE BRACKET (\&gt;&gt;)
↑  U+2191  UPWARDS ARROW (\u)
•  U+2022  BULLET (\bub)
⨟  U+2A1F  Z NOTATION SCHEMA COMPOSITION (C-x 8 RET Z NOTATION SCHEMA COMPOSITION)
〔  U+3014  LEFT TORTOISE SHELL BRACKET (\( option 9 on page 2)
〕  U+3015  RIGHT TORTOISE SHELL BRACKET (\) option 9 on page 2)
</code></pre></div></div>

  </div>

  <p style="text-align:center;">

    <a alt="Previous chapter" href="/20.07/ContextualEquivalence/">Prev</a>


    &bullet;


    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev-20.07/src/plfa/part2/Substitution.lagda.md">Source</a>


    &bullet;


    <a alt="Next chapter" href="/20.07/Acknowledgements/">Next</a>

</p>


</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/20.07/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Programming Language Foundations in Agda
</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Philip Wadler</li>
          <li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk">wadler@inf.ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wadler"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wadler</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wen Kokke</li>
          <li><a class="u-email" href="mailto:wen.kokke@ed.ac.uk">wen.kokke@ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wenkokke"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wenkokke</span></a></li><li><a href="https://www.twitter.com/wenkokke"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">wenkokke</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Jeremy G. Siek</li>
          <li><a class="u-email" href="mailto:jsiek@indiana.edu">jsiek@indiana.edu</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jsiek"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jsiek</span></a></li><li><a href="https://www.twitter.com/jeremysiek"><svg class="svg-icon"><use xlink:href="/20.07/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jeremysiek</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>
<!-- Import jQuery -->
<script type="text/javascript" src="/20.07/assets/jquery.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha256-E4RlfxwyJVmkkk0szw7LYJxuPlp6evtPSBDlWHsYYL8=" crossorigin="anonymous"></script>
<script type="text/javascript">
  anchors.add();
</script>

<script type="text/javascript">

 // Makes sandwhich menu works
 $('.menu-icon').click(function(){
   $('.trigger').toggle();
 });

 // Script which allows for foldable code blocks
 $('div.foldable pre').each(function(){
     var autoHeight = $(this).height();
     var lineHeight = parseFloat($(this).css('line-height'));

     var plus    = $("<div></div>");
     var horLine = $("<div></div>");
     var verLine = $("<div></div>");
     $(this).prepend(plus);
     plus.css({
         'position'         : 'relative',
         'float'            : 'right',
         'right'            : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'width'            : lineHeight,
         'height'           : lineHeight});
     verLine.css({
         'position'         : 'relative',
         'height'           : lineHeight,
         'width'            : '3px',
         'background-color' : '#C1E0FF'});
     horLine.css({
         'position'         : 'relative',
         'top'              : '-' + (0.5 * lineHeight + 1.5) + 'px',
         'left'             : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'height'           : '3px',
         'width'            : lineHeight,
         'background-color' : '#C1E0FF'});
     plus.append(verLine);
     plus.append(horLine);

     $(this).height(2.0 * lineHeight);
     $(this).css('overflow','hidden');

     $(this).click(function(){
         if ($(this).height() == autoHeight) {
             $(this).height(2.0 * lineHeight);
             plus.show();
         }
         else {
             $(this).height('auto');
             plus.hide();
         }
     });
 });
</script>

<!-- Import KaTeX -->
<script type="text/javascript" src="/20.07/assets/katex.js"></script>

<!-- Script which renders TeX using KaTeX -->
<script type="text/javascript">
 $("script[type='math/tex']").replaceWith(
     function(){
         var tex = $(this).text();
         return "<span class=\"inline-equation\">" +
                katex.renderToString(tex) +
                "</span>";
     });
 $("script[type='math/tex; mode=display']").replaceWith(
     function(){
         var tex = $(this).text().replace(/%.*?(\n|$)/g,"");
         return "<div class=\"equation\">" +
                katex.renderToString("\\displaystyle "+tex) +
                "</div>";
     });
</script>
</body>

</html>
