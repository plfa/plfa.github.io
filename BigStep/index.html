<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="../assets/css/light.css" integrity="sha512-ZX/aBpdCBW4Eu5Bjc7USrGeiSiN2UpIuetQ1YMRtplE4MkM78yNQ+KiJYTWqFueppZ1C//BgkiOd+Vvx//iabw==" title="Light" id="stylesheet-light"><link rel="stylesheet" href="../assets/css/dark.css" integrity="sha512-w0U8MAmTKZwYGKoZzBaimTEtI6cRyPxTv78JtkqDmvfjljTGU55Nppb++dx5aDvdhoY6R1UMRQzTOYg0Z9DOoQ==" title="Dark" id="stylesheet-dark" disabled><title>Programming Language Foundations in Agda – BigStep</title><script src="../assets/js/anchor.js" integrity="sha512-Y5IMGqYQp36NYYdEL6gXISLsHNpx0LxW0NS0twvYBvXI8GH5PZa1g5gm1B5lxg6tlFyUAiOOfgKL/NIn0dtY4w==" id="script-anchor"></script><script src="../assets/js/darkmode.js" integrity="sha512-iUX9HnSphH4WbMv88MYJEFtLfkCtTHrvWyFwjigSm5GkwHv1L31GP5grIGDo7kI2jftuYVvt4xu4qeCn2fKbww==" id="script-darkmode"></script><script src="../assets/js/main.js" integrity="sha512-X7aZg6IUKq1TvTVjSureaMGKZ/ylbAD7kxiU2w42IUgh4lUTWoOsoIWzNvrqkwBJdQ1y2GsS67gtsv39Uuq6ew==" id="script-main"></script></head><body><header class="site-header"><div class="wrapper"><a class="site-title" href="../">Programming Language Foundations in Agda</a><nav class="site-nav"><input type="checkbox" id="nav-trigger" class="nav-trigger"><label for="nav-trigger"><span class="menu-icon"><svg class="svg-icon grey" viewBox="0 0 18 15" width="18px" height="15px"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></span></label><div class="trigger"><a class="page-link" href="../">The Book</a> <a class="page-link" href="../Announcements/">Announcements</a> <a class="page-link" href="../GettingStarted/">Getting Started</a> <a class="page-link" href="../Citing/">Citing</a> <a class="page-link" href="https://agda-zh.github.io/PLFA-zh/">中文</a> <a class="page-link" onclick="window.darkmode.toggle()"><i id="darkmode-trigger" class="fas fa-moon" aria-hidden="true"></i> </a><a class="page-link" href="../plfa.epub"><i class="fa fa-book" aria-hidden="true"></i></a></div></nav></div></header><main class="page-content" aria-label="Content"><div class="wrapper"><article class="post"><nav class="pager"><ul class="pagination"><li><a class="pagelink" href="../Confluence/">Prev</a></li><li class="separator">•</li><li><a class="pagelink" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/part2/BigStep.lagda.md">Source</a></li><li class="separator">•</li><li><a class="pagelink" href="../Denotational/">Next</a></li><li class="separator">•</li></ul></nav><header class="post-header"><h1 class="post-title">BigStep: Big-step semantics of untyped lambda calculus</h1></header><div class="post-content"><pre class="Agda"><a id="plfa_plfa-part2-BigStep-109" class="Keyword">module</a> <a id="plfa_plfa-part2-BigStep-116" href="../BigStep/#" class="Module">plfa.part2.BigStep</a> <a id="plfa_plfa-part2-BigStep-135" class="Keyword">where</a>
</pre><h2 id="introduction">Introduction</h2><p>The call-by-name evaluation strategy is a deterministic method for computing the value of a program in the lambda calculus. That is, call-by-name produces a value if and only if beta reduction can reduce the program to a lambda abstraction. In this chapter we define call-by-name evaluation and prove the forward direction of this if-and-only-if. The backward direction is traditionally proved via Curry-Feys standardisation, which is quite complex. We give a sketch of that proof, due to Plotkin, but postpone the proof in Agda until after we have developed a denotational semantics for the lambda calculus, at which point the proof is an easy corollary of properties of the denotational semantics.</p><p>We present the call-by-name strategy as a relation between an input term and an output value. Such a relation is often called a <em>big-step semantics</em>, written <code>M ⇓ V</code>, as it relates the input term <code>M</code> directly to the final result <code>V</code>, in contrast to the small-step reduction relation, <code>M —→ M′</code>, that maps <code>M</code> to another term <code>M′</code> in which a single sub-computation has been completed.</p><h2 id="imports">Imports</h2><pre class="Agda"><a id="plfa_plfa-part2-BigStep-1271" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1276" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1283" href="https://agda.github.io/agda-stdlib/v1.7.1/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="plfa_plfa-part2-BigStep-1323" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1329" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1330" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="plfa_plfa-part2-BigStep-1333" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1335" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="plfa_plfa-part2-BigStep-1339" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1341" href="https://agda.github.io/agda-stdlib/v1.7.1/Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a><a id="plfa_plfa-part2-BigStep-1346" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1348" href="https://agda.github.io/agda-stdlib/v1.7.1/Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a><a id="plfa_plfa-part2-BigStep-1351" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1353" href="https://agda.github.io/agda-stdlib/v1.7.1/Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a><a id="plfa_plfa-part2-BigStep-1361" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-1363" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1368" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1375" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html" class="Module">Data.Product</a> <a id="plfa_plfa-part2-BigStep-1388" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1394" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1395" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1167" class="Function Operator">_×_</a><a id="plfa_plfa-part2-BigStep-1398" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1400" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Sigma.html#166" class="Record">Σ</a><a id="plfa_plfa-part2-BigStep-1401" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1403" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ-syntax</a><a id="plfa_plfa-part2-BigStep-1411" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1413" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1369" class="Function">∃</a><a id="plfa_plfa-part2-BigStep-1414" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1416" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1806" class="Function">∃-syntax</a><a id="plfa_plfa-part2-BigStep-1424" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1426" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="plfa_plfa-part2-BigStep-1431" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1433" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="plfa_plfa-part2-BigStep-1438" class="Symbol">)</a>
  <a id="plfa_plfa-part2-BigStep-1442" class="Keyword">renaming</a> <a id="plfa_plfa-part2-BigStep-1451" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1452" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="plfa_plfa-part2-BigStep-1456" class="Symbol">to</a> <a id="plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="plfa_plfa-part2-BigStep-1464" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-1466" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1471" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1478" href="https://agda.github.io/agda-stdlib/v1.7.1/Function.html" class="Module">Function</a> <a id="plfa_plfa-part2-BigStep-1487" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1493" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1494" href="https://agda.github.io/agda-stdlib/v1.7.1/Function.Base.html#1031" class="Function Operator">_∘_</a><a id="plfa_plfa-part2-BigStep-1497" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-1499" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1504" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1511" href="../Untyped/#" class="Module">plfa.part2.Untyped</a>
  <a id="plfa_plfa-part2-BigStep-1532" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1538" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1539" href="../Untyped/#plfa_plfa-part2-Untyped-2782" class="Datatype">Context</a><a id="plfa_plfa-part2-BigStep-1546" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1548" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">_⊢_</a><a id="plfa_plfa-part2-BigStep-1551" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1553" href="../Untyped/#plfa_plfa-part2-Untyped-3158" class="Datatype Operator">_∋_</a><a id="plfa_plfa-part2-BigStep-1556" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1558" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-1559" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1561" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a><a id="plfa_plfa-part2-BigStep-1562" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1564" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor Operator">_,_</a><a id="plfa_plfa-part2-BigStep-1567" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1569" href="../Untyped/#plfa_plfa-part2-Untyped-3194" class="InductiveConstructor">Z</a><a id="plfa_plfa-part2-BigStep-1570" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1572" href="../Untyped/#plfa_plfa-part2-Untyped-3239" class="InductiveConstructor Operator">S_</a><a id="plfa_plfa-part2-BigStep-1574" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1576" href="../Untyped/#plfa_plfa-part2-Untyped-3971" class="InductiveConstructor Operator">`_</a><a id="plfa_plfa-part2-BigStep-1578" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1580" href="../Untyped/#plfa_plfa-part2-Untyped-4814" class="Function Operator">#_</a><a id="plfa_plfa-part2-BigStep-1582" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1584" href="../Untyped/#plfa_plfa-part2-Untyped-4023" class="InductiveConstructor Operator">ƛ_</a><a id="plfa_plfa-part2-BigStep-1586" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1588" href="../Untyped/#plfa_plfa-part2-Untyped-4083" class="InductiveConstructor Operator">_·_</a><a id="plfa_plfa-part2-BigStep-1591" class="Symbol">;</a>
  <a id="plfa_plfa-part2-BigStep-1595" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a><a id="plfa_plfa-part2-BigStep-1600" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1602" href="../Untyped/#plfa_plfa-part2-Untyped-7207" class="Function">subst-zero</a><a id="plfa_plfa-part2-BigStep-1612" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1614" href="../Untyped/#plfa_plfa-part2-Untyped-6495" class="Function">exts</a><a id="plfa_plfa-part2-BigStep-1618" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1620" href="../Untyped/#plfa_plfa-part2-Untyped-6055" class="Function">rename</a><a id="plfa_plfa-part2-BigStep-1626" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1628" href="../Untyped/#plfa_plfa-part2-Untyped-10088" class="InductiveConstructor">β</a><a id="plfa_plfa-part2-BigStep-1629" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1631" href="../Untyped/#plfa_plfa-part2-Untyped-9908" class="InductiveConstructor">ξ₁</a><a id="plfa_plfa-part2-BigStep-1633" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1635" href="../Untyped/#plfa_plfa-part2-Untyped-9998" class="InductiveConstructor">ξ₂</a><a id="plfa_plfa-part2-BigStep-1637" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1639" href="../Untyped/#plfa_plfa-part2-Untyped-10196" class="InductiveConstructor">ζ</a><a id="plfa_plfa-part2-BigStep-1640" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1642" href="../Untyped/#plfa_plfa-part2-Untyped-9858" class="Datatype Operator">_—→_</a><a id="plfa_plfa-part2-BigStep-1646" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1648" href="../Untyped/#plfa_plfa-part2-Untyped-10990" class="Datatype Operator">_—↠_</a><a id="plfa_plfa-part2-BigStep-1652" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1654" href="../Untyped/#plfa_plfa-part2-Untyped-11096" class="InductiveConstructor Operator">_—→⟨_⟩_</a><a id="plfa_plfa-part2-BigStep-1661" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1663" href="../Untyped/#plfa_plfa-part2-Untyped-11040" class="InductiveConstructor Operator">_∎</a><a id="plfa_plfa-part2-BigStep-1665" class="Symbol">;</a>
  <a id="plfa_plfa-part2-BigStep-1669" href="../Untyped/#plfa_plfa-part2-Untyped-21715" class="Function">—↠-trans</a><a id="plfa_plfa-part2-BigStep-1677" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1679" href="../Untyped/#plfa_plfa-part2-Untyped-22889" class="Function">appL-cong</a><a id="plfa_plfa-part2-BigStep-1688" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-1690" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1695" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1702" href="../Substitution/#" class="Module">plfa.part2.Substitution</a> <a id="plfa_plfa-part2-BigStep-1726" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1732" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1733" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a><a id="plfa_plfa-part2-BigStep-1738" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1740" href="../Substitution/#plfa_plfa-part2-Substitution-2996" class="Function">ids</a><a id="plfa_plfa-part2-BigStep-1743" class="Symbol">)</a>
</pre><h2 id="environments">Environments</h2><p>To handle variables and function applications, there is the choice between using substitution, as in <code>—→</code>, or to use an <em>environment</em>. An environment in call-by-name is a map from variables to closures, that is, to terms paired with their environments. We choose to use environments instead of substitution because the point of the call-by-name strategy is to be closer to an implementation of the language. Also, the denotational semantics introduced in later chapters uses environments and the proof of adequacy is made easier by aligning these choices.</p><p>We define environments and closures as follows.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-ClosEnv"></a><a id="plfa_plfa-part2-BigStep-2381" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2389" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2391" href="../Untyped/#plfa_plfa-part2-Untyped-2782" class="Datatype">Context</a> <a id="plfa_plfa-part2-BigStep-2399" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2401" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="plfa_plfa-part2-BigStep-2406" class="Keyword">data</a> <a id="plfa_plfa-part2-BigStep-Clos"></a><a id="plfa_plfa-part2-BigStep-2411" href="../BigStep/#plfa_plfa-part2-BigStep-2411" class="Datatype">Clos</a> <a id="plfa_plfa-part2-BigStep-2416" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2418" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Primitive.html#326" class="Primitive">Set</a> <a id="plfa_plfa-part2-BigStep-2422" class="Keyword">where</a>
  <a id="plfa_plfa-part2-BigStep-Clos.clos"></a><a id="plfa_plfa-part2-BigStep-2430" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-2435" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2437" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-2439" href="../BigStep/#plfa_plfa-part2-BigStep-2439" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-2440" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-2442" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2444" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2445" href="../BigStep/#plfa_plfa-part2-BigStep-2445" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-2447" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2449" href="../BigStep/#plfa_plfa-part2-BigStep-2439" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2451" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-2453" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-2454" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2456" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2458" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2466" href="../BigStep/#plfa_plfa-part2-BigStep-2439" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2468" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2470" href="../BigStep/#plfa_plfa-part2-BigStep-2411" class="Datatype">Clos</a>

<a id="plfa_plfa-part2-BigStep-2476" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2484" href="../BigStep/#plfa_plfa-part2-BigStep-2484" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2486" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-2488" class="Symbol">∀</a> <a id="plfa_plfa-part2-BigStep-2490" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2491" href="../BigStep/#plfa_plfa-part2-BigStep-2491" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-2493" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2495" href="../BigStep/#plfa_plfa-part2-BigStep-2484" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2497" href="../Untyped/#plfa_plfa-part2-Untyped-3158" class="Datatype Operator">∋</a> <a id="plfa_plfa-part2-BigStep-2499" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-2500" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2502" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2504" href="../BigStep/#plfa_plfa-part2-BigStep-2411" class="Datatype">Clos</a>
</pre><p>As usual, we have the empty environment, and we can extend an environment.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-∅&#39;"></a><a id="plfa_plfa-part2-BigStep-2598" href="../BigStep/#plfa_plfa-part2-BigStep-2598" class="Function">∅&#39;</a> <a id="plfa_plfa-part2-BigStep-2601" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2603" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2611" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a>
<a id="plfa_plfa-part2-BigStep-2613" href="../BigStep/#plfa_plfa-part2-BigStep-2598" class="Function">∅&#39;</a> <a id="plfa_plfa-part2-BigStep-2616" class="Symbol">()</a>

<a id="plfa_plfa-part2-BigStep-_,&#39;_"></a><a id="plfa_plfa-part2-BigStep-2620" href="../BigStep/#plfa_plfa-part2-BigStep-2620" class="Function Operator">_,&#39;_</a> <a id="plfa_plfa-part2-BigStep-2625" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2627" class="Symbol">∀</a> <a id="plfa_plfa-part2-BigStep-2629" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-2630" href="../BigStep/#plfa_plfa-part2-BigStep-2630" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-2631" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-2633" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2635" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2643" href="../BigStep/#plfa_plfa-part2-BigStep-2630" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2645" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2647" href="../BigStep/#plfa_plfa-part2-BigStep-2411" class="Datatype">Clos</a> <a id="plfa_plfa-part2-BigStep-2652" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2654" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2662" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2663" href="../BigStep/#plfa_plfa-part2-BigStep-2630" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2665" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-2667" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-2668" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-2670" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2671" href="../BigStep/#plfa_plfa-part2-BigStep-2671" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-2673" href="../BigStep/#plfa_plfa-part2-BigStep-2620" class="Function Operator">,&#39;</a> <a id="plfa_plfa-part2-BigStep-2676" href="../BigStep/#plfa_plfa-part2-BigStep-2676" class="Bound">c</a><a id="plfa_plfa-part2-BigStep-2677" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2679" href="../Untyped/#plfa_plfa-part2-Untyped-3194" class="InductiveConstructor">Z</a> <a id="plfa_plfa-part2-BigStep-2681" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-2683" href="../BigStep/#plfa_plfa-part2-BigStep-2676" class="Bound">c</a>
<a id="plfa_plfa-part2-BigStep-2685" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2686" href="../BigStep/#plfa_plfa-part2-BigStep-2686" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-2688" href="../BigStep/#plfa_plfa-part2-BigStep-2620" class="Function Operator">,&#39;</a> <a id="plfa_plfa-part2-BigStep-2691" href="../BigStep/#plfa_plfa-part2-BigStep-2691" class="Bound">c</a><a id="plfa_plfa-part2-BigStep-2692" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2694" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2695" href="../Untyped/#plfa_plfa-part2-Untyped-3239" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-BigStep-2697" href="../BigStep/#plfa_plfa-part2-BigStep-2697" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-2698" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2700" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-2702" href="../BigStep/#plfa_plfa-part2-BigStep-2686" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-2704" href="../BigStep/#plfa_plfa-part2-BigStep-2697" class="Bound">x</a>
</pre><h2 id="big-step-evaluation">Big-step evaluation</h2><p>The big-step semantics is represented as a ternary relation, written <code>γ ⊢ M ⇓ V</code>, where <code>γ</code> is the environment, <code>M</code> is the input term, and <code>V</code> is the result value. A <em>value</em> is a closure whose term is a lambda abstraction.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-2968" class="Keyword">data</a> <a id="plfa_plfa-part2-BigStep-_⊢_⇓_"></a><a id="plfa_plfa-part2-BigStep-2973" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">_⊢_⇓_</a> <a id="plfa_plfa-part2-BigStep-2979" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2981" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-2983" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-2984" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-2986" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2988" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2996" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2998" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3000" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-3001" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3003" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3005" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3006" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-3008" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3010" href="../BigStep/#plfa_plfa-part2-BigStep-2411" class="Datatype">Clos</a> <a id="plfa_plfa-part2-BigStep-3015" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3017" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Primitive.html#326" class="Primitive">Set</a> <a id="plfa_plfa-part2-BigStep-3021" class="Keyword">where</a>

  <a id="plfa_plfa-part2-BigStep-_⊢_⇓_.⇓-var"></a><a id="plfa_plfa-part2-BigStep-3030" href="../BigStep/#plfa_plfa-part2-BigStep-3030" class="InductiveConstructor">⇓-var</a> <a id="plfa_plfa-part2-BigStep-3036" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3038" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-3040" href="../BigStep/#plfa_plfa-part2-BigStep-3040" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3041" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3043" href="../BigStep/#plfa_plfa-part2-BigStep-3043" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3045" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3047" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3055" href="../BigStep/#plfa_plfa-part2-BigStep-3040" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3056" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3058" href="../BigStep/#plfa_plfa-part2-BigStep-3058" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-3060" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3062" href="../BigStep/#plfa_plfa-part2-BigStep-3040" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3064" href="../Untyped/#plfa_plfa-part2-Untyped-3158" class="Datatype Operator">∋</a> <a id="plfa_plfa-part2-BigStep-3066" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3067" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3069" href="../BigStep/#plfa_plfa-part2-BigStep-3069" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-3070" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3072" href="../BigStep/#plfa_plfa-part2-BigStep-3072" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-3074" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3076" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3084" href="../BigStep/#plfa_plfa-part2-BigStep-3069" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-3085" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3087" href="../BigStep/#plfa_plfa-part2-BigStep-3087" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3089" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3091" href="../BigStep/#plfa_plfa-part2-BigStep-3069" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-3093" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3095" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3096" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3098" href="../BigStep/#plfa_plfa-part2-BigStep-3098" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-3099" class="Symbol">}</a>
    <a id="plfa_plfa-part2-BigStep-3105" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3107" href="../BigStep/#plfa_plfa-part2-BigStep-3043" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3109" href="../BigStep/#plfa_plfa-part2-BigStep-3058" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-3111" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-3113" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-3118" href="../BigStep/#plfa_plfa-part2-BigStep-3087" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3120" href="../BigStep/#plfa_plfa-part2-BigStep-3072" class="Bound">δ</a>
    <a id="plfa_plfa-part2-BigStep-3126" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3128" href="../BigStep/#plfa_plfa-part2-BigStep-3072" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-3130" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3132" href="../BigStep/#plfa_plfa-part2-BigStep-3087" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3134" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3136" href="../BigStep/#plfa_plfa-part2-BigStep-3098" class="Bound">V</a>
      <a id="plfa_plfa-part2-BigStep-3144" class="Comment">-----------</a>
    <a id="plfa_plfa-part2-BigStep-3160" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3162" href="../BigStep/#plfa_plfa-part2-BigStep-3043" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3164" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3166" href="../Untyped/#plfa_plfa-part2-Untyped-3971" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-BigStep-3168" href="../BigStep/#plfa_plfa-part2-BigStep-3058" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-3170" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3172" href="../BigStep/#plfa_plfa-part2-BigStep-3098" class="Bound">V</a>

  <a id="plfa_plfa-part2-BigStep-_⊢_⇓_.⇓-lam"></a><a id="plfa_plfa-part2-BigStep-3177" href="../BigStep/#plfa_plfa-part2-BigStep-3177" class="InductiveConstructor">⇓-lam</a> <a id="plfa_plfa-part2-BigStep-3183" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3185" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-3187" href="../BigStep/#plfa_plfa-part2-BigStep-3187" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3188" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3190" href="../BigStep/#plfa_plfa-part2-BigStep-3190" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3192" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3194" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3202" href="../BigStep/#plfa_plfa-part2-BigStep-3187" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3203" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3205" href="../BigStep/#plfa_plfa-part2-BigStep-3205" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3207" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3209" href="../BigStep/#plfa_plfa-part2-BigStep-3187" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3211" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-3213" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-3215" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3217" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3218" class="Symbol">}</a>
    <a id="plfa_plfa-part2-BigStep-3224" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3226" href="../BigStep/#plfa_plfa-part2-BigStep-3190" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3228" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3230" href="../Untyped/#plfa_plfa-part2-Untyped-4023" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-3232" href="../BigStep/#plfa_plfa-part2-BigStep-3205" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3234" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3236" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-3241" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-3242" href="../Untyped/#plfa_plfa-part2-Untyped-4023" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-3244" href="../BigStep/#plfa_plfa-part2-BigStep-3205" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-3245" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-3247" href="../BigStep/#plfa_plfa-part2-BigStep-3190" class="Bound">γ</a>

  <a id="plfa_plfa-part2-BigStep-_⊢_⇓_.⇓-app"></a><a id="plfa_plfa-part2-BigStep-3252" href="../BigStep/#plfa_plfa-part2-BigStep-3252" class="InductiveConstructor">⇓-app</a> <a id="plfa_plfa-part2-BigStep-3258" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3260" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-3262" href="../BigStep/#plfa_plfa-part2-BigStep-3262" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3263" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3265" href="../BigStep/#plfa_plfa-part2-BigStep-3265" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3267" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3269" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3277" href="../BigStep/#plfa_plfa-part2-BigStep-3262" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3278" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3280" href="../BigStep/#plfa_plfa-part2-BigStep-3280" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-3282" href="../BigStep/#plfa_plfa-part2-BigStep-3282" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3284" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3286" href="../BigStep/#plfa_plfa-part2-BigStep-3262" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3288" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3290" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3291" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3293" href="../BigStep/#plfa_plfa-part2-BigStep-3293" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-3294" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3296" href="../BigStep/#plfa_plfa-part2-BigStep-3296" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-3298" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3300" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3308" href="../BigStep/#plfa_plfa-part2-BigStep-3293" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-3309" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3311" href="../BigStep/#plfa_plfa-part2-BigStep-3311" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-3313" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3315" href="../BigStep/#plfa_plfa-part2-BigStep-3293" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-3317" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-3319" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-3321" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3323" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3324" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3326" href="../BigStep/#plfa_plfa-part2-BigStep-3326" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-3327" class="Symbol">}</a>
    <a id="plfa_plfa-part2-BigStep-3333" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3335" href="../BigStep/#plfa_plfa-part2-BigStep-3265" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3337" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3339" href="../BigStep/#plfa_plfa-part2-BigStep-3280" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-3341" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3343" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-3348" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-3349" href="../Untyped/#plfa_plfa-part2-Untyped-4023" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-3351" href="../BigStep/#plfa_plfa-part2-BigStep-3311" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-3352" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-3354" href="../BigStep/#plfa_plfa-part2-BigStep-3296" class="Bound">δ</a>   <a id="plfa_plfa-part2-BigStep-3358" class="Symbol">→</a>   <a id="plfa_plfa-part2-BigStep-3362" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-3363" href="../BigStep/#plfa_plfa-part2-BigStep-3296" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-3365" href="../BigStep/#plfa_plfa-part2-BigStep-2620" class="Function Operator">,&#39;</a> <a id="plfa_plfa-part2-BigStep-3368" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-3373" href="../BigStep/#plfa_plfa-part2-BigStep-3282" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3375" href="../BigStep/#plfa_plfa-part2-BigStep-3265" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-3376" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-3378" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3380" href="../BigStep/#plfa_plfa-part2-BigStep-3311" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-3382" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3384" href="../BigStep/#plfa_plfa-part2-BigStep-3326" class="Bound">V</a>
      <a id="plfa_plfa-part2-BigStep-3392" class="Comment">---------------------------------------------------</a>
    <a id="plfa_plfa-part2-BigStep-3448" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3450" href="../BigStep/#plfa_plfa-part2-BigStep-3265" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3452" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3454" href="../BigStep/#plfa_plfa-part2-BigStep-3280" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-3456" href="../Untyped/#plfa_plfa-part2-Untyped-4083" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-BigStep-3458" href="../BigStep/#plfa_plfa-part2-BigStep-3282" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3460" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3462" href="../BigStep/#plfa_plfa-part2-BigStep-3326" class="Bound">V</a>
</pre><ul><li><p>The <code>⇓-var</code> rule evaluates a variable by finding the associated closure in the environment and then evaluating the closure.</p></li><li><p>The <code>⇓-lam</code> rule turns a lambda abstraction into a closure by packaging it up with its environment.</p></li><li><p>The <code>⇓-app</code> rule performs function application by first evaluating the term <code>L</code> in operator position. If that produces a closure containing a lambda abstraction <code>ƛ N</code>, then we evaluate the body <code>N</code> in an environment extended with the argument <code>M</code>. Note that <code>M</code> is not evaluated in rule <code>⇓-app</code> because this is call-by-name and not call-by-value.</p></li></ul><h4 id="exercise-big-step-eg-practice">Exercise <code>big-step-eg</code> (practice)</h4><p>Show that <code>(ƛ ƛ # 1) · ((ƛ # 0 · # 0) · (ƛ # 0 · # 0))</code> terminates under big-step call-by-name evaluation.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-4220" class="Comment">-- Your code goes here</a>
</pre><h2 id="the-big-step-semantics-is-deterministic">The big-step semantics is deterministic</h2><p>If the big-step relation evaluates a term <code>M</code> to both <code>V</code> and <code>V′</code>, then <code>V</code> and <code>V′</code> must be identical. In other words, the call-by-name relation is a partial function. The proof is a straightforward induction on the two big-step derivations.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-⇓-determ"></a><a id="plfa_plfa-part2-BigStep-4546" href="../BigStep/#plfa_plfa-part2-BigStep-4546" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4555" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-4557" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-4559" href="../BigStep/#plfa_plfa-part2-BigStep-4559" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-4560" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-4562" href="../BigStep/#plfa_plfa-part2-BigStep-4562" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-4564" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-4566" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-4574" href="../BigStep/#plfa_plfa-part2-BigStep-4559" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-4575" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-4577" href="../BigStep/#plfa_plfa-part2-BigStep-4577" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-4579" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-4581" href="../BigStep/#plfa_plfa-part2-BigStep-4559" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-4583" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-4585" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-4586" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-4588" href="../BigStep/#plfa_plfa-part2-BigStep-4588" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-4590" href="../BigStep/#plfa_plfa-part2-BigStep-4590" class="Bound">V&#39;</a> <a id="plfa_plfa-part2-BigStep-4593" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-4595" href="../BigStep/#plfa_plfa-part2-BigStep-2411" class="Datatype">Clos</a><a id="plfa_plfa-part2-BigStep-4599" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-4603" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-4605" href="../BigStep/#plfa_plfa-part2-BigStep-4562" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-4607" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-4609" href="../BigStep/#plfa_plfa-part2-BigStep-4577" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-4611" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-4613" href="../BigStep/#plfa_plfa-part2-BigStep-4588" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-4615" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-4617" href="../BigStep/#plfa_plfa-part2-BigStep-4562" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-4619" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-4621" href="../BigStep/#plfa_plfa-part2-BigStep-4577" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-4623" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-4625" href="../BigStep/#plfa_plfa-part2-BigStep-4590" class="Bound">V&#39;</a>
  <a id="plfa_plfa-part2-BigStep-4630" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-4632" href="../BigStep/#plfa_plfa-part2-BigStep-4588" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-4634" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-4636" href="../BigStep/#plfa_plfa-part2-BigStep-4590" class="Bound">V&#39;</a>
<a id="plfa_plfa-part2-BigStep-4639" href="../BigStep/#plfa_plfa-part2-BigStep-4546" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4648" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4649" href="../BigStep/#plfa_plfa-part2-BigStep-3030" class="InductiveConstructor">⇓-var</a> <a id="plfa_plfa-part2-BigStep-4655" href="../BigStep/#plfa_plfa-part2-BigStep-4655" class="Bound">eq1</a> <a id="plfa_plfa-part2-BigStep-4659" href="../BigStep/#plfa_plfa-part2-BigStep-4659" class="Bound">mc</a><a id="plfa_plfa-part2-BigStep-4661" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-4663" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4664" href="../BigStep/#plfa_plfa-part2-BigStep-3030" class="InductiveConstructor">⇓-var</a> <a id="plfa_plfa-part2-BigStep-4670" href="../BigStep/#plfa_plfa-part2-BigStep-4670" class="Bound">eq2</a> <a id="plfa_plfa-part2-BigStep-4674" href="../BigStep/#plfa_plfa-part2-BigStep-4674" class="Bound">mc&#39;</a><a id="plfa_plfa-part2-BigStep-4677" class="Symbol">)</a>
    <a id="plfa_plfa-part2-BigStep-4683" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-4688" href="https://agda.github.io/agda-stdlib/v1.7.1/Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="plfa_plfa-part2-BigStep-4694" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4695" href="https://agda.github.io/agda-stdlib/v1.7.1/Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="plfa_plfa-part2-BigStep-4699" href="../BigStep/#plfa_plfa-part2-BigStep-4655" class="Bound">eq1</a><a id="plfa_plfa-part2-BigStep-4702" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-4704" href="../BigStep/#plfa_plfa-part2-BigStep-4670" class="Bound">eq2</a>
<a id="plfa_plfa-part2-BigStep-4708" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-4712" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-4714" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="plfa_plfa-part2-BigStep-4719" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-4721" href="../BigStep/#plfa_plfa-part2-BigStep-4546" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4730" class="Bound">mc</a> <a id="plfa_plfa-part2-BigStep-4733" class="Bound">mc&#39;</a>
<a id="plfa_plfa-part2-BigStep-4737" href="../BigStep/#plfa_plfa-part2-BigStep-4546" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4746" href="../BigStep/#plfa_plfa-part2-BigStep-3177" class="InductiveConstructor">⇓-lam</a> <a id="plfa_plfa-part2-BigStep-4752" href="../BigStep/#plfa_plfa-part2-BigStep-3177" class="InductiveConstructor">⇓-lam</a> <a id="plfa_plfa-part2-BigStep-4758" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-4760" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="plfa_plfa-part2-BigStep-4765" href="../BigStep/#plfa_plfa-part2-BigStep-4546" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4774" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4775" href="../BigStep/#plfa_plfa-part2-BigStep-3252" class="InductiveConstructor">⇓-app</a> <a id="plfa_plfa-part2-BigStep-4781" href="../BigStep/#plfa_plfa-part2-BigStep-4781" class="Bound">mc</a> <a id="plfa_plfa-part2-BigStep-4784" href="../BigStep/#plfa_plfa-part2-BigStep-4784" class="Bound">mc₁</a><a id="plfa_plfa-part2-BigStep-4787" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-4789" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4790" href="../BigStep/#plfa_plfa-part2-BigStep-3252" class="InductiveConstructor">⇓-app</a> <a id="plfa_plfa-part2-BigStep-4796" href="../BigStep/#plfa_plfa-part2-BigStep-4796" class="Bound">mc&#39;</a> <a id="plfa_plfa-part2-BigStep-4800" href="../BigStep/#plfa_plfa-part2-BigStep-4800" class="Bound">mc&#39;&#39;</a><a id="plfa_plfa-part2-BigStep-4804" class="Symbol">)</a>
    <a id="plfa_plfa-part2-BigStep-4810" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-4815" href="../BigStep/#plfa_plfa-part2-BigStep-4546" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4824" href="../BigStep/#plfa_plfa-part2-BigStep-4781" class="Bound">mc</a> <a id="plfa_plfa-part2-BigStep-4827" href="../BigStep/#plfa_plfa-part2-BigStep-4796" class="Bound">mc&#39;</a>
<a id="plfa_plfa-part2-BigStep-4831" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-4835" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-4837" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="plfa_plfa-part2-BigStep-4842" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-4844" href="../BigStep/#plfa_plfa-part2-BigStep-4546" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4853" class="Bound">mc₁</a> <a id="plfa_plfa-part2-BigStep-4857" class="Bound">mc&#39;&#39;</a>
</pre><h2 id="big-step-evaluation-implies-beta-reduction-to-a-lambda">Big-step evaluation implies beta reduction to a lambda</h2><p>If big-step evaluation produces a value, then the input term can reduce to a lambda abstraction by beta reduction:</p><pre><code>  ∅&#39; ⊢ M ⇓ clos (ƛ N′) δ
  -----------------------------
→ Σ[ N ∈ ∅ , ★ ⊢ ★ ] (M —↠ ƛ N)</code></pre><p>The proof is by induction on the big-step derivation. As is often necessary, one must generalize the statement to get the induction to go through. In the case for <code>⇓-app</code> (function application), the argument is added to the environment, so the environment becomes non-empty. The corresponding β reduction substitutes the argument into the body of the lambda abstraction. So we generalize the lemma to allow an arbitrary environment <code>γ</code> and we add a premise that relates the environment <code>γ</code> to an equivalent substitution <code>σ</code>.</p><p>The case for <code>⇓-app</code> also requires that we strengthen the conclusion. In the case for <code>⇓-app</code> we have <code>γ ⊢ L ⇓ clos (λ N) δ</code> and the induction hypothesis gives us <code>L —↠ ƛ N′</code>, but we need to know that <code>N</code> and <code>N′</code> are equivalent. In particular, that <code>N′ ≡ subst τ N</code> where <code>τ</code> is the substitution that is equivalent to <code>δ</code>. Therefore we expand the conclusion of the statement, stating that the results are equivalent.</p><p>We make the two notions of equivalence precise by defining the following two mutually-recursive predicates <code>V ≈ M</code> and <code>γ ≈ₑ σ</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-_≈_"></a><a id="plfa_plfa-part2-BigStep-6229" href="../BigStep/#plfa_plfa-part2-BigStep-6229" class="Function Operator">_≈_</a> <a id="plfa_plfa-part2-BigStep-6233" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6235" href="../BigStep/#plfa_plfa-part2-BigStep-2411" class="Datatype">Clos</a> <a id="plfa_plfa-part2-BigStep-6240" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6242" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6243" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-6245" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-6247" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-6248" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-6250" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6252" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="plfa_plfa-part2-BigStep-_≈ₑ_"></a><a id="plfa_plfa-part2-BigStep-6256" href="../BigStep/#plfa_plfa-part2-BigStep-6256" class="Function Operator">_≈ₑ_</a> <a id="plfa_plfa-part2-BigStep-6261" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6263" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-6265" href="../BigStep/#plfa_plfa-part2-BigStep-6265" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-6266" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6268" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6270" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-6278" href="../BigStep/#plfa_plfa-part2-BigStep-6265" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-6280" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6282" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-6288" href="../BigStep/#plfa_plfa-part2-BigStep-6265" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-6290" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-6292" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6294" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="plfa_plfa-part2-BigStep-6299" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6300" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-6305" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-6306" href="../BigStep/#plfa_plfa-part2-BigStep-6306" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-6307" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6309" href="../BigStep/#plfa_plfa-part2-BigStep-6309" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-6311" href="../BigStep/#plfa_plfa-part2-BigStep-6311" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-6312" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-6314" href="../BigStep/#plfa_plfa-part2-BigStep-6229" class="Function Operator">≈</a> <a id="plfa_plfa-part2-BigStep-6316" href="../BigStep/#plfa_plfa-part2-BigStep-6316" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-6318" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-6320" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ[</a> <a id="plfa_plfa-part2-BigStep-6323" href="../BigStep/#plfa_plfa-part2-BigStep-6323" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6325" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">∈</a> <a id="plfa_plfa-part2-BigStep-6327" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-6333" href="../BigStep/#plfa_plfa-part2-BigStep-6306" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-6335" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-6337" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">]</a> <a id="plfa_plfa-part2-BigStep-6339" href="../BigStep/#plfa_plfa-part2-BigStep-6311" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-6341" href="../BigStep/#plfa_plfa-part2-BigStep-6256" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-6344" href="../BigStep/#plfa_plfa-part2-BigStep-6323" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6346" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1167" class="Function Operator">×</a> <a id="plfa_plfa-part2-BigStep-6348" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6349" href="../BigStep/#plfa_plfa-part2-BigStep-6316" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-6351" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-6353" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-6359" href="../BigStep/#plfa_plfa-part2-BigStep-6323" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6361" href="../BigStep/#plfa_plfa-part2-BigStep-6309" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-6362" class="Symbol">)</a>

<a id="plfa_plfa-part2-BigStep-6365" href="../BigStep/#plfa_plfa-part2-BigStep-6365" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-6367" href="../BigStep/#plfa_plfa-part2-BigStep-6256" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-6370" href="../BigStep/#plfa_plfa-part2-BigStep-6370" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6372" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-6374" class="Symbol">∀</a> <a id="plfa_plfa-part2-BigStep-6376" href="../BigStep/#plfa_plfa-part2-BigStep-6376" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-6378" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6380" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6381" href="../BigStep/#plfa_plfa-part2-BigStep-6365" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-6383" href="../BigStep/#plfa_plfa-part2-BigStep-6376" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-6384" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-6386" href="../BigStep/#plfa_plfa-part2-BigStep-6229" class="Function Operator">≈</a> <a id="plfa_plfa-part2-BigStep-6388" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6389" href="../BigStep/#plfa_plfa-part2-BigStep-6370" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6391" href="../BigStep/#plfa_plfa-part2-BigStep-6376" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-6392" class="Symbol">)</a>
</pre><p>We can now state the main lemma:</p><pre><code>If γ ⊢ M ⇓ V  and  γ ≈ₑ σ,
then  subst σ M —↠ N  and  V ≈ N  for some N.</code></pre><p>Before starting the proof, we establish a couple lemmas about equivalent environments and substitutions.</p><p>The empty environment is equivalent to the identity substitution <code>ids</code>, which we import from Chapter <a href="../Substitution/">Substitution</a>.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-≈ₑ-id"></a><a id="plfa_plfa-part2-BigStep-6763" href="../BigStep/#plfa_plfa-part2-BigStep-6763" class="Function">≈ₑ-id</a> <a id="plfa_plfa-part2-BigStep-6769" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6771" href="../BigStep/#plfa_plfa-part2-BigStep-2598" class="Function">∅&#39;</a> <a id="plfa_plfa-part2-BigStep-6774" href="../BigStep/#plfa_plfa-part2-BigStep-6256" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-6777" href="../Substitution/#plfa_plfa-part2-Substitution-2996" class="Function">ids</a>
<a id="plfa_plfa-part2-BigStep-6781" href="../BigStep/#plfa_plfa-part2-BigStep-6763" class="Function">≈ₑ-id</a> <a id="plfa_plfa-part2-BigStep-6787" class="Symbol">()</a>
</pre><p>Of course, applying the identity substitution to a term returns the same term.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-sub-id"></a><a id="plfa_plfa-part2-BigStep-6883" href="../BigStep/#plfa_plfa-part2-BigStep-6883" class="Function">sub-id</a> <a id="plfa_plfa-part2-BigStep-6890" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6892" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-6894" href="../BigStep/#plfa_plfa-part2-BigStep-6894" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-6895" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6897" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-6898" href="../BigStep/#plfa_plfa-part2-BigStep-6898" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-6899" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6901" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-6902" href="../BigStep/#plfa_plfa-part2-BigStep-6902" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-6904" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6906" href="../BigStep/#plfa_plfa-part2-BigStep-6894" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-6908" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-6910" href="../BigStep/#plfa_plfa-part2-BigStep-6898" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-6911" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6913" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6915" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-6921" href="../Substitution/#plfa_plfa-part2-Substitution-2996" class="Function">ids</a> <a id="plfa_plfa-part2-BigStep-6925" href="../BigStep/#plfa_plfa-part2-BigStep-6902" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-6927" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-6929" href="../BigStep/#plfa_plfa-part2-BigStep-6902" class="Bound">M</a>
<a id="plfa_plfa-part2-BigStep-6931" href="../BigStep/#plfa_plfa-part2-BigStep-6883" class="Function">sub-id</a> <a id="plfa_plfa-part2-BigStep-6938" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-6940" href="../Substitution/#plfa_plfa-part2-Substitution-16837" class="Function">plfa.part2.Substitution.sub-id</a>
</pre><p>We define an auxiliary function for extending a substitution.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-ext-subst"></a><a id="plfa_plfa-part2-BigStep-7048" href="../BigStep/#plfa_plfa-part2-BigStep-7048" class="Function">ext-subst</a> <a id="plfa_plfa-part2-BigStep-7058" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7060" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-7062" href="../BigStep/#plfa_plfa-part2-BigStep-7062" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7064" href="../BigStep/#plfa_plfa-part2-BigStep-7064" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7065" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-7067" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-7069" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-7075" href="../BigStep/#plfa_plfa-part2-BigStep-7062" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7077" href="../BigStep/#plfa_plfa-part2-BigStep-7064" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-7079" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-7081" href="../BigStep/#plfa_plfa-part2-BigStep-7064" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-7083" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-7085" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-7087" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-7089" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-7095" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7096" href="../BigStep/#plfa_plfa-part2-BigStep-7062" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7098" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-7100" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-7101" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7103" href="../BigStep/#plfa_plfa-part2-BigStep-7064" class="Bound">Δ</a>
<a id="plfa_plfa-part2-BigStep-7105" href="../BigStep/#plfa_plfa-part2-BigStep-7048" class="Function">ext-subst</a><a id="plfa_plfa-part2-BigStep-7114" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-7115" href="../BigStep/#plfa_plfa-part2-BigStep-7115" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-7116" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7118" href="../BigStep/#plfa_plfa-part2-BigStep-7118" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7119" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-7121" href="../BigStep/#plfa_plfa-part2-BigStep-7121" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-7123" href="../BigStep/#plfa_plfa-part2-BigStep-7123" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-7125" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-7126" href="../BigStep/#plfa_plfa-part2-BigStep-7126" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-7127" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-7129" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-7131" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-7137" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7138" href="../Untyped/#plfa_plfa-part2-Untyped-7207" class="Function">subst-zero</a> <a id="plfa_plfa-part2-BigStep-7149" href="../BigStep/#plfa_plfa-part2-BigStep-7123" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-7150" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7152" href="https://agda.github.io/agda-stdlib/v1.7.1/Function.Base.html#1031" class="Function Operator">∘</a> <a id="plfa_plfa-part2-BigStep-7154" href="../Untyped/#plfa_plfa-part2-Untyped-6495" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-7159" href="../BigStep/#plfa_plfa-part2-BigStep-7121" class="Bound">σ</a>
</pre><p>The next lemma we need to prove states that if you start with an equivalent environment and substitution <code>γ ≈ₑ σ</code>, extending them with an equivalent closure and term <code>V ≈ N</code> produces an equivalent environment and substitution: <code>(γ ,&#39; V) ≈ₑ (ext-subst σ N)</code>, or equivalently, <code>(γ ,&#39; V) x ≈ (ext-subst σ N) x</code> for any variable <code>x</code>. The proof will be by induction on <code>x</code> and for the induction step we need the following lemma, which states that applying the composition of <code>exts σ</code> and <code>subst-zero</code> to <code>S x</code> is the same as just <code>σ x</code>, which is a corollary of a theorem in Chapter <a href="../Substitution/">Substitution</a>.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-subst-zero-exts"></a><a id="plfa_plfa-part2-BigStep-7784" href="../BigStep/#plfa_plfa-part2-BigStep-7784" class="Function">subst-zero-exts</a> <a id="plfa_plfa-part2-BigStep-7800" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7802" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-7804" href="../BigStep/#plfa_plfa-part2-BigStep-7804" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7806" href="../BigStep/#plfa_plfa-part2-BigStep-7806" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7807" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7809" href="../BigStep/#plfa_plfa-part2-BigStep-7809" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-7811" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7813" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-7819" href="../BigStep/#plfa_plfa-part2-BigStep-7804" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7821" href="../BigStep/#plfa_plfa-part2-BigStep-7806" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7822" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7824" href="../BigStep/#plfa_plfa-part2-BigStep-7824" class="Bound">B</a><a id="plfa_plfa-part2-BigStep-7825" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7827" href="../BigStep/#plfa_plfa-part2-BigStep-7827" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-7829" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7831" href="../BigStep/#plfa_plfa-part2-BigStep-7806" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-7833" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-7835" href="../BigStep/#plfa_plfa-part2-BigStep-7824" class="Bound">B</a><a id="plfa_plfa-part2-BigStep-7836" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7838" href="../BigStep/#plfa_plfa-part2-BigStep-7838" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-7840" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7842" href="../BigStep/#plfa_plfa-part2-BigStep-7804" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7844" href="../Untyped/#plfa_plfa-part2-Untyped-3158" class="Datatype Operator">∋</a> <a id="plfa_plfa-part2-BigStep-7846" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-7847" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-7851" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-7853" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7854" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-7860" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7861" href="../Untyped/#plfa_plfa-part2-Untyped-7207" class="Function">subst-zero</a> <a id="plfa_plfa-part2-BigStep-7872" href="../BigStep/#plfa_plfa-part2-BigStep-7827" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-7873" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7875" href="https://agda.github.io/agda-stdlib/v1.7.1/Function.Base.html#1031" class="Function Operator">∘</a> <a id="plfa_plfa-part2-BigStep-7877" href="../Untyped/#plfa_plfa-part2-Untyped-6495" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-7882" href="../BigStep/#plfa_plfa-part2-BigStep-7809" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-7883" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7885" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7886" href="../Untyped/#plfa_plfa-part2-Untyped-3239" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-BigStep-7888" href="../BigStep/#plfa_plfa-part2-BigStep-7838" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-7889" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7891" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-7893" href="../BigStep/#plfa_plfa-part2-BigStep-7809" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-7895" href="../BigStep/#plfa_plfa-part2-BigStep-7838" class="Bound">x</a>
<a id="plfa_plfa-part2-BigStep-7897" href="../BigStep/#plfa_plfa-part2-BigStep-7784" class="Function">subst-zero-exts</a> <a id="plfa_plfa-part2-BigStep-7913" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-7914" href="../BigStep/#plfa_plfa-part2-BigStep-7914" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-7915" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7917" href="../BigStep/#plfa_plfa-part2-BigStep-7917" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7918" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7920" href="../BigStep/#plfa_plfa-part2-BigStep-7920" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-7921" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7923" href="../BigStep/#plfa_plfa-part2-BigStep-7923" class="Bound">B</a><a id="plfa_plfa-part2-BigStep-7924" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7926" href="../BigStep/#plfa_plfa-part2-BigStep-7926" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-7927" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7929" href="../BigStep/#plfa_plfa-part2-BigStep-7929" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-7930" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-7932" class="Symbol">=</a>
   <a id="plfa_plfa-part2-BigStep-7937" href="https://agda.github.io/agda-stdlib/v1.7.1/Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="plfa_plfa-part2-BigStep-7946" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7947" href="../Substitution/#plfa_plfa-part2-Substitution-25100" class="Function">plfa.part2.Substitution.subst-zero-exts-cons</a><a id="plfa_plfa-part2-BigStep-7991" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-7992" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-7994" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-7996" href="../BigStep/#plfa_plfa-part2-BigStep-7920" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-7997" class="Symbol">})</a> <a id="plfa_plfa-part2-BigStep-8000" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8001" href="../Untyped/#plfa_plfa-part2-Untyped-3239" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-BigStep-8003" href="../BigStep/#plfa_plfa-part2-BigStep-7929" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-8004" class="Symbol">)</a>
</pre><p>So the proof of <code>≈ₑ-ext</code> is as follows.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-≈ₑ-ext"></a><a id="plfa_plfa-part2-BigStep-8060" href="../BigStep/#plfa_plfa-part2-BigStep-8060" class="Function">≈ₑ-ext</a> <a id="plfa_plfa-part2-BigStep-8067" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8069" class="Symbol">∀</a> <a id="plfa_plfa-part2-BigStep-8071" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8072" href="../BigStep/#plfa_plfa-part2-BigStep-8072" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-8073" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8075" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8076" href="../BigStep/#plfa_plfa-part2-BigStep-8076" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-8078" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8080" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-8088" href="../BigStep/#plfa_plfa-part2-BigStep-8072" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-8089" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8091" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8092" href="../BigStep/#plfa_plfa-part2-BigStep-8092" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-8094" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8096" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-8102" href="../BigStep/#plfa_plfa-part2-BigStep-8072" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-8104" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a><a id="plfa_plfa-part2-BigStep-8105" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8107" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8108" href="../BigStep/#plfa_plfa-part2-BigStep-8108" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-8109" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8111" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8112" href="../BigStep/#plfa_plfa-part2-BigStep-8112" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-8114" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8116" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-8118" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-8120" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-8121" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-8125" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-8127" href="../BigStep/#plfa_plfa-part2-BigStep-8076" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-8129" href="../BigStep/#plfa_plfa-part2-BigStep-6256" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-8132" href="../BigStep/#plfa_plfa-part2-BigStep-8092" class="Bound">σ</a>  <a id="plfa_plfa-part2-BigStep-8135" class="Symbol">→</a>  <a id="plfa_plfa-part2-BigStep-8138" href="../BigStep/#plfa_plfa-part2-BigStep-8108" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-8140" href="../BigStep/#plfa_plfa-part2-BigStep-6229" class="Function Operator">≈</a> <a id="plfa_plfa-part2-BigStep-8142" href="../BigStep/#plfa_plfa-part2-BigStep-8112" class="Bound">N</a>
    <a id="plfa_plfa-part2-BigStep-8148" class="Comment">--------------------------</a>
  <a id="plfa_plfa-part2-BigStep-8177" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-8179" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8180" href="../BigStep/#plfa_plfa-part2-BigStep-8076" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-8182" href="../BigStep/#plfa_plfa-part2-BigStep-2620" class="Function Operator">,&#39;</a> <a id="plfa_plfa-part2-BigStep-8185" href="../BigStep/#plfa_plfa-part2-BigStep-8108" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-8186" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-8188" href="../BigStep/#plfa_plfa-part2-BigStep-6256" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-8191" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8192" href="../BigStep/#plfa_plfa-part2-BigStep-7048" class="Function">ext-subst</a> <a id="plfa_plfa-part2-BigStep-8202" href="../BigStep/#plfa_plfa-part2-BigStep-8092" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-8204" href="../BigStep/#plfa_plfa-part2-BigStep-8112" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-8205" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-8207" href="../BigStep/#plfa_plfa-part2-BigStep-8060" class="Function">≈ₑ-ext</a> <a id="plfa_plfa-part2-BigStep-8214" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8215" href="../BigStep/#plfa_plfa-part2-BigStep-8215" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-8216" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8218" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8219" href="../BigStep/#plfa_plfa-part2-BigStep-8219" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-8220" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8222" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8223" href="../BigStep/#plfa_plfa-part2-BigStep-8223" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-8224" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8226" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8227" href="../BigStep/#plfa_plfa-part2-BigStep-8227" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-8228" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8230" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8231" href="../BigStep/#plfa_plfa-part2-BigStep-8231" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-8232" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8234" href="../BigStep/#plfa_plfa-part2-BigStep-8234" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-8239" href="../BigStep/#plfa_plfa-part2-BigStep-8239" class="Bound">V≈N</a> <a id="plfa_plfa-part2-BigStep-8243" href="../Untyped/#plfa_plfa-part2-Untyped-3194" class="InductiveConstructor">Z</a> <a id="plfa_plfa-part2-BigStep-8245" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8247" href="../BigStep/#plfa_plfa-part2-BigStep-8239" class="Bound">V≈N</a>
<a id="plfa_plfa-part2-BigStep-8251" href="../BigStep/#plfa_plfa-part2-BigStep-8060" class="Function">≈ₑ-ext</a> <a id="plfa_plfa-part2-BigStep-8258" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8259" href="../BigStep/#plfa_plfa-part2-BigStep-8259" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-8260" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8262" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8263" href="../BigStep/#plfa_plfa-part2-BigStep-8263" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-8264" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8266" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8267" href="../BigStep/#plfa_plfa-part2-BigStep-8267" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-8268" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8270" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8271" href="../BigStep/#plfa_plfa-part2-BigStep-8271" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-8272" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8274" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8275" href="../BigStep/#plfa_plfa-part2-BigStep-8275" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-8276" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8278" href="../BigStep/#plfa_plfa-part2-BigStep-8278" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-8283" href="../BigStep/#plfa_plfa-part2-BigStep-8283" class="Bound">V≈N</a> <a id="plfa_plfa-part2-BigStep-8287" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8288" href="../Untyped/#plfa_plfa-part2-Untyped-3239" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-BigStep-8290" href="../BigStep/#plfa_plfa-part2-BigStep-8290" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-8291" class="Symbol">)</a>
  <a id="plfa_plfa-part2-BigStep-8295" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-8303" href="../BigStep/#plfa_plfa-part2-BigStep-7784" class="Function">subst-zero-exts</a> <a id="plfa_plfa-part2-BigStep-8319" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8320" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-8322" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8324" href="../BigStep/#plfa_plfa-part2-BigStep-8267" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-8325" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8327" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-8329" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8331" href="../BigStep/#plfa_plfa-part2-BigStep-8275" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-8332" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8334" href="../BigStep/#plfa_plfa-part2-BigStep-8290" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-8335" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8337" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8339" href="../BigStep/#plfa_plfa-part2-BigStep-8278" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-8344" href="../BigStep/#plfa_plfa-part2-BigStep-8290" class="Bound">x</a>
</pre><p>We proceed by induction on the input variable.</p><ul><li><p>If it is <code>Z</code>, then we immediately conclude using the premise <code>V ≈ N</code>.</p></li><li><p>If it is <code>S x</code>, then we rewrite using the <code>subst-zero-exts</code> lemma and use the premise <code>γ ≈ₑ σ</code> to conclude.</p></li></ul><p>To prove the main lemma, we need another technical lemma about substitution. Applying one substitution after another is the same as composing the two substitutions and then applying them.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-sub-sub"></a><a id="plfa_plfa-part2-BigStep-8787" href="../BigStep/#plfa_plfa-part2-BigStep-8787" class="Function">sub-sub</a> <a id="plfa_plfa-part2-BigStep-8795" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8797" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-8799" href="../BigStep/#plfa_plfa-part2-BigStep-8799" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-8801" href="../BigStep/#plfa_plfa-part2-BigStep-8801" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-8803" href="../BigStep/#plfa_plfa-part2-BigStep-8803" class="Bound">Σ</a><a id="plfa_plfa-part2-BigStep-8804" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8806" href="../BigStep/#plfa_plfa-part2-BigStep-8806" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-8807" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8809" href="../BigStep/#plfa_plfa-part2-BigStep-8809" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-8811" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8813" href="../BigStep/#plfa_plfa-part2-BigStep-8799" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-8815" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-8817" href="../BigStep/#plfa_plfa-part2-BigStep-8806" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-8818" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8820" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8821" href="../BigStep/#plfa_plfa-part2-BigStep-8821" class="Bound">σ₁</a> <a id="plfa_plfa-part2-BigStep-8824" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8826" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-8832" href="../BigStep/#plfa_plfa-part2-BigStep-8799" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-8834" href="../BigStep/#plfa_plfa-part2-BigStep-8801" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-8835" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8837" href="../BigStep/#plfa_plfa-part2-BigStep-8837" class="Bound">σ₂</a> <a id="plfa_plfa-part2-BigStep-8840" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8842" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-8848" href="../BigStep/#plfa_plfa-part2-BigStep-8801" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-8850" href="../BigStep/#plfa_plfa-part2-BigStep-8803" class="Bound">Σ</a><a id="plfa_plfa-part2-BigStep-8851" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-8855" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-8857" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-8863" href="../BigStep/#plfa_plfa-part2-BigStep-8837" class="Bound">σ₂</a> <a id="plfa_plfa-part2-BigStep-8866" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8867" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-8873" href="../BigStep/#plfa_plfa-part2-BigStep-8821" class="Bound">σ₁</a> <a id="plfa_plfa-part2-BigStep-8876" href="../BigStep/#plfa_plfa-part2-BigStep-8809" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-8877" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-8879" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-8881" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-8887" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8888" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-8894" href="../BigStep/#plfa_plfa-part2-BigStep-8837" class="Bound">σ₂</a> <a id="plfa_plfa-part2-BigStep-8897" href="https://agda.github.io/agda-stdlib/v1.7.1/Function.Base.html#1031" class="Function Operator">∘</a> <a id="plfa_plfa-part2-BigStep-8899" href="../BigStep/#plfa_plfa-part2-BigStep-8821" class="Bound">σ₁</a><a id="plfa_plfa-part2-BigStep-8901" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-8903" href="../BigStep/#plfa_plfa-part2-BigStep-8809" class="Bound">M</a>
<a id="plfa_plfa-part2-BigStep-8905" href="../BigStep/#plfa_plfa-part2-BigStep-8787" class="Function">sub-sub</a> <a id="plfa_plfa-part2-BigStep-8913" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8914" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-8916" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8918" href="../BigStep/#plfa_plfa-part2-BigStep-8918" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-8919" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8921" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8923" href="../Substitution/#plfa_plfa-part2-Substitution-22858" class="Function">plfa.part2.Substitution.sub-sub</a> <a id="plfa_plfa-part2-BigStep-8955" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8956" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-8958" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8960" href="../BigStep/#plfa_plfa-part2-BigStep-8918" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-8961" class="Symbol">}</a>
</pre><p>We arrive at the main lemma: if <code>M</code> big steps to a closure <code>V</code> in environment <code>γ</code>, and if <code>γ ≈ₑ σ</code>, then <code>subst σ M</code> reduces to some term <code>N</code> that is equivalent to <code>V</code>. We describe the proof below.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-⇓→—↠×≈"></a><a id="plfa_plfa-part2-BigStep-9175" href="../BigStep/#plfa_plfa-part2-BigStep-9175" class="Function">⇓→—↠×≈</a> <a id="plfa_plfa-part2-BigStep-9182" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9184" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-9186" href="../BigStep/#plfa_plfa-part2-BigStep-9186" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-9187" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9189" href="../BigStep/#plfa_plfa-part2-BigStep-9189" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-9191" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9193" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-9201" href="../BigStep/#plfa_plfa-part2-BigStep-9186" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-9202" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9204" href="../BigStep/#plfa_plfa-part2-BigStep-9204" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9206" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9208" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-9214" href="../BigStep/#plfa_plfa-part2-BigStep-9186" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-9216" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a><a id="plfa_plfa-part2-BigStep-9217" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9219" href="../BigStep/#plfa_plfa-part2-BigStep-9219" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-9221" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9223" href="../BigStep/#plfa_plfa-part2-BigStep-9186" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-9225" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-9227" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-9228" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9230" href="../BigStep/#plfa_plfa-part2-BigStep-9230" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-9232" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9234" href="../BigStep/#plfa_plfa-part2-BigStep-2411" class="Datatype">Clos</a><a id="plfa_plfa-part2-BigStep-9238" class="Symbol">}</a>
       <a id="plfa_plfa-part2-BigStep-9247" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-9249" href="../BigStep/#plfa_plfa-part2-BigStep-9189" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-9251" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-9253" href="../BigStep/#plfa_plfa-part2-BigStep-9219" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-9255" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-9257" href="../BigStep/#plfa_plfa-part2-BigStep-9230" class="Bound">V</a>  <a id="plfa_plfa-part2-BigStep-9260" class="Symbol">→</a>  <a id="plfa_plfa-part2-BigStep-9263" href="../BigStep/#plfa_plfa-part2-BigStep-9189" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-9265" href="../BigStep/#plfa_plfa-part2-BigStep-6256" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-9268" href="../BigStep/#plfa_plfa-part2-BigStep-9204" class="Bound">σ</a>
         <a id="plfa_plfa-part2-BigStep-9279" class="Comment">---------------------------------------</a>
       <a id="plfa_plfa-part2-BigStep-9326" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-9328" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ[</a> <a id="plfa_plfa-part2-BigStep-9331" href="../BigStep/#plfa_plfa-part2-BigStep-9331" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-9333" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">∈</a> <a id="plfa_plfa-part2-BigStep-9335" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-9337" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-9339" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-9341" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">]</a> <a id="plfa_plfa-part2-BigStep-9343" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9344" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-9350" href="../BigStep/#plfa_plfa-part2-BigStep-9204" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9352" href="../BigStep/#plfa_plfa-part2-BigStep-9219" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-9354" href="../Untyped/#plfa_plfa-part2-Untyped-10990" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-BigStep-9357" href="../BigStep/#plfa_plfa-part2-BigStep-9331" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9358" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9360" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1167" class="Function Operator">×</a> <a id="plfa_plfa-part2-BigStep-9362" href="../BigStep/#plfa_plfa-part2-BigStep-9230" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-9364" href="../BigStep/#plfa_plfa-part2-BigStep-6229" class="Function Operator">≈</a> <a id="plfa_plfa-part2-BigStep-9366" href="../BigStep/#plfa_plfa-part2-BigStep-9331" class="Bound">N</a>
<a id="plfa_plfa-part2-BigStep-9368" href="../BigStep/#plfa_plfa-part2-BigStep-9175" class="Function">⇓→—↠×≈</a> <a id="plfa_plfa-part2-BigStep-9375" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9376" class="Argument">γ</a> <a id="plfa_plfa-part2-BigStep-9378" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9380" href="../BigStep/#plfa_plfa-part2-BigStep-9380" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-9381" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9383" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9384" href="../BigStep/#plfa_plfa-part2-BigStep-3030" class="InductiveConstructor">⇓-var</a><a id="plfa_plfa-part2-BigStep-9389" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9390" class="Argument">x</a> <a id="plfa_plfa-part2-BigStep-9392" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9394" href="../BigStep/#plfa_plfa-part2-BigStep-9394" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-9395" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9397" href="../BigStep/#plfa_plfa-part2-BigStep-9397" class="Bound">γx≡Lδ</a> <a id="plfa_plfa-part2-BigStep-9403" href="../BigStep/#plfa_plfa-part2-BigStep-9403" class="Bound">δ⊢L⇓V</a><a id="plfa_plfa-part2-BigStep-9408" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9410" href="../BigStep/#plfa_plfa-part2-BigStep-9410" class="Bound">γ≈ₑσ</a>
    <a id="plfa_plfa-part2-BigStep-9419" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-9424" href="../BigStep/#plfa_plfa-part2-BigStep-9380" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-9426" href="../BigStep/#plfa_plfa-part2-BigStep-9394" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-9428" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9430" href="../BigStep/#plfa_plfa-part2-BigStep-9410" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-9435" href="../BigStep/#plfa_plfa-part2-BigStep-9394" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-9437" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9439" href="../BigStep/#plfa_plfa-part2-BigStep-9397" class="Bound">γx≡Lδ</a>
<a id="plfa_plfa-part2-BigStep-9445" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-9449" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9451" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-9456" href="../BigStep/#plfa_plfa-part2-BigStep-9456" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-9458" href="../BigStep/#plfa_plfa-part2-BigStep-9458" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-9460" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9462" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9464" href="../BigStep/#plfa_plfa-part2-BigStep-9464" class="Bound">τ</a> <a id="plfa_plfa-part2-BigStep-9466" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9468" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9470" href="../BigStep/#plfa_plfa-part2-BigStep-9470" class="Bound">δ≈ₑτ</a> <a id="plfa_plfa-part2-BigStep-9475" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9477" href="../BigStep/#plfa_plfa-part2-BigStep-9477" class="Bound">σx≡τL</a> <a id="plfa_plfa-part2-BigStep-9483" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9485" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9487" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9489" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
      <a id="plfa_plfa-part2-BigStep-9500" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-9505" href="../BigStep/#plfa_plfa-part2-BigStep-9175" class="Function">⇓→—↠×≈</a><a id="plfa_plfa-part2-BigStep-9511" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9512" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9514" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9516" href="../BigStep/#plfa_plfa-part2-BigStep-9464" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-9517" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9519" class="Bound">δ⊢L⇓V</a> <a id="plfa_plfa-part2-BigStep-9525" href="../BigStep/#plfa_plfa-part2-BigStep-9470" class="Bound">δ≈ₑτ</a>
<a id="plfa_plfa-part2-BigStep-9530" class="Symbol">...</a>   <a id="plfa_plfa-part2-BigStep-9536" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9538" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9540" href="../BigStep/#plfa_plfa-part2-BigStep-9540" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-9542" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9544" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9546" href="../BigStep/#plfa_plfa-part2-BigStep-9546" class="Bound">τL—↠N</a> <a id="plfa_plfa-part2-BigStep-9552" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9554" href="../BigStep/#plfa_plfa-part2-BigStep-9554" class="Bound">V≈N</a> <a id="plfa_plfa-part2-BigStep-9558" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9560" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9562" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-9570" class="Bound">σx≡τL</a> <a id="plfa_plfa-part2-BigStep-9576" class="Symbol">=</a>
        <a id="plfa_plfa-part2-BigStep-9586" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9588" href="../BigStep/#plfa_plfa-part2-BigStep-9540" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-9590" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9592" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9594" href="../BigStep/#plfa_plfa-part2-BigStep-9546" class="Bound">τL—↠N</a> <a id="plfa_plfa-part2-BigStep-9600" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9602" href="../BigStep/#plfa_plfa-part2-BigStep-9554" class="Bound">V≈N</a> <a id="plfa_plfa-part2-BigStep-9606" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9608" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a>
<a id="plfa_plfa-part2-BigStep-9610" href="../BigStep/#plfa_plfa-part2-BigStep-9175" class="Function">⇓→—↠×≈</a> <a id="plfa_plfa-part2-BigStep-9617" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9618" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9620" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9622" href="../BigStep/#plfa_plfa-part2-BigStep-9622" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-9623" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9625" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9626" class="Argument">V</a> <a id="plfa_plfa-part2-BigStep-9628" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9630" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-9635" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9636" href="../Untyped/#plfa_plfa-part2-Untyped-4023" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-9638" href="../BigStep/#plfa_plfa-part2-BigStep-9638" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9639" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9641" href="../BigStep/#plfa_plfa-part2-BigStep-9641" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-9642" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9644" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9645" href="../BigStep/#plfa_plfa-part2-BigStep-3177" class="InductiveConstructor">⇓-lam</a><a id="plfa_plfa-part2-BigStep-9650" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9652" href="../BigStep/#plfa_plfa-part2-BigStep-9652" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-9657" class="Symbol">=</a>
    <a id="plfa_plfa-part2-BigStep-9663" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9665" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-9671" href="../BigStep/#plfa_plfa-part2-BigStep-9622" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9673" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9674" href="../Untyped/#plfa_plfa-part2-Untyped-4023" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-9676" href="../BigStep/#plfa_plfa-part2-BigStep-9638" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9677" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9679" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9681" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9683" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-9689" href="../BigStep/#plfa_plfa-part2-BigStep-9622" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9691" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9692" href="../Untyped/#plfa_plfa-part2-Untyped-4023" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-9694" href="../BigStep/#plfa_plfa-part2-BigStep-9638" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9695" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9697" href="../Untyped/#plfa_plfa-part2-Untyped-11040" class="InductiveConstructor Operator">∎</a> <a id="plfa_plfa-part2-BigStep-9699" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9701" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9703" href="../BigStep/#plfa_plfa-part2-BigStep-9622" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9705" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9707" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9709" href="../BigStep/#plfa_plfa-part2-BigStep-9652" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-9714" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9716" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="plfa_plfa-part2-BigStep-9721" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9723" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9725" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9727" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a>
<a id="plfa_plfa-part2-BigStep-9729" href="../BigStep/#plfa_plfa-part2-BigStep-9175" class="Function">⇓→—↠×≈</a><a id="plfa_plfa-part2-BigStep-9735" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9736" href="../BigStep/#plfa_plfa-part2-BigStep-9736" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-9737" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9739" href="../BigStep/#plfa_plfa-part2-BigStep-9739" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-9740" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9742" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9743" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9745" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9747" href="../BigStep/#plfa_plfa-part2-BigStep-9747" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-9748" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9750" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9751" href="../BigStep/#plfa_plfa-part2-BigStep-9751" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-9753" href="../Untyped/#plfa_plfa-part2-Untyped-4083" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-BigStep-9755" href="../BigStep/#plfa_plfa-part2-BigStep-9755" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-9756" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9758" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9759" href="../BigStep/#plfa_plfa-part2-BigStep-9759" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-9760" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9762" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9763" href="../BigStep/#plfa_plfa-part2-BigStep-3252" class="InductiveConstructor">⇓-app</a> <a id="plfa_plfa-part2-BigStep-9769" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9770" class="Argument">N</a> <a id="plfa_plfa-part2-BigStep-9772" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9774" href="../BigStep/#plfa_plfa-part2-BigStep-9774" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9775" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9777" href="../BigStep/#plfa_plfa-part2-BigStep-9777" class="Bound">L⇓ƛNδ</a> <a id="plfa_plfa-part2-BigStep-9783" href="../BigStep/#plfa_plfa-part2-BigStep-9783" class="Bound">N⇓V</a><a id="plfa_plfa-part2-BigStep-9786" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9788" href="../BigStep/#plfa_plfa-part2-BigStep-9788" class="Bound">γ≈ₑσ</a>
    <a id="plfa_plfa-part2-BigStep-9797" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-9802" href="../BigStep/#plfa_plfa-part2-BigStep-9175" class="Function">⇓→—↠×≈</a><a id="plfa_plfa-part2-BigStep-9808" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9809" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9811" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9813" href="../BigStep/#plfa_plfa-part2-BigStep-9747" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-9814" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9816" href="../BigStep/#plfa_plfa-part2-BigStep-9777" class="Bound">L⇓ƛNδ</a> <a id="plfa_plfa-part2-BigStep-9822" href="../BigStep/#plfa_plfa-part2-BigStep-9788" class="Bound">γ≈ₑσ</a>
<a id="plfa_plfa-part2-BigStep-9827" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-9831" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9833" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9835" class="Symbol">_</a> <a id="plfa_plfa-part2-BigStep-9837" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9839" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9841" href="../BigStep/#plfa_plfa-part2-BigStep-9841" class="Bound">σL—↠ƛτN</a> <a id="plfa_plfa-part2-BigStep-9849" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9851" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9853" href="../BigStep/#plfa_plfa-part2-BigStep-9853" class="Bound">τ</a> <a id="plfa_plfa-part2-BigStep-9855" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9857" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9859" href="../BigStep/#plfa_plfa-part2-BigStep-9859" class="Bound">δ≈ₑτ</a> <a id="plfa_plfa-part2-BigStep-9864" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9866" href="../BigStep/#plfa_plfa-part2-BigStep-9866" class="Bound">≡ƛτN</a> <a id="plfa_plfa-part2-BigStep-9871" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9873" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9875" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9877" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9879" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-9887" href="../BigStep/#plfa_plfa-part2-BigStep-9866" class="Bound">≡ƛτN</a>
      <a id="plfa_plfa-part2-BigStep-9898" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-9903" href="../BigStep/#plfa_plfa-part2-BigStep-9175" class="Function">⇓→—↠×≈</a> <a id="plfa_plfa-part2-BigStep-9910" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9911" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9913" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9915" href="../BigStep/#plfa_plfa-part2-BigStep-7048" class="Function">ext-subst</a> <a id="plfa_plfa-part2-BigStep-9925" href="../BigStep/#plfa_plfa-part2-BigStep-9853" class="Bound">τ</a> <a id="plfa_plfa-part2-BigStep-9927" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9928" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-9934" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9936" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-9937" class="Symbol">)}</a> <a id="plfa_plfa-part2-BigStep-9940" class="Bound">N⇓V</a>
             <a id="plfa_plfa-part2-BigStep-9957" class="Symbol">(λ</a> <a id="plfa_plfa-part2-BigStep-9960" href="../BigStep/#plfa_plfa-part2-BigStep-9960" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-9962" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-9964" href="../BigStep/#plfa_plfa-part2-BigStep-8060" class="Function">≈ₑ-ext</a><a id="plfa_plfa-part2-BigStep-9970" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9971" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9973" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9975" href="../BigStep/#plfa_plfa-part2-BigStep-9853" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-9976" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9978" href="../BigStep/#plfa_plfa-part2-BigStep-9859" class="Bound">δ≈ₑτ</a> <a id="plfa_plfa-part2-BigStep-9983" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9985" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9987" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9989" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9991" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-9996" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9998" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="plfa_plfa-part2-BigStep-10003" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10005" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10007" href="../BigStep/#plfa_plfa-part2-BigStep-9960" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-10008" class="Symbol">)</a>
           <a id="plfa_plfa-part2-BigStep-10021" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-10023" href="../Untyped/#plfa_plfa-part2-Untyped-10088" class="InductiveConstructor">β</a><a id="plfa_plfa-part2-BigStep-10024" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-10025" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a><a id="plfa_plfa-part2-BigStep-10026" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-10028" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10034" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10035" href="../Untyped/#plfa_plfa-part2-Untyped-6495" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-10040" href="../BigStep/#plfa_plfa-part2-BigStep-9853" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-10041" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-10043" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-10044" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-10046" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10052" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-10054" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-10055" class="Symbol">}</a>
<a id="plfa_plfa-part2-BigStep-10057" class="Symbol">...</a>   <a id="plfa_plfa-part2-BigStep-10063" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-10065" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10067" href="../BigStep/#plfa_plfa-part2-BigStep-10067" class="Bound">N&#39;</a> <a id="plfa_plfa-part2-BigStep-10070" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10072" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10074" href="../BigStep/#plfa_plfa-part2-BigStep-10074" class="Bound">—↠N&#39;</a> <a id="plfa_plfa-part2-BigStep-10079" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10081" href="../BigStep/#plfa_plfa-part2-BigStep-10081" class="Bound">V≈N&#39;</a> <a id="plfa_plfa-part2-BigStep-10086" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10088" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10090" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-10092" href="../BigStep/#plfa_plfa-part2-BigStep-10092" class="Bound">ƛτN·σM—→</a>
        <a id="plfa_plfa-part2-BigStep-10109" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-10117" href="../BigStep/#plfa_plfa-part2-BigStep-8787" class="Function">sub-sub</a><a id="plfa_plfa-part2-BigStep-10124" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-10125" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-10127" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10129" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-10130" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-10132" class="Argument">σ₁</a> <a id="plfa_plfa-part2-BigStep-10135" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10137" href="../Untyped/#plfa_plfa-part2-Untyped-6495" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-10142" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-10143" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-10145" class="Argument">σ₂</a> <a id="plfa_plfa-part2-BigStep-10148" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10150" href="../Untyped/#plfa_plfa-part2-Untyped-7207" class="Function">subst-zero</a> <a id="plfa_plfa-part2-BigStep-10161" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10162" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10168" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-10170" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-10171" class="Symbol">)}</a> <a id="plfa_plfa-part2-BigStep-10174" class="Symbol">=</a>
        <a id="plfa_plfa-part2-BigStep-10184" class="Keyword">let</a> <a id="plfa_plfa-part2-BigStep-10188" href="../BigStep/#plfa_plfa-part2-BigStep-10188" class="Bound">rs</a> <a id="plfa_plfa-part2-BigStep-10191" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10193" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10194" href="../Untyped/#plfa_plfa-part2-Untyped-4023" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-10196" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10202" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10203" href="../Untyped/#plfa_plfa-part2-Untyped-6495" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-10208" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-10209" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-10211" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-10212" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-10214" href="../Untyped/#plfa_plfa-part2-Untyped-4083" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-BigStep-10216" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10222" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-10224" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-10226" href="../Untyped/#plfa_plfa-part2-Untyped-11096" class="InductiveConstructor Operator">—→⟨</a> <a id="plfa_plfa-part2-BigStep-10230" href="../BigStep/#plfa_plfa-part2-BigStep-10092" class="Bound">ƛτN·σM—→</a> <a id="plfa_plfa-part2-BigStep-10239" href="../Untyped/#plfa_plfa-part2-Untyped-11096" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10241" href="../BigStep/#plfa_plfa-part2-BigStep-10074" class="Bound">—↠N&#39;</a> <a id="plfa_plfa-part2-BigStep-10246" class="Keyword">in</a>
        <a id="plfa_plfa-part2-BigStep-10257" class="Keyword">let</a> <a id="plfa_plfa-part2-BigStep-10261" href="../BigStep/#plfa_plfa-part2-BigStep-10261" class="Bound">g</a> <a id="plfa_plfa-part2-BigStep-10263" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10265" href="../Untyped/#plfa_plfa-part2-Untyped-21715" class="Function">—↠-trans</a> <a id="plfa_plfa-part2-BigStep-10274" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10275" href="../Untyped/#plfa_plfa-part2-Untyped-22889" class="Function">appL-cong</a> <a id="plfa_plfa-part2-BigStep-10285" class="Bound">σL—↠ƛτN</a><a id="plfa_plfa-part2-BigStep-10292" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-10294" href="../BigStep/#plfa_plfa-part2-BigStep-10188" class="Bound">rs</a> <a id="plfa_plfa-part2-BigStep-10297" class="Keyword">in</a>
        <a id="plfa_plfa-part2-BigStep-10308" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10310" href="../BigStep/#plfa_plfa-part2-BigStep-10067" class="Bound">N&#39;</a> <a id="plfa_plfa-part2-BigStep-10313" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10315" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10317" href="../BigStep/#plfa_plfa-part2-BigStep-10261" class="Bound">g</a> <a id="plfa_plfa-part2-BigStep-10319" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10321" href="../BigStep/#plfa_plfa-part2-BigStep-10081" class="Bound">V≈N&#39;</a> <a id="plfa_plfa-part2-BigStep-10326" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10328" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a>
</pre><p>The proof is by induction on <code>γ ⊢ M ⇓ V</code>. We have three cases to consider.</p><ul><li><p>Case <code>⇓-var</code>. So we have <code>γ x ≡ clos L δ</code> and <code>δ ⊢ L ⇓ V</code>. We need to show that <code>subst σ (` x) —↠ N</code> and <code>V ≈ N</code> for some <code>N</code>. The premise <code>γ ≈ₑ σ</code> tells us that <code>γ x ≈ σ x</code>, so <code>clos L δ ≈ σ x</code>. By the definition of <code>≈</code>, there exists a <code>τ</code> such that <code>δ ≈ₑ τ</code> and <code>σ x ≡ subst τ L</code>. Using <code>δ ⊢ L ⇓ V</code> and <code>δ ≈ₑ τ</code>, the induction hypothesis gives us <code>subst τ L —↠ N</code> and <code>V ≈ N</code> for some <code>N</code>. So we have shown that <code>subst σ x —↠ N</code> and <code>V ≈ N</code> for some <code>N</code>.</p></li><li><p>Case <code>⇓-lam</code>. We immediately have <code>subst σ (ƛ N) —↠ subst σ (ƛ N)</code> and <code>clos (subst σ (ƛ N)) γ ≈ subst σ (ƛ N)</code>.</p></li><li><p>Case <code>⇓-app</code>. Using <code>γ ⊢ L ⇓ clos (ƛ N) δ</code> and <code>γ ≈ₑ σ</code>, the induction hypothesis gives us</p><pre><code>  subst σ L —↠ ƛ subst (exts τ) N                                     (1)</code></pre><p>and <code>δ ≈ₑ τ</code> for some <code>τ</code>. From <code>γ≈ₑσ</code> we have <code>clos M γ ≈ subst σ M</code>. Then with <code>(δ ,&#39; clos M γ) ⊢ N ⇓ V</code>, the induction hypothesis gives us <code>V ≈ N&#39;</code> and</p><pre><code>  subst (subst (subst-zero (subst σ M)) ∘ (exts τ)) N —↠ N&#39;         (2)</code></pre><p>Meanwhile, by <code>β</code>, we have</p><pre><code>  (ƛ subst (exts τ) N) · subst σ M
  —→ subst (subst-zero (subst σ M)) (subst (exts τ) N)</code></pre><p>which is the same as the following, by <code>sub-sub</code>.</p><pre><code>  (ƛ subst (exts τ) N) · subst σ M
  —→ subst (subst (subst-zero (subst σ M)) ∘ exts τ) N              (3)</code></pre><p>Using (3) and (2) we have</p><pre><code>  (ƛ subst (exts τ) N) · subst σ M —↠ N&#39;                             (4)</code></pre><p>From (1) we have</p><pre><code>  subst σ L · subst σ M —↠ (ƛ subst (exts τ) N) · subst σ M</code></pre><p>which we combine with (4) to conclude that</p><pre><code>  subst σ L · subst σ M —↠ N&#39;</code></pre></li></ul><p>With the main lemma complete, we establish the forward direction of the equivalence between the big-step semantics and beta reduction.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-cbn→reduce"></a><a id="plfa_plfa-part2-BigStep-12164" href="../BigStep/#plfa_plfa-part2-BigStep-12164" class="Function">cbn→reduce</a> <a id="plfa_plfa-part2-BigStep-12175" class="Symbol">:</a>  <a id="plfa_plfa-part2-BigStep-12178" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-12180" href="../BigStep/#plfa_plfa-part2-BigStep-12180" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-12182" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-12184" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-12186" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-12188" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-12189" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12191" href="../BigStep/#plfa_plfa-part2-BigStep-12191" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-12192" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12194" href="../BigStep/#plfa_plfa-part2-BigStep-12194" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-12196" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-12198" href="../BigStep/#plfa_plfa-part2-BigStep-2381" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-12206" href="../BigStep/#plfa_plfa-part2-BigStep-12191" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-12207" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12209" href="../BigStep/#plfa_plfa-part2-BigStep-12209" class="Bound">N′</a> <a id="plfa_plfa-part2-BigStep-12212" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-12214" href="../BigStep/#plfa_plfa-part2-BigStep-12191" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-12216" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12218" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-12220" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-12222" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-12223" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-12227" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-12229" href="../BigStep/#plfa_plfa-part2-BigStep-2598" class="Function">∅&#39;</a> <a id="plfa_plfa-part2-BigStep-12232" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-12234" href="../BigStep/#plfa_plfa-part2-BigStep-12180" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-12236" href="../BigStep/#plfa_plfa-part2-BigStep-2973" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-12238" href="../BigStep/#plfa_plfa-part2-BigStep-2430" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-12243" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-12244" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-12246" href="../BigStep/#plfa_plfa-part2-BigStep-12209" class="Bound">N′</a><a id="plfa_plfa-part2-BigStep-12248" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-12250" href="../BigStep/#plfa_plfa-part2-BigStep-12194" class="Bound">δ</a>
    <a id="plfa_plfa-part2-BigStep-12256" class="Comment">-----------------------------</a>
  <a id="plfa_plfa-part2-BigStep-12288" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-12290" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ[</a> <a id="plfa_plfa-part2-BigStep-12293" href="../BigStep/#plfa_plfa-part2-BigStep-12293" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-12295" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">∈</a> <a id="plfa_plfa-part2-BigStep-12297" href="../Untyped/#plfa_plfa-part2-Untyped-2804" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-12299" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12301" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-12303" href="../Untyped/#plfa_plfa-part2-Untyped-3935" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-12305" href="../Untyped/#plfa_plfa-part2-Untyped-2509" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-12307" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">]</a> <a id="plfa_plfa-part2-BigStep-12309" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-12310" href="../BigStep/#plfa_plfa-part2-BigStep-12180" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-12312" href="../Untyped/#plfa_plfa-part2-Untyped-10990" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-BigStep-12315" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-12317" href="../BigStep/#plfa_plfa-part2-BigStep-12293" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-12318" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-12320" href="../BigStep/#plfa_plfa-part2-BigStep-12164" class="Function">cbn→reduce</a> <a id="plfa_plfa-part2-BigStep-12331" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-12332" href="../BigStep/#plfa_plfa-part2-BigStep-12332" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-12333" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12335" href="../BigStep/#plfa_plfa-part2-BigStep-12335" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-12336" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12338" href="../BigStep/#plfa_plfa-part2-BigStep-12338" class="Bound">δ</a><a id="plfa_plfa-part2-BigStep-12339" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12341" href="../BigStep/#plfa_plfa-part2-BigStep-12341" class="Bound">N′</a><a id="plfa_plfa-part2-BigStep-12343" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-12345" href="../BigStep/#plfa_plfa-part2-BigStep-12345" class="Bound">M⇓c</a>
    <a id="plfa_plfa-part2-BigStep-12353" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-12358" href="../BigStep/#plfa_plfa-part2-BigStep-9175" class="Function">⇓→—↠×≈</a><a id="plfa_plfa-part2-BigStep-12364" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-12365" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-12367" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-12369" href="../Substitution/#plfa_plfa-part2-Substitution-2996" class="Function">ids</a><a id="plfa_plfa-part2-BigStep-12372" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-12374" href="../BigStep/#plfa_plfa-part2-BigStep-12345" class="Bound">M⇓c</a> <a id="plfa_plfa-part2-BigStep-12378" href="../BigStep/#plfa_plfa-part2-BigStep-6763" class="Function">≈ₑ-id</a>
<a id="plfa_plfa-part2-BigStep-12384" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-12388" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-12390" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12392" href="../BigStep/#plfa_plfa-part2-BigStep-12392" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-12394" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12396" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12398" href="../BigStep/#plfa_plfa-part2-BigStep-12398" class="Bound">rs</a> <a id="plfa_plfa-part2-BigStep-12401" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12403" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12405" href="../BigStep/#plfa_plfa-part2-BigStep-12405" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-12407" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12409" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12411" href="../BigStep/#plfa_plfa-part2-BigStep-12411" class="Bound">h</a> <a id="plfa_plfa-part2-BigStep-12413" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12415" href="../BigStep/#plfa_plfa-part2-BigStep-12415" class="Bound">eq2</a> <a id="plfa_plfa-part2-BigStep-12419" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-12421" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-12423" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-12425" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-12427" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-12435" href="../BigStep/#plfa_plfa-part2-BigStep-6883" class="Function">sub-id</a><a id="plfa_plfa-part2-BigStep-12441" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-12442" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-12444" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-12446" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-12447" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-12449" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-12451" href="../BigStep/#plfa_plfa-part2-BigStep-12415" class="Bound">eq2</a> <a id="plfa_plfa-part2-BigStep-12455" class="Symbol">=</a>
      <a id="plfa_plfa-part2-BigStep-12463" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12465" href="../Untyped/#plfa_plfa-part2-Untyped-6791" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-12471" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-12472" href="../Untyped/#plfa_plfa-part2-Untyped-6495" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-12477" href="../BigStep/#plfa_plfa-part2-BigStep-12405" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-12478" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-12480" class="Bound">N′</a> <a id="plfa_plfa-part2-BigStep-12483" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12485" href="../BigStep/#plfa_plfa-part2-BigStep-12398" class="Bound">rs</a> <a id="plfa_plfa-part2-BigStep-12488" href="../BigStep/#plfa_plfa-part2-BigStep-1459" class="InductiveConstructor Operator">⟩</a>
</pre><h4 id="exercise-big-alt-implies-multi-practice">Exercise <code>big-alt-implies-multi</code> (practice)</h4><p>Formulate an alternative big-step semantics, of the form <code>M ↓ N</code>, for call-by-name that uses substitution instead of environments. That is, the analogue of the application rule <code>⇓-app</code> should perform substitution, as in <code>N [ M ]</code>, instead of extending the environment with <code>M</code>. Prove that <code>M ↓ N</code> implies <code>M —↠ N</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-12870" class="Comment">-- Your code goes here</a>
</pre><h2 id="beta-reduction-to-a-lambda-implies-big-step-evaluation">Beta reduction to a lambda implies big-step evaluation</h2><p>The proof of the backward direction, that beta reduction to a lambda implies that the call-by-name semantics produces a result, is more difficult to prove. The difficulty stems from reduction proceeding underneath lambda abstractions via the <code>ζ</code> rule. The call-by-name semantics does not reduce under lambda, so a straightforward proof by induction on the reduction sequence is impossible. In the article <em>Call-by-name, call-by-value, and the λ-calculus</em>, Plotkin proves the theorem in two steps, using two auxiliary reduction relations. The first step uses a classic technique called Curry-Feys standardisation. It relies on the notion of <em>standard reduction sequence</em>, which acts as a half-way point between full beta reduction and call-by-name by expanding call-by-name to also include reduction underneath lambda. Plotkin proves that <code>M</code> reduces to <code>L</code> if and only if <code>M</code> is related to <code>L</code> by a standard reduction sequence.</p><pre><code>Theorem 1 (Standardisation)
`M —↠ L` if and only if `M` goes to `L` via a standard reduction sequence.</code></pre><p>Plotkin then introduces <em>left reduction</em>, a small-step version of call-by-name and uses the above theorem to prove that beta reduction and left reduction are equivalent in the following sense.</p><pre><code>Corollary 1
`M —↠ ƛ N` if and only if `M` goes to `ƛ N′`, for some `N′`, by left reduction.</code></pre><p>The second step of the proof connects left reduction to call-by-name evaluation.</p><pre><code>Theorem 2
`M` left reduces to `ƛ N` if and only if `⊢ M ⇓ ƛ N`.</code></pre><p>(Plotkin’s call-by-name evaluator uses substitution instead of environments, which explains why the environment is omitted in <code>⊢ M ⇓ ƛ N</code> in the above theorem statement.)</p><p>Putting Corollary 1 and Theorem 2 together, Plotkin proves that call-by-name evaluation is equivalent to beta reduction.</p><pre><code>Corollary 2
`M —↠ ƛ N` if and only if `⊢ M ⇓ ƛ N′` for some `N′`.</code></pre><p>Plotkin also proves an analogous result for the λᵥ calculus, relating it to call-by-value evaluation. For a nice exposition of that proof, we recommend Chapter 5 of <em>Semantics Engineering with PLT Redex</em> by Felleisen, Findler, and Flatt.</p><p>Instead of proving the backwards direction via standardisation, as sketched above, we defer the proof until after we define a denotational semantics for the lambda calculus, at which point the proof of the backwards direction will fall out as a corollary to the soundness and adequacy of the denotational semantics.</p><h2 id="unicode">Unicode</h2><p>This chapter uses the following unicode:</p><pre><code>≈  U+2248  ALMOST EQUAL TO (\~~ or \approx)
ₑ  U+2091  LATIN SUBSCRIPT SMALL LETTER E (\_e)
⊢  U+22A2  RIGHT TACK (\|- or \vdash)
⇓  U+21DB  DOWNWARDS DOUBLE ARROW (\d= or \Downarrow)</code></pre></div><nav class="pager"><ul class="pagination"><li><a class="pagelink" href="../Confluence/">Prev</a></li><li class="separator">•</li><li><a class="pagelink" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/part2/BigStep.lagda.md">Source</a></li><li class="separator">•</li><li><a class="pagelink" href="../Denotational/">Next</a></li><li class="separator">•</li></ul></nav></article></div></main><footer class="site-footer h-card"><data class="u-url" href="../"></data><div class="wrapper"><h2 class="footer-heading">Programming Language Foundations in Agda</h2><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Philip Wadler</li><li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk"><i class="far fa-envelope"></i>  wadler@inf.ed.ac.uk</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/wadler" title="wadler"><i class="fab fa-github"></i>  wadler</a></li></ul></div><div class="footer-col footer-col-3"></div></div><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Wen Kokke</li><li><a class="u-email" href="mailto:me@wen.works"><i class="far fa-envelope"></i>  me@wen.works</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/wenkokke" title="wenkokke"><i class="fab fa-github"></i>  wenkokke</a></li><li><a rel="me" href="https://twitter.com/wenkokke" title="wenkokke"><i class="fab fa-twitter"></i>  wenkokke</a></li></ul></div><div class="footer-col footer-col-3"></div></div><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Jeremy G. Siek</li><li><a class="u-email" href="mailto:jsiek@indiana.edu"><i class="far fa-envelope"></i>  jsiek@indiana.edu</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/jsiek" title="jsiek"><i class="fab fa-github"></i>  jsiek</a></li><li><a rel="me" href="https://twitter.com/jeremysiek" title="jeremysiek"><i class="fab fa-twitter"></i>  jeremysiek</a></li></ul></div><div class="footer-col footer-col-3"></div></div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a></div></footer></body></html>